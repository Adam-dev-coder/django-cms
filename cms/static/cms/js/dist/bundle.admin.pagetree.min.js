/*
    THIS FILE HAS BEEN MANUALLY PATCHED UNTIL PR #1342 GETS RELEASED
    https://github.com/vakata/jstree/pull/1342/files
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var i,r,s=0,n=!1,a=!1,o=!1,d=[],c=e("script:last").attr("src"),l=window.document,h=l.createElement("LI");h.setAttribute("role","treeitem"),i=l.createElement("I"),i.className="jstree-icon jstree-ocl",i.setAttribute("role","presentation"),h.appendChild(i),i=l.createElement("A"),i.className="jstree-anchor",i.setAttribute("href","#"),i.setAttribute("tabindex","-1"),r=l.createElement("I"),r.className="jstree-icon jstree-themeicon",r.setAttribute("role","presentation"),i.appendChild(r),h.appendChild(i),i=r=null,e.jstree={version:"3.2.1",defaults:{plugins:[]},plugins:{},path:c&&-1!==c.indexOf("/")?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var r=new e.jstree.core(++s),n=i;return i=e.extend(!0,{},e.jstree.defaults,i),n&&n.plugins&&(i.plugins=n.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,i[t]))}),e(t).data("jstree",r),r.init(t,i),r},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(l).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var i=null,r=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!r||!r.length)try{r=e(t)}catch(s){}if(!r||!r.length)try{r=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(s){}return r&&r.length&&(r=r.closest(".jstree")).length&&(r=r.data("jstree"))?i=r:e(".jstree").each(function(){var r=e(this).data("jstree");return r&&r._model.data[t]?(i=r,!1):void 0}),i},e.fn.jstree=function(i){var r="string"==typeof i,s=Array.prototype.slice.call(arguments,1),n=null;return i!==!0||this.length?(this.each(function(){var a=e.jstree.reference(this),o=r&&a?a[i]:null;return n=r&&o?o.apply(a,s):null,a||r||i!==t&&!e.isPlainObject(i)||e.jstree.create(this,i),(a&&!r||i===!0)&&(n=a||!1),null!==n&&n!==t?!1:void 0}),null!==n&&n!==t?n:this):!1},e.expr[":"].jstree=e.expr.createPseudo(function(i){return function(i){return e(i).hasClass("jstree")&&e(i).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,i){var r=e.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=i,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",i=null,r=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(i){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),r=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return e.target.tagName&&"input"===e.target.tagName.toLowerCase()?!0:void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==l.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget),i&&i.id!==e.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),i=this.get_prev_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],i&&e(this._firstChild(i)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),i=this.get_next_dom(t.currentTarget),i&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),i=this._firstChild(this.get_container_ul()[0]),i&&e(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",e.proxy(function(t,i){i.status&&(i.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,i,r=[];for(t=0,i=this._data.core.selected.length;i>t;t++)r=r.concat(this._model.data[this._data.core.selected[t]].parents);for(r=e.vakata.array_unique(r),t=0,i=r.length;i>t;t++)this.open_node(r[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(r){if(r.target.tagName&&"input"===r.target.tagName.toLowerCase())return!0;i&&clearTimeout(i),i=setTimeout(function(){t=""},500);var s=String.fromCharCode(r.which).toLowerCase(),n=this.element.find(".jstree-anchor").filter(":visible"),a=n.index(l.activeElement)||0,o=!1;if(t+=s,t.length>1){if(n.slice(a).each(e.proxy(function(i,r){return 0===e(r).text().toLowerCase().indexOf(t)?(e(r).focus(),o=!0,!1):void 0},this)),o)return;if(n.slice(0,a).each(e.proxy(function(i,r){return 0===e(r).text().toLowerCase().indexOf(t)?(e(r).focus(),o=!0,!1):void 0},this)),o)return}if(new RegExp("^"+s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(n.slice(a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===s?(e(i).focus(),o=!0,!1):void 0},this)),o)return;if(n.slice(0,a+1).each(e.proxy(function(t,i){return e(i).text().toLowerCase().charAt(0)===s?(e(i).focus(),o=!0,!1):void 0},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-r>500&&!this._data.core.focused){r=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(l).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return e.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,i){t&&t.id&&(t=t.id);var r;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(r=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=e(t,this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=e(t,this.element)).length||!r.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return i&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(s){return!1}},get_path:function(t,i,r){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var s,n,a=[];for(a.push(r?t.id:t.text),s=0,n=t.parents.length;n>s;s++)a.push(r?t.parents[s]:this.get_text(t.parents[s]));return a=a.reverse().slice(1),i?a.join(i):a},get_next_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);return r?e(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return r?e(r):!1}if(t.hasClass("jstree-open")){for(r=this._firstChild(t.children(".jstree-children")[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);if(null!==r)return e(r)}r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return null!==r?e(r):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&0===r.offsetHeight;)r=this._previousSibling(r);return r?e(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);return r?e(r):!1}r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);if(null!==r){for(t=e(r);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return r=t[0].parentNode.parentNode,r&&r.className&&-1!==r.className.indexOf("jstree-node")?e(r):!1},get_parent:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.parent:!1},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):e&&e.length?e.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var r,s,n,a,o;if(e.isArray(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,r=0,s=t.children_d.length;s>r;r++){for(n=0,a=t.parents.length;a>n;n++)this._model.data[t.parents[n]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[n]].children_d,t.children_d[r]);this._model.data[t.children_d[r]].state.selected&&(o=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[r])),delete this._model.data[t.children_d[r]]}t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var r=this.get_node(t,!0),s=0,n=0,a=this._model.data,o=!1;for(s=0,n=t.children.length;n>s;s++)if(a[t.children[s]]&&!a[t.children[s]].state.hidden){o=!0;break}t.state.loaded&&!o&&r&&r.length&&!r.hasClass("jstree-leaf")&&r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),r.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),i&&i.call(this,t,e)},this)),!0},_load_nodes:function(e,t,i){var r,s,n=!0,a=function(){this._load_nodes(e,t,!0)},o=this._model.data,d=[];for(r=0,s=e.length;s>r;r++)!o[e[r]]||(o[e[r]].state.loaded||o[e[r]].state.failed)&&i||(this.is_loading(e[r])||this.load_node(e[r],a),n=!1);if(n){for(r=0,s=e.length;s>r;r++)o[e[r]]&&o[e[r]].state.loaded&&d.push(e[r]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,s,n=[],a=this._model.data,o=a[t.id].children_d;for(t.state&&!t.state.loaded&&n.push(t.id),r=0,s=o.length;s>r;r++)a[o[r]]&&a[o[r]].state&&!a[o[r]].state.loaded&&n.push(o[r]);n.length?this._load_nodes(n,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var r,s=this.settings.core.data;return s?e.isFunction(s)?s.call(this,t,e.proxy(function(r){r===!1&&i.call(this,!1),this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(e){i.call(this,e)})},this)):"object"==typeof s?s.url?(s=e.extend(!0,{},s),e.isFunction(s.url)&&(s.url=s.url.call(this,t)),e.isFunction(s.data)&&(s.data=s.data.call(this,t)),e.ajax(s).done(e.proxy(function(r,s,n){var a=n.getResponseHeader("Content-Type");return a&&-1!==a.indexOf("json")||"object"==typeof r?this._append_json_data(t,r,function(e){i.call(this,e)}):a&&-1!==a.indexOf("html")||"string"==typeof r?this._append_html_data(t,e(e.parseHTML(r)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(e.proxy(function(e){i.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(r=e.isArray(s)||e.isPlainObject(s)?JSON.parse(JSON.stringify(s)):s,t.id===e.jstree.root?this._append_json_data(t,r,function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof s?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}),function(e){i.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)}):i.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,i,r){t=this.get_node(t),t.children=[],t.children_d=[];var s,n,a,o=i.is("ul")?i.children():i,d=t.id,c=[],l=[],h=this._model.data,_=h[d],u=this._data.core.selected.length;for(o.each(e.proxy(function(t,i){s=this._parse_model_from_html(e(i),d,_.parents.concat()),s&&(c.push(s),l.push(s),h[s].children_d.length&&(l=l.concat(h[s].children_d)))},this)),_.children=c,_.children_d=l,n=0,a=_.parents.length;a>n;n++)h[_.parents[n]].children_d=h[_.parents[n]].children_d.concat(l);this.trigger("model",{nodes:l,parent:d}),d!==e.jstree.root?(this._node_changed(d),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==u&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)},_append_json_data:function(t,i,r,s){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],i.d&&(i=i.d,"string"==typeof i&&(i=JSON.parse(i))),e.isArray(i)||(i=[i]);var n=null,a={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var i,r,s,n,a=e.dat,o=e.par,d=[],c=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,g=e.m,f=g[o],p=e.sel,m=function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d=e.id.toString(),c={id:d,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(c.state[s]=h[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),(c.icon===t||null===c.icon||""===c.icon)&&(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(c.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(c.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(c.li_attr[s]=e.li_attr[s]);if(c.li_attr.id||(c.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(c.a_attr[s]=e.a_attr[s]);for(e&&e.children&&e.children===!0&&(c.state.loaded=!1,c.children=[],c.children_d=[]),g[c.id]=c,s=0,n=c.children.length;n>s;s++)a=m(g[c.children[s]],c.id,r),o=g[a],c.children_d.push(a),o.children_d.length&&(c.children_d=c.children_d.concat(o.children_d));return delete e.data,delete e.children,g[c.id].original=e,c.state.selected&&l.push(c.id),c.id},v=function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d,c=!1;do c="j"+_+"_"+ ++u;while(g[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),(d.icon===t||null===d.icon||""===d.icon)&&(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;n>s;s++)a=v(e.children[s],d.id,r),o=g[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,g[d.id]=d,d.state.selected&&l.push(d.id),d.id};if(a.length&&a[0].id!==t&&a[0].parent!==t){for(r=0,s=a.length;s>r;r++)a[r].children||(a[r].children=[]),g[a[r].id.toString()]=a[r];for(r=0,s=a.length;s>r;r++)g[a[r].parent.toString()].children.push(a[r].id.toString()),f.children_d.push(a[r].id.toString());for(r=0,s=f.children.length;s>r;r++)i=m(g[f.children[r]],o,f.parents.concat()),c.push(i),g[i].children_d.length&&(c=c.concat(g[i].children_d));for(r=0,s=f.parents.length;s>r;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(c);n={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}else{for(r=0,s=a.length;s>r;r++)i=v(a[r],o,f.parents.concat()),i&&(d.push(i),c.push(i),g[i].children_d.length&&(c=c.concat(g[i].children_d)));for(f.children=d,f.children_d=c,r=0,s=f.parents.length;s>r;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(c);n={cnt:u,mod:g,sel:p,par:o,dpc:c,add:l}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?n:void postMessage(n)},d=function(t,i){if(null!==this.element){if(this._cnt=t.cnt,this._model.data=t.mod,i){var s,n,a=t.add,o=t.sel,d=this._data.core.selected.slice(),c=this._model.data;if(o.length!==d.length||e.vakata.array_unique(o.concat(d)).length!==o.length){for(s=0,n=o.length;n>s;s++)-1===e.inArray(o[s],a)&&-1===e.inArray(o[s],d)&&(c[o[s]].state.selected=!1);for(s=0,n=d.length;n>s;s++)-1===e.inArray(d[s],o)&&(c[d[s]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||s?(this._data.core.working=!0,n=new window.Worker(this._wrk),n.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{n.terminate(),n=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?n.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,r,!0])}catch(c){d.call(this,o(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,o(a),!1)}},_parse_model_from_html:function(i,r,s){s=s?[].concat(s):[],r&&s.unshift(r);var n,a,o,d,c,l=this._model.data,h={id:!1,text:!1,icon:!0,parent:r,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(d=e.vakata.attributes(i,!0),e.each(d,function(t,i){return i=e.trim(i),i.length?(h.li_attr[t]=i,void("id"===t&&(h.id=i.toString()))):!0}),d=i.children("a").first(),d.length&&(d=e.vakata.attributes(d,!0),e.each(d,function(t,i){i=e.trim(i),i.length&&(h.a_attr[t]=i)})),d=i.children("a").first().length?i.children("a").first().clone():i.clone(),d.children("ins, i, ul").remove(),d=d.html(),d=e("<div />").html(d),h.text=this.settings.core.force_text?d.text():d.html(),d=i.data(),h.data=d?e.extend(!0,{},d):null,h.state.opened=i.hasClass("jstree-open"),h.state.selected=i.children("a").hasClass("jstree-clicked"),h.state.disabled=i.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);d=i.children("a").children(".jstree-themeicon"),d.length&&(h.icon=d.hasClass("jstree-themeicon-hidden")?!1:d.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),d=i.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,d.length?(d.each(e.proxy(function(t,i){n=this._parse_model_from_html(e(i),h.id,s),a=this._model.data[n],h.children.push(n),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):i.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),l[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d=e.id.toString(),c=this._model.data,l=this._model.default_state,h={id:d,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:i,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in l)l.hasOwnProperty(s)&&(h.state[s]=l[s]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),(h.icon===t||null===h.icon||""===h.icon)&&(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(h.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(h.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(h.li_attr[s]=e.li_attr[s]);if(h.li_attr.id||(h.li_attr.id=d),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(h.a_attr[s]=e.a_attr[s]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,s=0,n=h.children.length;n>s;s++)a=this._parse_model_from_flat_json(c[h.children[s]],h.id,r),o=c[a],h.children_d.push(a),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,i,r){r=r?r.concat():[],i&&r.unshift(i);var s,n,a,o,d,c=!1,l=this._model.data,h=this._model.default_state;do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in h)h.hasOwnProperty(s)&&(d.state[s]=h[s]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),(d.icon===t||null===d.icon||""===d.icon)&&(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(s in e.data.jstree)e.data.jstree.hasOwnProperty(s)&&(d.state[s]=e.data.jstree[s]);if(e&&"object"==typeof e.state)for(s in e.state)e.state.hasOwnProperty(s)&&(d.state[s]=e.state[s]);if(e&&"object"==typeof e.li_attr)for(s in e.li_attr)e.li_attr.hasOwnProperty(s)&&(d.li_attr[s]=e.li_attr[s]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=c),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(s in e.a_attr)e.a_attr.hasOwnProperty(s)&&(d.a_attr[s]=e.a_attr[s]);if(e&&e.children&&e.children.length){for(s=0,n=e.children.length;n>s;s++)a=this._parse_model_from_json(e.children[s],d.id,r),o=l[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,l[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,i,r,s=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),n=l.createElement("UL"),a=this._data.core.focused;for(i=0,r=s.length;r>i;i++)t=this.redraw_node(s[i],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&n.appendChild(t);this._model.force_full_redraw&&(n.className=this.get_container_ul()[0].className,n.setAttribute("role","group"),this.element.empty().append(n)),null!==a&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==l.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:s})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var i=this.get_node(t),r=!1,s=!1,n=!1,a=l;if(!i)return!1;if(i.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],i.children.length&&i.state.loaded){for(n=a.createElement("UL"),n.setAttribute("role","group"),n.className="jstree-children",r=0,s=i.children.length;s>r;r++)n.appendChild(this.redraw_node(i.children[r],!0,!0));t.appendChild(n)}},redraw_node:function(t,i,r,s){var n=this.get_node(t),a=!1,o=!1,d=!1,c=!1,_=!1,u=!1,g="",f=l,p=this._model.data,m=!1,v=null,j=0,y=0,k=!1,x=!1;if(!n)return!1;if(n.id===e.jstree.root)return this.redraw(!0);if(i=i||0===n.children.length,t=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(n.id[0])?"\\3"+n.id[0]+" "+n.id.substr(1).replace(e.jstree.idregex,"\\$&"):n.id.replace(e.jstree.idregex,"\\$&"))):l.getElementById(n.id))t=e(t),r||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),o=t.index()),i||!n.children.length||t.children(".jstree-children").length||(i=!0),
i||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===l.activeElement,t.remove();else if(i=!0,!r){if(a=n.parent!==e.jstree.root?e("#"+n.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===a||a&&p[n.parent].state.opened))return!1;o=e.inArray(n.id,null===a?p[e.jstree.root].children:p[n.parent].children)}t=h.cloneNode(!0),g="jstree-node ";for(c in n.li_attr)if(n.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,n.li_attr[c]):g+=n.li_attr[c]}for(n.a_attr.id||(n.a_attr.id=n.id+"_anchor"),t.setAttribute("aria-selected",!!n.state.selected),t.setAttribute("aria-level",n.parents.length),t.setAttribute("aria-labelledby",n.a_attr.id),n.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,_=n.children.length;_>c;c++)if(!p[n.children[c]].state.hidden){k=!0;break}if(null!==n.parent&&p[n.parent]&&!n.state.hidden&&(c=e.inArray(n.id,p[n.parent].children),x=n.id,-1!==c))for(c++,_=p[n.parent].children.length;_>c&&(p[p[n.parent].children[c]].state.hidden||(x=p[n.parent].children[c]),x===n.id);c++);n.state.hidden&&(g+=" jstree-hidden"),n.state.loaded&&!k?g+=" jstree-leaf":(g+=n.state.opened&&n.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",n.state.opened&&n.state.loaded)),x===n.id&&(g+=" jstree-last"),t.id=n.id,t.className=g,g=(n.state.selected?" jstree-clicked":"")+(n.state.disabled?" jstree-disabled":"");for(_ in n.a_attr)if(n.a_attr.hasOwnProperty(_)){if("href"===_&&"#"===n.a_attr[_])continue;"class"!==_?t.childNodes[1].setAttribute(_,n.a_attr[_]):g+=" "+n.a_attr[_]}if(g.length&&(t.childNodes[1].className="jstree-anchor "+g),(n.icon&&n.icon!==!0||n.icon===!1)&&(n.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===n.icon.indexOf("/")&&-1===n.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+n.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+n.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(f.createTextNode(n.text)):t.childNodes[1].innerHTML+=n.text,i&&n.children.length&&(n.state.opened||s)&&n.state.loaded){for(u=f.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,_=n.children.length;_>c;c++)u.appendChild(this.redraw_node(n.children[c],i,!0));t.appendChild(u)}if(d&&t.appendChild(d),!r){for(a||(a=this.element[0]),c=0,_=a.childNodes.length;_>c;c++)if(a.childNodes[c]&&a.childNodes[c].className&&-1!==a.childNodes[c].className.indexOf("jstree-children")){v=a.childNodes[c];break}v||(v=f.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",a.appendChild(v)),a=v,o<a.childNodes.length?a.insertBefore(t,a.childNodes[o]):a.appendChild(t),m&&(j=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=j,this.element[0].scrollLeft=y)}return n.state.opened&&!n.state.loaded&&(n.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(n.id,!1,0)},this),0)),t},open_node:function(i,r,s){var n,a,o,d;if(e.isArray(i)){for(i=i.slice(),n=0,a=i.length;a>n;n++)this.open_node(i[n],r,s);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?(s=s===t?this.settings.core.animation:s,this.is_closed(i)?this.is_loaded(i)?(o=this.get_node(i,!0),d=this,o.length&&(s&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(i),s?(this.trigger("before_open",{node:i}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(s,function(){this.style.display="",d.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,r&&r.call(this,i,!0),o.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),s&&o.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(e.proxy(function(){this.open_node(i,r,s)},this),500):void this.load_node(i,function(e,t){return t?this.open_node(e,r,s):r?r.call(this,e,!1):!1}):(r&&r.call(this,i,!1),!1)):!1},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i,r,s=t.parents;for(i=0,r=s.length;r>i;i+=1)i!==e.jstree.root&&this.open_node(s[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(i,r){var s,n,a,o;if(e.isArray(i)){for(i=i.slice(),s=0,n=i.length;n>s;s++)this.close_node(i[s],r);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?this.is_closed(i)?!1:(r=r===t?this.settings.core.animation:r,a=this,o=this.get_node(i,!0),o.length&&(r?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="",o.children(".jstree-children").remove(),a.trigger("after_close",{node:i})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove())),i.state.opened=!1,this.trigger("close_node",{node:i}),void(r&&o.length||this.trigger("after_close",{node:i}))):!1},toggle_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,r){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var s,n,a,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(s=0,n=t.children_d.length;n>s;s++)this.is_closed(this._model.data[t.children_d[s]])&&(this._model.data[t.children_d[s]].state.opened=!0);return this.trigger("open_all",{node:t})}r=r||o,a=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,i,r)},i||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(t,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,s,n=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(n.length&&(n=this.is_open(t)?n.find(".jstree-open").addBack():n.find(".jstree-open"),e(n.get().reverse()).each(function(){a.close_node(this,i||0)})),r=0,s=t.children_d.length;s>r;r++)this._model.data[t.children_d[r]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.enable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t})):!1},disable_node:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.disable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t})):!1},hide_node:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.hide_node(t[r],!0);return this.redraw(),!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t}))):!1},show_node:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.show_node(t[r],!0);return this.redraw(),!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t}))):!1},hide_all:function(t){var i,r=this._model.data,s=[];for(i in r)r.hasOwnProperty(i)&&i!==e.jstree.root&&!r[i].state.hidden&&(r[i].state.hidden=!0,s.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:s}),s},show_all:function(t){var i,r=this._model.data,s=[];for(i in r)r.hasOwnProperty(i)&&i!==e.jstree.root&&r[i].state.hidden&&(r[i].state.hidden=!1,s.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:s}),s},activate_node:function(e,i){if(this.is_disabled(e))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(i.shiftKey){var r,s,n=this.get_node(e).id,a=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(r=0,s=o.length;s>r;r+=1)o[r]===n&&(d=!d),o[r]===a&&(d=!d),this.is_disabled(o[r])||!d&&o[r]!==n&&o[r]!==a?this.deselect_node(o[r],!0,i):this.select_node(o[r],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:i})}else this.is_selected(e)?this.deselect_node(e,!1,i):this.select_node(e,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,i):(this.deselect_all(!0),this.select_node(e,!1,!1,i),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:i})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){i.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),e&&e.length&&e.children(".jstree-hovered").length?(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)})):!1},select_node:function(t,i,r,s){var n,a,o;if(e.isArray(t)){for(t=t.slice(),a=0,o=t.length;o>a;a++)this.select_node(t[a],i,r,s);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),r||(n=this._open_to(t)),n&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:s}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:s})))):!1},deselect_node:function(t,i,r){var s,n,a;if(e.isArray(t)){for(t=t.slice(),s=0,n=t.length;n>s;s++)this.deselect_node(t[s],i,r);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(a=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r})))):!1},select_all:function(t){var i,r,s=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),i=0,r=this._data.core.selected.length;r>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:s})},deselect_all:function(e){var t,i,r=this._data.core.selected.concat([]);for(t=0,i=this._data.core.selected.length;i>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:r}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:r})},is_selected:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.state.selected:!1},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var i,r,s,n,a=this.get_selected(!0),o={};for(i=0,r=a.length;r>i;i++)o[a[i].id]=a[i];for(i=0,r=a.length;r>i;i++)for(s=0,n=a[i].children_d.length;n>s;s++)o[a[i].children_d[s]]&&delete o[a[i].children_d[s]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var i,r,s=this.get_selected(!0),n=[];for(i=0,r=s.length;r>i;i++)s[i].children.length||n.push(s[i].id);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},get_state:function(){var t,i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,r){if(i){if(i.core){var s,n;if(i.core.open)return e.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(e){this.open_node(e,!1,0),delete i.core.open,this.set_state(i,r)},!0):(delete i.core.open,this.set_state(i,r)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,r),!1;if(i.core.selected)return s=this,this.deselect_all(),e.each(i.core.selected,function(e,t){s.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,r),!1;for(n in i)i.hasOwnProperty(n)&&"core"!==n&&-1===e.inArray(n,this.settings.plugins)&&delete i[n];if(e.isEmptyObject(i.core))return delete i.core,this.set_state(i,r),!1}return e.isEmptyObject(i)?(i=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state(),i&&e.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var r=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i=[],r=[];this._data.core.selected.concat([]);r.push(t.id),t.state.opened===!0&&i.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)}),this._load_nodes(r,e.proxy(function(e){this.open_node(i,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var r,s,n=this._model.data;for(i=i.toString(),n[t.parent].children[e.inArray(t.id,n[t.parent].children)]=i,r=0,s=t.parents.length;s>r;r++)n[t.parents[r]].children_d[e.inArray(t.id,n[t.parents[r]].children_d)]=i;for(r=0,s=t.children.length;s>r;r++)n[t.children[r]].parent=i;for(r=0,s=t.children_d.length;s>r;r++)n[t.children_d[r]].parents[e.inArray(t.id,n[t.children_d[r]].parents)]=i;return r=e.inArray(t.id,this._data.core.selected),-1!==r&&(this._data.core.selected[r]=i),r=this.get_node(t.id,!0),r&&(r.attr("id",i).children(".jstree-anchor").attr("id",i+"_anchor").end().attr("aria-labelledby",i+"_anchor"),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete n[t.id],t.id=i,t.li_attr.id=i,n[i]=t,!0},get_text:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.text:!1},set_text:function(t,i){var r,s;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.set_text(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0):!1},get_json:function(t,i,r){if(t=this.get_node(t||e.jstree.root),!t)return!1;i&&i.flat&&!r&&(r=[]);var s,n,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:i&&i.no_data?!1:e.extend(!0,{},t.data)};if(i&&i.flat?a.parent=t.parent:a.children=[],!i||!i.no_state)for(s in t.state)t.state.hasOwnProperty(s)&&(a.state[s]=t.state[s]);if(i&&i.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),i&&i.flat&&t.id!==e.jstree.root&&r.push(a),!i||!i.no_children)for(s=0,n=t.children.length;n>s;s++)i&&i.flat?this.get_json(t.children[s],i,r):a.children.push(this.get_json(t.children[s],i));return i&&i.flat?r:t.id===e.jstree.root?a.children:a},create_node:function(i,r,s,n,a){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return!1;if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,r,s,n,!0)});r||(r={text:this.get_string("New node")}),"string"==typeof r&&(r={text:r}),r.text===t&&(r.text=this.get_string("New node"));var o,d,c,l;switch(i.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":o=this.get_node(i.parent),s=e.inArray(i.id,o.children),i=o;break;case"after":o=this.get_node(i.parent),s=e.inArray(i.id,o.children)+1,i=o;break;case"inside":case"first":s=0;break;case"last":s=i.children.length;break;default:s||(s=0)}if(s>i.children.length&&(s=i.children.length),r.id||(r.id=!0),!this.check("create_node",r,i,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,i.id,i.parents.concat()),!r)return!1;for(o=this.get_node(r),d=[],d.push(r),d=d.concat(o.children_d),this.trigger("model",{nodes:d,parent:i.id}),i.children_d=i.children_d.concat(d),c=0,l=i.parents.length;l>c;c++)this._model.data[i.parents[c]].children_d=this._model.data[i.parents[c]].children_d.concat(d);for(r=o,o=[],c=0,l=i.children.length;l>c;c++)o[c>=s?c+1:c]=i.children[c];return o[s]=r.id,i.children=o,this.redraw_node(i,!0),n&&n.call(this,this.get_node(r)),this.trigger("create_node",{node:this.get_node(r),parent:i.id,position:s}),r.id},rename_node:function(t,i){var r,s,n;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.rename_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:n}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(t){var i,r,s,n,a,o,d,c,l,h,_,u;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.delete_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(s=this.get_node(t.parent),n=e.inArray(t.id,s.children),h=!1,!this.check("delete_node",t,s,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==n&&(s.children=e.vakata.array_remove(s.children,n)),a=t.children_d.concat([]),a.push(t.id),c=0,l=a.length;l>c;c++){for(o=0,d=t.parents.length;d>o;o++)n=e.inArray(a[c],this._model.data[t.parents[o]].children_d),-1!==n&&(this._model.data[t.parents[o]].children_d=e.vakata.array_remove(this._model.data[t.parents[o]].children_d,n));this._model.data[a[c]].state.selected&&(h=!0,n=e.inArray(a[c],this._data.core.selected),-1!==n&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,n)))}for(this.trigger("delete_node",{node:t,parent:s.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:s.id}),c=0,l=a.length;l>c;c++)delete this._model.data[a[c]];return-1!==e.inArray(this._data.core.focused,a)&&(this._data.core.focused=null,_=this.element[0].scrollTop,u=this.element[0].scrollLeft,s.id===e.jstree.root?this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(s,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=_,this.element[0].scrollLeft=u),this.redraw_node(s,!0),!0},check:function(t,i,r,s,n){i=i&&i.id?i:this.get_node(i),r=r&&r.id?r:this.get_node(r);var a=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||n&&n.is_multi||(i.id!==r.id||"copy_node"===t)&&e.inArray(i.id,r.children)!==s&&-1===e.inArray(r.id,i.children_d)?(a&&a.data&&(a=a.data),a&&a.functions&&(a.functions[t]===!1||a.functions[t]===!0)?(a.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),a.functions[t]):o===!1||e.isFunction(o)&&o.call(this,t,i,r,s,n)===!1||o&&o[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1):!0):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:s,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(i,r,s,n,a,o,d){var c,l,h,_,u,g,f,p,m,v,j,y,k,x;if(r=this.get_node(r),s=s===t?0:s,!r)return!1;if(!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(i,r,s,n,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(c=0,l=i.length;l>c;c++)(m=this.move_node(i[c],r,s,n,a,!1,d))&&(r=m,s="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;if(h=(i.parent||e.jstree.root).toString(),u=s.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,g=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),f=!g||!g._id||this._id!==g._id,_=g&&g._id&&h&&g._model.data[h]&&g._model.data[h].children?e.inArray(i.id,g._model.data[h].children):-1,g&&g._id&&(i=g._model.data[i.id]),f)return(m=this.copy_node(i,r,s,n,a,!1,d))?(g&&g.delete_node(i),m):!1;switch(r.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(r.id,u.children);break;case"after":s=e.inArray(r.id,u.children)+1;break;case"inside":case"first":s=0;break;case"last":s=u.children.length;break;default:s||(s=0)}if(s>u.children.length&&(s=u.children.length),!this.check("move_node",i,u,s,{core:!0,origin:d,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===u.id){for(p=u.children.concat(),m=e.inArray(i.id,p),-1!==m&&(p=e.vakata.array_remove(p,m),s>m&&s--),m=[],v=0,j=p.length;j>v;v++)m[v>=s?v+1:v]=p[v];m[s]=i.id,u.children=m,this._node_changed(u.id),this.redraw(u.id===e.jstree.root)}else{for(m=i.children_d.concat(),m.push(i.id),v=0,j=i.parents.length;j>v;v++){for(p=[],x=g._model.data[i.parents[v]].children_d,y=0,k=x.length;k>y;y++)-1===e.inArray(x[y],m)&&p.push(x[y]);g._model.data[i.parents[v]].children_d=p}for(g._model.data[h].children=e.vakata.array_remove_item(g._model.data[h].children,i.id),v=0,j=u.parents.length;j>v;v++)this._model.data[u.parents[v]].children_d=this._model.data[u.parents[v]].children_d.concat(m);for(p=[],v=0,j=u.children.length;j>v;v++)p[v>=s?v+1:v]=u.children[v];for(p[s]=i.id,u.children=p,u.children_d.push(i.id),u.children_d=u.children_d.concat(i.children_d),i.parent=u.id,m=u.parents.concat(),m.unshift(u.id),x=i.parents.length,i.parents=m,m=m.concat(),v=0,j=i.children_d.length;j>v;v++)this._model.data[i.children_d[v]].parents=this._model.data[i.children_d[v]].parents.slice(0,-1*x),Array.prototype.push.apply(this._model.data[i.children_d[v]].parents,m);(h===e.jstree.root||u.id===e.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(u.id)),o||this.redraw()}return n&&n.call(this,i,u,s),this.trigger("move_node",{node:i,parent:u.id,position:s,old_parent:h,old_position:_,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this}),i.id},copy_node:function(i,r,s,n,a,o,d){var c,l,h,_,u,g,f,p,m,v,j;if(r=this.get_node(r),s=s===t?0:s,!r)return!1;if(!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(i,r,s,n,!0,!1,d)});if(e.isArray(i)){if(1!==i.length){for(c=0,l=i.length;l>c;c++)(_=this.copy_node(i[c],r,s,n,a,!0,d))&&(r=_,s="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===e.jstree.root)return!1;switch(p=(i.parent||e.jstree.root).toString(),m=s.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,v=d?d:this._model.data[i.id]?this:e.jstree.reference(i.id),j=!v||!v._id||this._id!==v._id,v&&v._id&&(i=v._model.data[i.id]),r.id===e.jstree.root&&("before"===s&&(s="first"),"after"===s&&(s="last")),s){case"before":s=e.inArray(r.id,m.children);break;case"after":s=e.inArray(r.id,m.children)+1;break;case"inside":case"first":s=0;break;case"last":s=m.children.length;break;default:s||(s=0)}if(s>m.children.length&&(s=m.children.length),!this.check("copy_node",i,m,s,{core:!0,origin:d,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(f=v?v.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!f)return!1;if(f.id===!0&&delete f.id,f=this._parse_model_from_json(f,m.id,m.parents.concat()),!f)return!1;for(_=this.get_node(f),i&&i.state&&i.state.loaded===!1&&(_.state.loaded=!1),h=[],h.push(f),h=h.concat(_.children_d),this.trigger("model",{nodes:h,parent:m.id}),u=0,g=m.parents.length;g>u;u++)this._model.data[m.parents[u]].children_d=this._model.data[m.parents[u]].children_d.concat(h);for(h=[],u=0,g=m.children.length;g>u;u++)h[u>=s?u+1:u]=m.children[u];return h[s]=_.id,m.children=h,m.children_d.push(_.id),m.children_d=m.children_d.concat(_.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),n&&n.call(this,_,m,s),this.trigger("copy_node",{node:_,original:i,parent:m.id,position:s,old_parent:p,old_position:v&&v._id&&p&&v._model.data[p]&&v._model.data[p].children?e.inArray(i.id,v._model.data[p].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),_.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,r,s,d=[];for(r=0,s=t.length;s>r;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return d.length?(n=d,o=this,a="move_node",void this.trigger("cut",{node:t})):!1},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var i,r,s,d=[];for(r=0,s=t.length;s>r;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==e.jstree.root&&d.push(i);return d.length?(n=d,o=this,a="copy_node",void this.trigger("copy",{node:t})):!1},get_buffer:function(){return{mode:a,node:n,inst:o}},can_paste:function(){return a!==!1&&n!==!1},paste:function(e,t){return e=this.get_node(e),e&&a&&a.match(/^(copy_node|move_node)$/)&&n?(this[a](n,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:n,mode:a}),n=!1,a=!1,void(o=!1)):!1},clear_buffer:function(){n=!1,a=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,i,r){var s,n,a,o,d,c,l,h,_,u=!1;return(t=this.get_node(t))?this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(_=t,i="string"==typeof i?i:t.text,this.set_text(t,""),t=this._open_to(t),_.text=i,s=this._data.core.rtl,n=this.element.width(),this._data.core.focused=_.id,a=t.children(".jstree-anchor").focus(),o=e("<span>"),d=i,c=e("<div />",{css:{position:"absolute",top:"-200px",left:s?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),l=e("<input />",{value:d,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(i){i.stopImmediatePropagation(),i.preventDefault();var s,n=o.children(".jstree-rename-input"),l=n.val(),h=this.settings.core.force_text;""===l&&(l=d),c.remove(),o.replaceWith(a),o.remove(),d=h?d:e("<div></div>").append(e.parseHTML(d)).html(),this.set_text(t,d),s=!!this.rename_node(t,h?e("<div></div>").text(l).text():e("<div></div>").append(e.parseHTML(l)).html()),s||this.set_text(t,d),this._data.core.focused=_.id,setTimeout(e.proxy(function(){var e=this.get_node(_.id,!0);e.length&&(this._data.core.focused=_.id,e.children(".jstree-anchor").focus())},this),0),r&&r.call(this,_,s,u)},this),keydown:function(e){var t=e.which;27===t&&(u=!0,this.value=d),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){l.width(Math.min(c.text("pW"+this.value).width(),n))},keypress:function(e){return 13===e.which?!1:void 0}}),h={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},o.attr("class",a.attr("class")).append(a.contents().clone()).append(l),a.replaceWith(o),c.css(h),void l.css(h).width(Math.min(c.text("pW"+l[0].value).width(),n))[0].select()):!1},set_theme:function(t,i){if(!t)return!1;if(i===!0){var r=this.settings.core.themes.dir;r||(r=e.jstree.path+"/themes"),i=r+"/"+t+"/style.css"}i&&-1===e.inArray(i,d)&&(e("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),d.push(i)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),
this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,r){var s,n,a,o;if(e.isArray(i)){for(i=i.slice(),s=0,n=i.length;n>s;s++)this.set_icon(i[s],r);return!0}return i=this.get_node(i),i&&i.id!==e.jstree.root?(o=i.icon,i.icon=r===!0||null===r||r===t||""===r?!0:r,a=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),r===!1?this.hide_icon(i):r===!0||null===r||r===t||""===r?(a.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),o===!1&&this.show_icon(i)):-1===r.indexOf("/")&&-1===r.indexOf(".")?(a.removeClass(o).css("background",""),a.addClass(r+" jstree-themeicon-custom").attr("rel",r),o===!1&&this.show_icon(i)):(a.removeClass(o).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r),o===!1&&this.show_icon(i)),!0):!1},get_icon:function(t){return t=this.get_node(t),t&&t.id!==e.jstree.root?t.icon:!1},hide_icon:function(t){var i,r;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.hide_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==e.jstree.root?(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.show_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==e.jstree.root?(s=this.get_node(t,!0),t.icon=s.length?s.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),s.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},e.vakata={},e.vakata.attributes=function(t,i){t=e(t)[0];var r=i?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,s){-1===e.inArray(s.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==s.value&&""!==e.trim(s.value)&&(i?r[s.name]=s.value:r.push(s.name))}),r},e.vakata.array_unique=function(e){var i,r,s=[],n={};for(i=0,r=e.length;r>i;i++)n[e[i]]===t&&(s.push(e[i]),n[e[i]]=!0);return s},e.vakata.array_remove=function(e,t,i){var r=e.slice((i||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,r),e},e.vakata.array_remove_item=function(t,i){var r=e.inArray(i,t);return-1!==r?e.vakata.array_remove(t,r):t},e.jstree.plugins.changed=function(e,t){var i=[];this.trigger=function(e,r){var s,n;if(r||(r={}),"changed"===e.replace(".jstree","")){r.changed={selected:[],deselected:[]};var a={};for(s=0,n=i.length;n>s;s++)a[i[s]]=1;for(s=0,n=r.selected.length;n>s;s++)a[r.selected[s]]?a[r.selected[s]]=2:r.changed.selected.push(r.selected[s]);for(s=0,n=i.length;n>s;s++)1===a[i[s]]&&r.changed.deselected.push(i[s]);i=r.selected.slice()}t.trigger.call(this,e,r)},this.refresh=function(e,r){return i=[],t.refresh.apply(this,arguments)}};var _=l.createElement("I");_.className="jstree-icon jstree-checkbox",_.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(i,r){this.bind=function(){r.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var i,r,s=this._model.data,n=(s[t.parent],t.nodes);for(i=0,r=n.length;r>i;i++)s[n[i]].state.checked=s[n[i]].state.checked||s[n[i]].original&&s[n[i]].original.state&&s[n[i]].original.state.checked,s[n[i]].state.checked&&this._data.checkbox.selected.push(n[i])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,i){var r,s,n,a,o,d,c=this._model.data,l=c[i.parent],h=i.nodes,_=[],u=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(-1!==u.indexOf("down"))if(l.state[g?"selected":"checked"]){for(s=0,n=h.length;n>s;s++)c[h[s]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(h)}else for(s=0,n=h.length;n>s;s++)if(c[h[s]].state[g?"selected":"checked"]){for(a=0,o=c[h[s]].children_d.length;o>a;a++)c[c[h[s]].children_d[a]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(c[h[s]].children_d)}if(-1!==u.indexOf("up")){for(s=0,n=l.children_d.length;n>s;s++)c[l.children_d[s]].children.length||_.push(c[l.children_d[s]].parent);for(_=e.vakata.array_unique(_),a=0,o=_.length;o>a;a++)for(l=c[_[a]];l&&l.id!==e.jstree.root;){for(r=0,s=0,n=l.children.length;n>s;s++)r+=c[l.children[s]].state[g?"selected":"checked"];if(r!==n)break;l.state[g?"selected":"checked"]=!0,this._data[g?"core":"checkbox"].selected.push(l.id),d=this.get_node(l,!0),d&&d.length&&d.attr("aria-selected",!0).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}}this._data[g?"core":"checkbox"].selected=e.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var r,s,n,a,o=i.node,d=this._model.data,c=this.get_node(o.parent),l=this.get_node(o,!0),h=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==h.indexOf("down"))for(this._data[_?"core":"checkbox"].selected=e.vakata.array_unique(this._data[_?"core":"checkbox"].selected.concat(o.children_d)),r=0,s=o.children_d.length;s>r;r++)a=d[o.children_d[r]],a.state[_?"selected":"checked"]=!0,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(-1!==h.indexOf("up"))for(;c&&c.id!==e.jstree.root;){for(n=0,r=0,s=c.children.length;s>r;r++)n+=d[c.children[r]].state[_?"selected":"checked"];if(n!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),a=this.get_node(c,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}-1!==h.indexOf("down")&&l.length&&l.find(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,i){var r,s,n,a=this.get_node(e.jstree.root),o=this._model.data;for(r=0,s=a.children_d.length;s>r;r++)n=o[a.children_d[r]],n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var r,s,n,a=i.node,o=this.get_node(a,!0),d=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection;if(a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),-1!==d.indexOf("down"))for(r=0,s=a.children_d.length;s>r;r++)n=this._model.data[a.children_d[r]],n.state[c?"selected":"checked"]=!1,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1);if(-1!==d.indexOf("up"))for(r=0,s=a.parents.length;s>r;r++)n=this._model.data[a.parents[r]],n.state[c?"selected":"checked"]=!1,n&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1),n=this.get_node(a.parents[r],!0),n&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(n=[],r=0,s=this._data[c?"core":"checkbox"].selected.length;s>r;r++)-1!==d.indexOf("down")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[r],a.children_d)||-1!==d.indexOf("up")&&-1!==e.inArray(this._data[c?"core":"checkbox"].selected[r],a.parents)||n.push(this._data[c?"core":"checkbox"].selected[r]);this._data[c?"core":"checkbox"].selected=e.vakata.array_unique(n),-1!==d.indexOf("down")&&o.length&&o.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(t,i){for(var r,s,n,a,o=this.get_node(i.parent),d=this._model.data,c=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[c?"selected":"checked"];){for(n=0,r=0,s=o.children.length;s>r;r++)n+=d[o.children[r]].state[c?"selected":"checked"];if(!(s>0&&n===s))break;o.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(o.id),a=this.get_node(o,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var r,s,n,a,o,d=i.is_multi,c=i.old_parent,l=this.get_node(i.parent),h=this._model.data,_=this.settings.checkbox.tie_selection;if(!d)for(r=this.get_node(c);r&&r.id!==e.jstree.root&&!r.state[_?"selected":"checked"];){for(s=0,n=0,a=r.children.length;a>n;n++)s+=h[r.children[n]].state[_?"selected":"checked"];if(!(a>0&&s===a))break;r.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),r=this.get_node(r.parent)}for(r=l;r&&r.id!==e.jstree.root;){for(s=0,n=0,a=r.children.length;a>n;n++)s+=h[r.children[n]].state[_?"selected":"checked"];if(s===a)r.state[_?"selected":"checked"]||(r.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"));else{if(!r.state[_?"selected":"checked"])break;r.state[_?"selected":"checked"]=!1,this._data[_?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[_?"core":"checkbox"].selected,r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(_?"jstree-clicked":"jstree-checked")}r=this.get_node(r.parent)}},this))},this._undetermined=function(){if(null!==this.element){var i,r,s,n,a={},o=this._model.data,d=this.settings.checkbox.tie_selection,c=this._data[d?"core":"checkbox"].selected,l=[],h=this;for(i=0,r=c.length;r>i;i++)if(o[c[i]]&&o[c[i]].parents)for(s=0,n=o[c[i]].parents.length;n>s;s++)a[o[c[i]].parents[s]]===t&&o[c[i]].parents[s]!==e.jstree.root&&(a[o[c[i]].parents[s]]=!0,l.push(o[c[i]].parents[s]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var d,c=h.get_node(this);if(c.state.loaded){for(i=0,r=c.children_d.length;r>i;i++)if(d=o[c.children_d[i]],!d.state.loaded&&d.original&&d.original.state&&d.original.state.undetermined&&d.original.state.undetermined===!0)for(a[d.id]===t&&d.id!==e.jstree.root&&(a[d.id]=!0,l.push(d.id)),s=0,n=d.parents.length;n>s;s++)a[d.parents[s]]===t&&d.parents[s]!==e.jstree.root&&(a[d.parents[s]]=!0,l.push(d.parents[s]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(a[c.id]===t&&c.id!==e.jstree.root&&(a[c.id]=!0,l.push(c.id)),s=0,n=c.parents.length;n>s;s++)a[c.parents[s]]===t&&c.parents[s]!==e.jstree.root&&(a[c.parents[s]]=!0,l.push(c.parents[s]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),i=0,r=l.length;r>i;i++)o[l[i]].state[d?"selected":"checked"]||(c=this.get_node(l[i],!0),c&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,i,s,n){if(t=r.redraw_node.apply(this,arguments)){var a,o,d=null,c=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){d=t.childNodes[a];break}d&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(d.className+=" jstree-checked"),c=_.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),d.insertBefore(c,d.childNodes[0]))}return s||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var i,r,s=this.settings.checkbox.cascade,n=this.settings.checkbox.tie_selection,a=this._data[n?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[n?"selected":"checked"]===!0||-1===s.indexOf("undetermined")||-1===s.indexOf("down")&&-1===s.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,r=t.children_d.length;r>i;i++)if(-1!==e.inArray(t.children_d[i],a)||!o[t.children_d[i]].state.loaded&&o[t.children_d[i]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.disable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(s=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t})))):!1},this.enable_checkbox=function(t){var i,r,s;if(e.isArray(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.enable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(s=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,s&&s.length&&s.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t})))):!1},this.activate_node=function(t,i){return e(i.target).hasClass("jstree-checkbox-disabled")?!1:(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(i.target).hasClass("jstree-checkbox")?r.activate_node.call(this,t,i):this.is_disabled(t)?!1:(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var r,s,n;if(e.isArray(t)){for(t=t.slice(),s=0,n=t.length;n>s;s++)this.check_node(t[s],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(r=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1},this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var r,s,n;if(e.isArray(t)){for(t=t.slice(),r=0,s=t.length;s>r;r++)this.uncheck_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==e.jstree.root?(n=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),n.length&&n.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,i;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,i=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),t&&t.id!==e.jstree.root?t.state.checked:!1)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var i,r,s,n,a=this.get_checked(!0),o={};for(i=0,r=a.length;r>i;i++)o[a[i].id]=a[i];for(i=0,r=a.length;r>i;i++)for(s=0,n=a[i].children_d.length;n>s;s++)o[a[i].children_d[s]]&&delete o[a[i].children_d[s]];a=[];for(i in o)o.hasOwnProperty(i)&&a.push(i);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var i,r,s=this.get_checked(!0),n=[];for(i=0,r=s.length;r>i;i++)s[i].children.length||n.push(s[i].id);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},this.load_node=function(t,i){var s,n,a,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(s=0,n=o.children_d.length;n>s;s++)this._model.data[o.children_d[s]].state.checked&&(a=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[s]));return r.load_node.apply(this,arguments)},this.get_state=function(){var e=r.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,i){var s=r.set_state.apply(this,arguments);if(s&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var n=this;e.each(t.checkbox,function(e,t){n.check_node(t)})}return delete t.checkbox,this.set_state(t,i),!1}return s},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),r.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,i){this.settings.conditionalselect.call(this,this.get_node(e),i)&&t.activate_node.call(this,e,i)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.delete_node(i.get_selected()):i.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.cut(i.get_top_selected()):i.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.copy(i.get_top_selected()):i.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}},e.jstree.plugins.contextmenu=function(i,r){this.bind=function(){r.bind.call(this);var t,i,s=0,n=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){e.preventDefault(),s=e.ctrlKey?+new Date:0,(t||n)&&(s=+new Date+1e4),n&&clearTimeout(n),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!s||+new Date-s>250)&&e.vakata.context.hide(),s=0},this)).on("touchstart.jstree",".jstree-anchor",function(r){r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(t=r.pageX,i=r.pageY,n=setTimeout(function(){e(r.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){n&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.pageX)>50||Math.abs(i-e.pageY)>50)&&clearTimeout(n)}).on("touchend.vakata.jstree",function(e){n&&clearTimeout(n)}),e(l).on("context_hide.vakata.jstree",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),r.teardown.call(this)},this.show_contextmenu=function(i,r,s,n){if(i=this.get_node(i),!i||i.id===e.jstree.root)return!1;var a=this.settings.contextmenu,o=this.get_node(i,!0),d=o.children(".jstree-anchor"),c=!1,l=!1;(a.show_at_node||r===t||s===t)&&(c=d.offset(),r=c.left,s=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,n),l=a.items,e.isFunction(l)&&(l=l.call(this,i,e.proxy(function(e){this._show_contextmenu(i,r,s,e)},this))),e.isPlainObject(l)&&this._show_contextmenu(i,r,s,l)},this._show_contextmenu=function(t,i,r,s){var n=this.get_node(t,!0),a=n.children(".jstree-anchor");e(l).one("context_show.vakata.jstree",e.proxy(function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(r)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:i,y:r},s),this.trigger("show_contextmenu",{node:t,x:i,y:r})}},function(e){var t=!1,i={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(l).triggerHandler("context_"+t+".vakata",{reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}})},_execute:function(t){return t=i.items[t],t&&(!t._disabled||e.isFunction(t._disabled)&&!t._disabled({item:t,reference:i.reference,element:i.element}))&&t.action?t.action.call(null,{item:t,reference:i.reference,element:i.element,position:{x:i.position_x,y:i.position_y}}):!1},_parse:function(t,r){if(!t)return!1;r||(i.html="",i.items=[]);var s,n="",a=!1;return r&&(n+="<ul>"),e.each(t,function(t,r){return r?(i.items.push(r),!a&&r.separator_before&&(n+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,n+="<li class='"+(r._class||"")+(r._disabled===!0||e.isFunction(r._disabled)&&r._disabled({item:r,reference:i.reference,element:i.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">",n+="<a href='#' rel='"+(i.items.length-1)+"'>",e.vakata.context.settings.icons&&(n+="<i ",r.icon&&(n+=-1!==r.icon.indexOf("/")||-1!==r.icon.indexOf(".")?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),n+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),n+=(e.isFunction(r.label)?r.label({item:t,reference:i.reference,element:i.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"</span>":"")+"</a>",r.submenu&&(s=e.vakata.context._parse(r.submenu,!0),s&&(n+=s)),n+="</li>",void(r.separator_after&&(n+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0))):!0}),n=n.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(n+="</ul>"),r||(i.html=n,e.vakata.context._trigger("parse")),n.length>10?n:!1},_show_submenu:function(i){if(i=e(i),i.length&&i.children("ul").length){var r=i.children("ul"),s=i.offset().left+i.outerWidth(),n=i.offset().top,a=r.width(),o=r.height(),d=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?i[s-(a+10+i.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):i[s+a+10>d?"addClass":"removeClass"]("vakata-context-right"),n+o+10>c&&r.css("bottom","-1px"),r.show()}},show:function(r,s,n){var a,o,d,c,l,h,_,u,g=!0;switch(i.element&&i.element.length&&i.element.width(""),g){case!s&&!r:return!1;case!!s&&!!r:i.reference=r,i.position_x=s.x,i.position_y=s.y;break;case!s&&!!r:i.reference=r,a=r.offset(),i.position_x=a.left+r.outerHeight(),i.position_y=a.top;break;case!!s&&!r:i.position_x=s.x,i.position_y=s.y}r&&!n&&e(r).data("vakata_contextmenu")&&(n=e(r).data("vakata_contextmenu")),e.vakata.context._parse(n)&&i.element.html(i.html),i.items.length&&(i.element.appendTo("body"),o=i.element,d=i.position_x,c=i.position_y,l=o.width(),h=o.height(),_=e(window).width()+e(window).scrollLeft(),u=e(window).height()+e(window).scrollTop(),t&&(d-=o.outerWidth()-e(r).outerWidth(),d<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20)),d+l+20>_&&(d=_-(l+20)),c+h+20>u&&(c=u-(h+20)),i.element.css({left:d,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),i.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){i.is_visible&&(i.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),i.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var r=!1;i.element=e("<ul class='vakata-context'></ul>"),i.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(r&&clearTimeout(r),i.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(r=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var r=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:i.is_visible&&(i.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:i.is_visible&&(r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:i.is_visible&&(i.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:i.is_visible&&(r=i.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=i.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=i.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(l).on("mousedown.vakata.jstree",function(t){i.is_visible&&!e.contains(i.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,r){i.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&i.element.addClass("vakata-context-rtl").css("direction","rtl"),i.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},e.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){
if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),r=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,s=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);return this.settings.core.force_text&&(s=e.vakata.html.escape(s)),i&&i.id&&i.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[i],t))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:r>1?this.get_top_selected():[i.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+s+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},e(function(){var t=!1,i=!1,r=!1,s=!1,n=e('<div id="jstree-marker">&#160;</div>').hide();e(l).on("dnd_start.vakata.jstree",function(e,i){t=!1,r=!1,i&&i.data&&i.data.jstree&&n.appendTo("body")}).on("dnd_move.vakata.jstree",function(a,o){if(s&&clearTimeout(s),o&&o.data&&o.data.jstree&&(!o.event.target.id||"jstree-marker"!==o.event.target.id)){r=o.event;var d,c,l,h,_,u,g,f,p,m,v,j,y,k,x=e.jstree.reference(o.event.target),b=!1,w=!1,C=!1;if(x&&x._data&&x._data.dnd)if(n.attr("class","jstree-"+x.get_theme()+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+x.get_theme()+" jstree-"+x.get_theme()+"-"+x.get_theme_variant()+" "+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),o.event.target!==x.element[0]&&o.event.target!==x.get_container_ul()[0]||0!==x.get_container_ul().children().length){if(b=x.settings.dnd.large_drop_target?e(o.event.target).closest(".jstree-node").children(".jstree-anchor"):e(o.event.target).closest(".jstree-anchor"),b&&b.length&&b.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(w=b.offset(),C=o.event.pageY-w.top,l=b.outerHeight(),u=l/3>C?["b","i","a"]:C>l-l/3?["a","i","b"]:C>l/2?["i","a","b"]:["i","b","a"],e.each(u,function(r,a){switch(a){case"b":d=w.left-6,c=w.top,h=x.get_parent(b),_=b.parent().index();break;case"i":y=x.settings.dnd.inside_pos,k=x.get_node(b.parent()),d=w.left-2,c=w.top+l/2+1,h=k.id,_="first"===y?0:"last"===y?k.children.length:Math.min(y,k.children.length);break;case"a":d=w.left-6,c=w.top+l,h=x.get_parent(b),_=b.parent().index()+1}for(g=!0,f=0,p=o.data.nodes.length;p>f;f++)if(m=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",v=_,"move_node"===m&&"a"===a&&o.data.origin&&o.data.origin===x&&h===x.get_parent(o.data.nodes[f])&&(j=x.get_node(h),v>e.inArray(o.data.nodes[f],j.children)&&(v-=1)),g=g&&(x&&x.settings&&x.settings.dnd&&x.settings.dnd.check_while_dragging===!1||x.check(m,o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[f]):o.data.nodes[f],h,v,{dnd:!0,ref:x.get_node(b.parent()),pos:a,origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin})),!g){x&&x.last_error&&(i=x.last_error());break}return"i"===a&&b.parent().is(".jstree-closed")&&x.settings.dnd.open_timeout&&(s=setTimeout(function(e,t){return function(){e.open_node(t)}}(x,b),x.settings.dnd.open_timeout)),g?(t={ins:x,par:h,pos:"i"!==a||"last"!==y||0!==_||x.is_loaded(k)?_:"last"},n.css({left:d+"px",top:c+"px"}).show(),o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),i={},u=!0,!1):void 0}),u===!0))return}else{for(g=!0,f=0,p=o.data.nodes.length;p>f&&(g=g&&x.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[f]):o.data.nodes[f],e.jstree.root,"last",{dnd:!0,ref:x.get_node(e.jstree.root),pos:"i",origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin}),g);f++);if(g)return t={ins:x,par:e.jstree.root,pos:"last"},n.hide(),void o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")}t=!1,o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),n.hide()}}).on("dnd_scroll.vakata.jstree",function(e,i){i&&i.data&&i.data.jstree&&(n.hide(),t=!1,r=!1,i.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(a,o){if(s&&clearTimeout(s),o&&o.data&&o.data.jstree){n.hide().detach();var d,c,l=[];if(t){for(d=0,c=o.data.nodes.length;c>d;d++)l[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d];t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](l,t.par,t.pos,!1,!1,!1,o.data.origin)}else d=e(o.event.target).closest(".jstree"),d.length&&i&&i.error&&"check"===i.error&&(d=d.jstree(!0),d&&d.settings.core.error.call(this,i));r=!1,t=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=e.vakata.dnd._get(),i&&i.data&&i.data.jstree&&(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),r&&(r.metaKey=t.metaKey,r.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",r)))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,i){var r=e.vakata.dnd._get();r.event=i,e(l).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var r=t.scroll_e.scrollTop(),s=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(r+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(s+t.scroll_l*e.vakata.dnd.settings.scroll_speed),(r!==t.scroll_e.scrollTop()||s!==t.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(i,r,s){"touchstart"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{i.currentTarget.unselectable="on",i.currentTarget.onselectstart=function(){return!1},i.currentTarget.style&&(i.currentTarget.style.MozUserSelect="none")}catch(n){}return t.init_x=i.pageX,t.init_y=i.pageY,t.data=r,t.is_down=!0,t.element=i.currentTarget,t.target=i.target,t.is_touch="touchstart"===i.type,s!==!1&&(t.helper=e("<div id='vakata-dnd'></div>").html(s).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(l).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(i){if("touchmove"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(i.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(i.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e.vakata.dnd._trigger("start",i)}var r=!1,s=!1,n=!1,a=!1,o=!1,d=!1,c=!1,h=!1,_=!1,u=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var r=e(this),s=r.offset();return this.scrollHeight>this.offsetHeight&&(s.top+r.height()-i.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),i.pageY-s.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(s.left+r.width()-i.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),i.pageX-s.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=e(this),!1):void 0}),t.scroll_e||(r=e(l),s=e(window),n=r.height(),a=s.height(),o=r.width(),d=s.width(),c=r.scrollTop(),h=r.scrollLeft(),n>a&&i.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),n>a&&a-(i.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),o>d&&i.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),o>d&&d-(i.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=r)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(_=parseInt(i.pageY+e.vakata.dnd.settings.helper_top,10),u=parseInt(i.pageX+e.vakata.dnd.settings.helper_left,10),n&&_+25>n&&(_=n-50),o&&u+t.helper_w>o&&(u=o-(t.helper_w+2)),t.helper.css({left:u+"px",top:_+"px"})),e.vakata.dnd._trigger("move",i),!1}},stop:function(i){if("touchend"===i.type&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(i.pageX=i.originalEvent.changedTouches[0].pageX,i.pageY=i.originalEvent.changedTouches[0].pageY,i.target=l.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)e.vakata.dnd._trigger("stop",i);else if("touchend"===i.type&&i.target===t.target){var r=setTimeout(function(){e(i.target).click()},100);e(i.target).one("click",function(){r&&clearTimeout(r)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,i){this.init=function(e,t){i.init.call(this,e,t),this._data.massload={}},this._load_nodes=function(t,r,s){var n=this.settings.massload;return s&&!e.isEmptyObject(this._data.massload)?i._load_nodes.call(this,t,r,s):e.isFunction(n)?n.call(this,t,e.proxy(function(e){if(e)for(var n in e)e.hasOwnProperty(n)&&(this._data.massload[n]=e[n]);i._load_nodes.call(this,t,r,s)},this)):"object"==typeof n&&n&&n.url?(n=e.extend(!0,{},n),e.isFunction(n.url)&&(n.url=n.url.call(this,t)),e.isFunction(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(e.proxy(function(e,n,a){if(e)for(var o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);i._load_nodes.call(this,t,r,s)},this)).fail(e.proxy(function(e){i._load_nodes.call(this,t,r,s)},this))):i._load_nodes.call(this,t,r,s)},this._load_node=function(t,r){var s=this._data.massload[t.id];return s?this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}):s,function(e){r.call(this,e),delete this._data.massload[t.id]}):i._load_node.call(this,t,r)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(i,r){this.bind=function(){r.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,i){if(this._data.search.som&&i.res.length){var r,s,n=this._model.data,a=[];for(r=0,s=i.res.length;s>r;r++)n[i.res[r]]&&!n[i.res[r]].state.hidden&&(a.push(i.res[r]),a=a.concat(n[i.res[r]].parents),this._data.search.smc&&(a=a.concat(n[i.res[r]].children_d)));a=e.vakata.array_remove_item(e.vakata.array_unique(a),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(a)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&this.show_node(this._data.search.hdn)},this))},this.search=function(i,r,s,n,a,o){if(i===!1||""===e.trim(i.toString()))return this.clear_search();n=this.get_node(n),n=n&&n.id?n.id:null,i=i.toString();var d,c,l=this.settings.search,h=l.ajax?l.ajax:!1,_=this._model.data,u=null,g=[],f=[];if(this._data.search.res.length&&!a&&this.clear_search(),s===t&&(s=l.show_only_matches),o===t&&(o=l.show_only_matches_children),!r&&h!==!1)return e.isFunction(h)?h.call(this,i,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,s,n,a)},!0)},this),n):(h=e.extend({},h),h.data||(h.data={}),h.data.str=i,n&&(h.data.inside=n),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(i,!0,s,n,a)},!0)},this)));if(a||(this._data.search.str=i,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=s,this._data.search.smc=o),u=new e.vakata.search(i,!0,{caseSensitive:l.case_sensitive,fuzzy:l.fuzzy}),e.each(_[n?n:e.jstree.root].children_d,function(e,t){var r=_[t];r.text&&(!l.search_leaves_only||r.state.loaded&&0===r.children.length)&&(l.search_callback&&l.search_callback.call(this,i,r)||!l.search_callback&&u.search(r.text).isMatch)&&(g.push(t),f=f.concat(r.parents))}),g.length){for(f=e.vakata.array_unique(f),d=0,c=f.length;c>d;d++)f[d]!==e.jstree.root&&_[f[d]]&&this.open_node(f[d],null,0)===!0&&this._data.search.opn.push(f[d]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(g))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(g,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=g),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:s})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,i,s,n){if(t=r.redraw_node.apply(this,arguments),t&&-1!==e.inArray(t.id,this._data.search.res)){var a,o,d=null;for(a=0,o=t.childNodes.length;o>a;a++)if(t.childNodes[a]&&t.childNodes[a].className&&-1!==t.childNodes[a].className.indexOf("jstree-anchor")){d=t.childNodes[a];break}d&&(d.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,i,r){r=r||{},r=e.extend({},e.vakata.search.defaults,r),r.fuzzy!==!1&&(r.fuzzy=!0),t=r.caseSensitive?t:t.toLowerCase();var s,n,a,o,d=r.location,c=r.distance,l=r.threshold,h=t.length;return h>32&&(r.fuzzy=!1),r.fuzzy&&(s=1<<h-1,n=function(){var e={},i=0;for(i=0;h>i;i++)e[t.charAt(i)]=0;for(i=0;h>i;i++)e[t.charAt(i)]|=1<<h-i-1;return e}(),a=function(e,t){var i=e/h,r=Math.abs(d-t);return c?i+r/c:r?1:i}),o=function(e){if(e=r.caseSensitive?e:e.toLowerCase(),t===e||-1!==e.indexOf(t))return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var i,o,c,_,u,g,f,p,m,v=e.length,j=l,y=e.indexOf(t,d),k=h+v,x=1,b=[];for(-1!==y&&(j=Math.min(a(0,y),j),y=e.lastIndexOf(t,d+h),-1!==y&&(j=Math.min(a(0,y),j))),y=-1,i=0;h>i;i++){for(c=0,_=k;_>c;)a(i,d+_)<=j?c=_:k=_,_=Math.floor((k-c)/2+c);for(k=_,g=Math.max(1,d-_+1),f=Math.min(d+_,v)+h,p=new Array(f+2),p[f+1]=(1<<i)-1,o=f;o>=g;o--)if(m=n[e.charAt(o-1)],0===i?p[o]=(p[o+1]<<1|1)&m:p[o]=(p[o+1]<<1|1)&m|((u[o+1]|u[o])<<1|1)|u[o+1],p[o]&s&&(x=a(i,o-1),j>=x)){if(j=x,y=o-1,b.push(y),!(y>d))break;g=Math.max(1,2*d-y)}if(a(i+1,d)>j)break;u=p}return{isMatch:y>=0,score:x}},i===!0?{search:o}:o(i)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,i){var r,s;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),i))for(r=0,s=t.children_d.length;s>r;r++)this.sort(t.children_d[r],!1)}};var u=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){u&&clearTimeout(u),u=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(i){return!1}return t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0):!1)},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(i,r){this.init=function(i,s){var n,a;if(s&&s.types&&s.types["default"])for(n in s.types)if("default"!==n&&n!==e.jstree.root&&s.types.hasOwnProperty(n))for(a in s.types["default"])s.types["default"].hasOwnProperty(a)&&s.types[n][a]===t&&(s.types[n][a]=s.types["default"][a]);r.init.call(this,i,s),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,i){r.refresh.call(this,t,i),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(i,r){var s,n,a=this._model.data,o=r.nodes,d=this.settings.types,c="default";for(s=0,n=o.length;n>s;s++)c="default",a[o[s]].original&&a[o[s]].original.type&&d[a[o[s]].original.type]&&(c=a[o[s]].original.type),a[o[s]].data&&a[o[s]].data.jstree&&a[o[s]].data.jstree.type&&d[a[o[s]].data.jstree.type]&&(c=a[o[s]].data.jstree.type),a[o[s]].type=c,a[o[s]].icon===!0&&d[c].icon!==t&&(a[o[s]].icon=d[c].icon);a[e.jstree.root].type=e.jstree.root},this)),r.bind.call(this)},this.get_json=function(t,i,s){var n,a,o=this._model.data,d=i?e.extend(!0,{},i,{no_id:!1}):{},c=r.get_json.call(this,t,d,s);if(c===!1)return!1;if(e.isArray(c))for(n=0,a=c.length;a>n;n++)c[n].type=c[n].id&&o[c[n].id]&&o[c[n].id].type?o[c[n].id].type:"default",i&&i.no_id&&(delete c[n].id,c[n].li_attr&&c[n].li_attr.id&&delete c[n].li_attr.id,c[n].a_attr&&c[n].a_attr.id&&delete c[n].a_attr.id);else c.type=c.id&&o[c.id]&&o[c.id].type?o[c.id].type:"default",i&&i.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,r=t.length;r>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(i,s,n,a,o){if(r.check.call(this,i,s,n,a,o)===!1)return!1;s=s&&s.id?s:this.get_node(s),n=n&&n.id?n:this.get_node(n);var d,c,l,h,_=s&&s.id?o&&o.origin?o.origin:e.jstree.reference(s.id):null;switch(_=_&&_._model&&_._model.data?_._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===e.inArray(s.id,n.children)){if(d=this.get_rules(n),d.max_children!==t&&-1!==d.max_children&&d.max_children===n.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;if(d.valid_children!==t&&-1!==d.valid_children&&-1===e.inArray(s.type||"default",d.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;if(_&&s.children_d&&s.parents){for(c=0,l=0,h=s.children_d.length;h>l;l++)c=Math.max(c,_[s.children_d[l]].parents.length);c=c-s.parents.length+1}(0>=c||c===t)&&(c=1);do{if(d.max_depth!==t&&-1!==d.max_depth&&d.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:a,obj:s&&s.id?s.id:!1,par:n&&n.id?n.id:!1})},!1;n=this.get_node(n.parent),d=this.get_rules(n),c++}while(n)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var i=this.get_type(e,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i},this.get_type=function(t,i){return t=this.get_node(t),t?i?e.extend({type:t.type},this.settings.types[t.type]):t.type:!1},this.set_type=function(i,r){var s,n,a,o,d;if(e.isArray(i)){for(i=i.slice(),n=0,a=i.length;a>n;n++)this.set_type(i[n],r);return!0}return s=this.settings.types,i=this.get_node(i),s[r]&&i?(o=i.type,d=this.get_icon(i),i.type=r,(d===!0||s[o]&&s[o].icon!==t&&d===s[o].icon)&&this.set_icon(i,s[r].icon!==t?s[r].icon:!0),!0):!1}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(i,r){this.check=function(t,i,s,n,a){if(r.check.call(this,t,i,s,n,a)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),s=s&&s.id?s:this.get_node(s),!s||!s.children)return!0;var o,d,c="rename_node"===t?n:i.text,l=[],h=this.settings.unique.case_sensitive,_=this._model.data;for(o=0,d=s.children.length;d>o;o++)l.push(h?_[s.children[o]].text:_[s.children[o]].text.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=-1===e.inArray(c,l)||i.text&&i.text[h?"toString":"toLowerCase"]()===c,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"create_node":return o=-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"copy_node":return o=-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o;case"move_node":return o=i.parent===s.id&&(!a||!a.is_multi)||-1===e.inArray(c,l),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:n,obj:i&&i.id?i.id:!1,par:s&&s.id?s.id:!1})}),o}return!0},this.create_node=function(i,s,n,a,o){if(!s||s.text===t){if(null===i&&(i=e.jstree.root),i=this.get_node(i),!i)return r.create_node.call(this,i,s,n,a,o);if(n=n===t?"last":n,!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return r.create_node.call(this,i,s,n,a,o);s||(s={});var d,c,l,h,_,u=this._model.data,g=this.settings.unique.case_sensitive,f=this.settings.unique.duplicate;for(c=d=this.get_string("New node"),l=[],h=0,_=i.children.length;_>h;h++)l.push(g?u[i.children[h]].text:u[i.children[h]].text.toLowerCase());for(h=1;-1!==e.inArray(g?c:c.toLowerCase(),l);)c=f.call(this,d,++h).toString();s.text=c}return r.create_node.call(this,i,s,n,a,o)}};var g=l.createElement("DIV");if(g.setAttribute("unselectable","on"),g.setAttribute("role","presentation"),g.className="jstree-wholerow",g.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var i,r,s=!1;for(i=0,r=t.selected.length;r>i;i++)s=this.get_node(t.selected[i],!0),s&&s.length&&s.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),i.teardown.call(this)},this.redraw_node=function(t,r,s,n){if(t=i.redraw_node.apply(this,arguments)){var a=g.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},l.registerElement&&Object&&Object.create){var f=Object.create(HTMLElement.prototype);f.createdCallback=function(){var t,i={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(i)};try{l.registerElement("vakata-jstree",{prototype:f})}catch(p){}}}});
/*
 * http://github.com/deitch/jstree-grid
 *
 * This plugin handles adding a grid to a tree to display additional data
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Works only with jstree version >= 3.0.0
 *
 * $Date: 2015-11-29 $
 * $Revision:  3.4.2 $
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery","jstree"],e):e(jQuery)}(function(e){var t,i,r,s,d,n=/^\s*$/g,a=/[\\:&!^|()\[\]<>@*'+~#";,= \/${}%]/g,o=function(e){return(e||"").replace(a,"\\$&")},l="data-jstreegrid",h="_DATA_",c=24,p=!1,g="jsgrid_",u="_col",f=10,v=function(e,t){return e.find("div["+l+"='"+t+"']")},m=!1,j=null,_=0,w=0;s=/<\/?[^>]+>/gi,r=function(t,i){var r,s,d,n;return i._gridSettings=i._gridSettings||{},i._gridSettings.indent>0?n=i._gridSettings.indent:(r=e("<div></div>"),s=t.prev("i"),d=s.parent(),r.addClass(i.get_node("#",!0).attr("class")),d.appendTo(r),r.appendTo(e("body")),n=s.width()||c,d.detach(),r.remove(),i._gridSettings.indent=n),n},d=function(e,t){var i,r=e.get_node(t),s=r.children;return i=!s||s.length<=0||!r.state.opened?t:d(e,s[s.length-1])},t=function(e,t){var i,s,d=parseInt(t.settings.grid.columns[0].width,10)+parseInt(t._gridSettings.treeWidthDiff,10);return i=t.get_node(e).parents.length,s=d-i*r(e,t),d},i=function(e,t,i){var r,d="a"===e.get(0).tagName.toLowerCase()?e:e.children("a"),n=i.settings.grid.columns[0];r="",n.title&&(n.title===h?r=i.get_text(t):t.attr(n.title)&&(r=t.attr(n.title))),r=r.replace(s,""),r&&d.attr("title",r)},e.jstree.defaults.grid={width:"auto"},e.jstree.plugins.grid=function(t,r){this._initialize=function(){if(!this._initialized){var t,i,r=this.settings.grid||{},s=this.element,d=s.parent(),n=this._gridSettings={columns:r.columns||[],treeClass:"jstree-grid-col-0",context:r.contextmenu||!1,columnWidth:r.columnWidth,defaultConf:{"*display":"inline","*+display":"inline"},isThemeroller:!!this._data.themeroller,treeWidthDiff:0,resizable:r.resizable,stateful:r.stateful,indent:0},a=n.columns,o=0;for(i=0;i<r.columns.length;i++)if(r.columns[i].tree){o=i;break}this.uniq=Math.ceil(1e3*Math.random()),this.treecol=o,this.rootid=s.attr("id");var l=/msie/.test(navigator.userAgent.toLowerCase());if(l){var h=parseFloat(navigator.appVersion.split("MSIE")[1]);8>h&&(n.defaultConf.display="inline",n.defaultConf.zoom="1")}for(p||(p=!0,t=[".jstree-grid-cell {vertical-align: top; overflow:hidden;margin-left:0;position:relative;width: 100%;padding-left:7px;white-space: nowrap;}",".jstree-grid-cell span {margin-right:0px;margin-right:0px;*display:inline;*+display:inline;white-space: nowrap;}",".jstree-grid-separator {position:absolute; top:0; right:0; height:24px; margin-left: -2px; border-width: 0 2px 0 0; *display:inline; *+display:inline; margin-right:0px;width:0px;}",".jstree-grid-header-cell {overflow: hidden; white-space: nowrap;padding: 1px 3px 2px 5px;}",".jstree-grid-header-themeroller {border: 0; padding: 1px 3px;}",".jstree-grid-header-regular {position:relative; background-color: #EBF3FD;}",".jstree-grid-resizable-separator {cursor: col-resize; width: 2px;}",".jstree-grid-separator-regular {border-color: #d0d0d0; border-style: solid;}",".jstree-grid-cell-themeroller {border: none !important; background: transparent !important;}",".jstree-grid-wrapper {width: 100%; overflow-x: auto;}",".jstree-grid-midwrapper {display: table-row; overflow: visible;}",".jstree-grid-width-auto {width:auto;display:block;}",".jstree-grid-column {display: table-cell; overflow: hidden;}",".jstree-grid-col-0 {width: 100%;}"],e('<style type="text/css">'+t.join("\n")+"</style>").appendTo("head")),this.gridWrapper=e("<div></div>").addClass("jstree-grid-wrapper").appendTo(d),this.midWrapper=e("<div></div>").addClass("jstree-grid-midwrapper").appendTo(this.gridWrapper),r.width&&this.gridWrapper.width(r.width),i=0;i<a.length;i++)e("<div></div>").addClass("jstree-grid-column jstree-grid-column-"+i+" jstree-grid-column-root-"+this.rootid).appendTo(this.midWrapper);this.midWrapper.children("div:eq("+o+")").append(s),s.addClass("jstree-grid-cell"),this._initialized=!0}},this.init=function(e,t){r.init.call(this,e,t),this._initialize()},this.bind=function(){r.bind.call(this),this._initialize(),this.element.on("move_node.jstree create_node.jstree clean_node.jstree change_node.jstree",e.proxy(function(e,t){this.get_node(t||"#",!0);return '',!1},this)).on("delete_node.jstree",e.proxy(function(e,t){if(void 0!==t.node.id){var i,r=this.gridWrapper,s=[t.node.id];for(t.node&&t.node.children_d&&(s=s.concat(t.node.children_d)),i=0;i<s.length;i++)v(r,s[i]).remove()}},this)).on("close_node.jstree",e.proxy(function(e,t){this._hide_grid(t.node)},this)).on("open_node.jstree",e.proxy(function(e,t){},this)).on("load_node.jstree",e.proxy(function(e,t){},this)).on("loaded.jstree",e.proxy(function(e){this._prepare_headers(),this.element.trigger("loaded_grid.jstree")},this)).on("ready.jstree",e.proxy(function(t,i){var r=this.element.find("li a:first").outerHeight();e('<style type="text/css">div.jstree-grid-cell-root-'+this.rootid+" {line-height: "+r+"px}</style>").appendTo("head"),this.gridWrapper.addClass(this.element.attr("class"))},this)).on("move_node.jstree",e.proxy(function(t,i){var r=i.new_instance.element;r.find("li > a").each(e.proxy(function(e,t){},this))},this)).on("hover_node.jstree",e.proxy(function(e,t,i){var r=t.node.id;null!==this._hover_node&&void 0!==this._hover_node&&v(this.gridWrapper,this._hover_node).removeClass("jstree-hovered"),this._hover_node=r,v(this.gridWrapper,r).addClass("jstree-hovered")},this)).on("dehover_node.jstree",e.proxy(function(e,t,i){var r=t.node.id;this._hover_node=null,v(this.gridWrapper,r).removeClass("jstree-hovered")},this)).on("select_node.jstree",e.proxy(function(e,t,i){var r=t.node.id;v(this.gridWrapper,r).addClass("jstree-clicked"),this.get_node(t.node.id,!0).children("div.jstree-grid-cell").addClass("jstree-clicked")},this)).on("deselect_node.jstree",e.proxy(function(e,t,i){var r=t.node.id;v(this.gridWrapper,r).removeClass("jstree-clicked")},this)).on("deselect_all.jstree",e.proxy(function(e,t,i){var r,s=t.node||[];for(r=0;r<s.length;r++)v(this.gridWrapper,s[r]).removeClass("jstree-clicked")},this)).on("search.jstree",e.proxy(function(e,t){var i=this.gridWrapper;return this._data.search.som&&t.nodes.length&&(i.find("div.jstree-grid-cell-regular").hide(),t.nodes.add(t.nodes.parentsUntil(".jstree")).filter(".jstree-node").each(function(e,t){var r=t.id;r&&v(i,r).show()})),!0},this)).on("clear_search.jstree",e.proxy(function(e,t){return this.gridWrapper.find("div.jstree-grid-cell").show(),!0},this)),this._gridSettings.isThemeroller&&this.element.on("select_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").addClass("ui-state-active")},this)).on("deselect_node.jstree deselect_all.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").removeClass("ui-state-active")},this)).on("hover_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").addClass("ui-state-hover")},this)).on("dehover_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").removeClass("ui-state-hover")},this)),this._gridSettings.stateful&&this.element.on("resize_column.jstree-grid",e.proxy(function(e,t,i){localStorage["jstree-root-"+this.rootid+"-column-"+t]=i},this))},this.teardown=function(){var e=this.gridWrapper,t=this.element,i=e.parent();t.detach(),e.remove(),i.append(t),r.teardown.call(this)},this._clean_grid=function(e,t){var i=this.gridWrapper;e?v(i,t).remove():i.find("div.jstree-grid-cell-regular").remove()},this._prepare_headers=function(){var t,i,r,s,d,n,a,o,l,h,c=this._gridSettings,p=c.columns||[],g=c.columnWidth,u=c.resizable||!1,v=c.isThemeroller,x=v?"themeroller":"regular",y=!1,C=this.gridparent,b=this.rootid,W=c.defaultConf,S=0,z=0;for(this.parent=C,i=0;i<p.length;i++)d=p[i].headerClass||"",n=p[i].columnClass||"",a=p[i].header||"",a&&(y=!0),s=c.stateful&&localStorage["jstree-root-"+b+"-column-"+i]?localStorage["jstree-root-"+b+"-column-"+i]:p[i].width||g,S=v?7:10,"auto"!==s&&"string"!=typeof s&&(s-=S),o=0===i?3:0,r=this.midWrapper.children("div.jstree-grid-column-"+i),l=e("<div></div>").css(W).css({"margin-left":o}).addClass("jstree-grid-div-"+this.uniq+"-"+i+" "+(v?"ui-widget-header ":"")+" jstree-grid-header jstree-grid-header-cell jstree-grid-header-"+x+" "+d+" "+n).html(a),l.addClass((v?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-"+x),l.prependTo(r),z+=l.outerWidth(),h=e("<div class='jstree-grid-separator jstree-grid-separator-"+x+(v?" ui-widget-header":"")+(u?" jstree-grid-resizable-separator":"")+"'>&nbsp;</div>").appendTo(l),r.width(s),r.css("min-width",s),r.css("max-width",s);l.addClass((v?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-last jstree-grid-header-"+x),void 0===p[p.length-1].width&&(z-=s,r.css({width:"auto"}),l.addClass("jstree-grid-width-auto").next(".jstree-grid-separator").remove()),y?c.header=t:e("div.jstree-grid-header").hide(),!this.bound&&u&&(this.bound=!0,e(document).mouseup(function(){var t,i,r,s,d,n;m&&(n=j.prevAll(".jstree-grid-column").length,d=j.closest(".jstree-grid-wrapper").find(".jstree"),t=e.jstree.reference(d),i=t.settings.grid.columns,s=j.parent().children("div.jstree-grid-column"),(isNaN(n)||0>n)&&(t._gridSettings.treeWidthDiff=d.find("ins:eq(0)").width()+d.find("a:eq(0)").width()-t._gridSettings.columns[0].width),r=t._gridSettings.columns[n].width=parseFloat(j.css("width")),m=!1,j=null,d.trigger("resize_column.jstree-grid",[n,r]))}).mousemove(function(e){if(m){w=e.pageX;var t,i,r,s=w-_;0!==s&&(t=j.width(),i=parseFloat(j.css("width")),i||(i=j.innerWidth()),s=0>s?Math.max(s,-t):s,r=i+s,(s>0||t>0)&&r>f&&(j.width(r+"px"),j.css("min-width",r+"px"),j.css("max-width",r+"px"),_=w))}}),this.gridWrapper.on("selectstart",".jstree-grid-resizable-separator",function(){return!1}).on("mousedown",".jstree-grid-resizable-separator",function(t){return m=!0,_=t.pageX,j=e(this).closest("div.jstree-grid-column"),!1}).on("dblclick",".jstree-grid-resizable-separator",function(t){var i,r,s=e(this),d=s.closest("div.jstree-grid-column"),n=parseFloat(d.css("width")),a=0,o=d.prevAll(".jstree-grid-column").length,l=d.width();d.find(".jstree-grid-cell").each(function(){var t,i=e(this);i.css("position","absolute"),i.css("width","auto"),t=i.outerWidth(),i.css("position","relative"),t>a&&(a=t)}),i=a-n,i=0>i?Math.max(i,-l):i,r=n+i+"px",d.width(r),d.css("min-width",r),d.css("max-width",r),e(this).closest(".jstree-grid-wrapper").find(".jstree").trigger("resize_column.jstree-grid",[o,r])}))},this.redraw_node=function(e,t,i,s){return e=r.redraw_node.call(this,e,t,i,s),e&&this._prepare_grid(e),e},this.refresh=function(){return this._clean_grid(),r.refresh.apply(this,arguments)},this.set_id=function(e,t){var i;e&&(i=e.id);var s=r.set_id.apply(this,arguments);if(s&&void 0!==i){var d,n=this.gridWrapper,a=[i];for(e&&e.children_d&&(a=a.concat(e.children_d)),d=0;d<a.length;d++)v(n,a[d]).attr(l,e.id).attr("id",g+e.id+u+(d+1)).removeClass(g+i+u).addClass(g+e.id+u)}return s},this._hide_grid=function(e){var t,i=e&&e.children_d?e.children_d:[];for(t=0;t<i.length;t++)v(this.gridWrapper,i[t]).remove()},this.holdingCells={},this.getHoldingCells=function(t,i,r){var s,d,n=e(),a=t.children||[];for(d=0;d<a.length;d++)s=g+o(a[d])+u+i,r[s]&&t.state.opened&&(n=n.add(r[s]).add(this.getHoldingCells(this.get_node(a[d]),i,r)));return n},this._edit=function(t,i,r){if(!t)return!1;if(!r)return!1;r=e(r),"div"===r.prop("tagName").toLowerCase()&&(r=r.children("span:first"));var s=this._data.core.rtl,d=this.element.width(),n=t.data[i.value],a=e("<div />",{css:{position:"absolute",top:"-200px",left:s?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),o=e("<input />",{value:n,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(){var e=o.val();""===e||e===n?e=n:(t.data[i.value]=e,this.element.trigger("update_cell.jstree-grid",{node:t,col:i.value,value:e,old:n}),this._prepare_grid(this.get_node(t,!0))),o.remove(),r.show()},this),keydown:function(e){var t=e.which;27===t&&(this.value=n),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){o.width(Math.min(a.text("pW"+this.value).width(),d))},keypress:function(e){return 13===e.which?!1:void 0}}),l={fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||""};r.hide(),r.parent().append(o),o.css(l).width(Math.min(a.text("pW"+o[0].value).width(),d))[0].select()},this._prepare_grid=function(t){var r,a,h,c,p,f,m,j,_,w,x,y,C,b,W,S,z,k,T,A,P,F,V,q,D,L,M,N,I,B=this._gridSettings,H=B.treeClass,E=this,U=B.columns||[],X=B.isThemeroller,$=this.element,Q=this.rootid,Y=X?"themeroller":"regular",G=this.get_node(t),J=B.columnWidth,K=B.defaultConf,O=function(t,i,r,s,d){return function(d){i.children(".jstree-anchor").trigger("click.jstree",d),t.trigger("select_cell.jstree-grid",[{value:r,column:s.header,node:i,grid:e(this),sourceName:s.value}])}},R=function(t,i,r,s,d){return function(t){B.context&&(t.preventDefault(),e.vakata.context.show(this,{x:t.pageX,y:t.pageY},{edit:{label:"Edit",action:function(e){var r=d.get_node(i);E._edit(r,s,t.target)}}}))}},Z=function(e,t){return function(){t.hover_node(e)}},ee=function(e,t){return function(){t.dehover_node(e)}},te=this.midWrapper,ie=G.id,re=this.get_node(G.parent).children,se=jQuery.inArray(ie,re),de=this.holdingCells,ne=!1;if(r=e(t),_=r.children("a"),1===_.length){for(I=!G.state.opened,S=g+o(ie)+u,z="#"===G.parent?null:G.parent,_.addClass(H),i(_,r,E),w=_,c=0;c<U.length;c++)this.treecol!==c&&(D=U[c],N=te.children("div:eq("+c+")"),f=D.cellClass||"",m=D.wideCellClass||"",j=D.columnClass||"",N.addClass(j),p=void 0!==D.value&&null!==D.value?"function"==typeof D.value?D.value(G):null!==G.data&&void 0!==G.data&&void 0!==G.data[D.value]?G.data[D.value]:"":"","function"==typeof D.format&&(p=D.format(p)),D.images?(h=D.images[p]||D.images["default"],h&&(L="*"===h[0]?'<span class="'+h.substr(1)+'"></span>':'<img src="'+h+'">')):L=p,(void 0===L||null===L||n.test(L))&&(L="&nbsp;"),x=D.valueClass&&null!==G.data&&void 0!==G.data?G.data[D.valueClass]||"":"",x&&D.valueClassPrefix&&""!==D.valueClassPrefix&&(x=D.valueClassPrefix+x),y=D.wideValueClass&&null!==G.data&&void 0!==G.data?G.data[D.wideValueClass]||"":"",y&&D.wideValueClassPrefix&&""!==D.wideValueClassPrefix&&(y=D.wideValueClassPrefix+y),W=D.title&&null!==G.data&&void 0!==G.data?G.data[D.title]||"":"",W=W.replace(s,""),b=7,a=D.width||J,"auto"!==a&&(a=M||a-b),w=v(N,ie),(!w||w.length<1)&&(w=e("<div></div>"),e("<span></span>").appendTo(w),w.attr("id",S+c),w.addClass(S),w.attr(l,ie)),A=0>=se?G.parent:d(this,re[se-1]),T=v(N,A),F=se>=re.length-1?"NULL":re[se+1],P=v(N,F),q=G.children&&G.children.length>0?G.children[0]:"NULL",V=v(N,q),k=v(N,z),z?(k&&k.length>0?(T&&T.length>0?w.insertAfter(T):V&&V.length>0?w.insertBefore(V):P&&P.length>0?w.insertBefore(P):w.insertAfter(k),ne=!0):ne=!1,de[S+c]=w):(T&&T.length>0?w.insertAfter(T):V&&V.length>0?w.insertBefore(V):P&&P.length>0?w.insertBefore(P):w.appendTo(N),ne=!0),ne&&w.after(this.getHoldingCells(G,c,de)),C=w.children("span"),C.addClass(f+" "+x).html(L),w=w.css(K).addClass("jstree-grid-cell jstree-grid-cell-regular jstree-grid-cell-root-"+Q+" jstree-grid-cell-"+Y+" "+m+" "+y+(X?" ui-state-default":"")).addClass("jstree-grid-col-"+c),w.click(O($,r,p,D,this)),w.on("contextmenu",R($,r,p,D,this)),w.hover(Z(r,this),ee(r,this)),W&&C.attr("title",W));w.addClass("jstree-grid-cell-last"+(X?" ui-state-default":"")),void 0===U[U.length-1].width&&w.addClass("jstree-grid-width-auto").next(".jstree-grid-separator").remove()}this.element.css({"overflow-y":"auto !important"})},this.holdingCells={}}});
/*
 * Copyright https://github.com/divio/django-cms
 */

// #############################################################################
// NAMESPACES
/**
 * @module CMS
 */
var CMS = window.CMS || {};

// #############################################################################
// MODAL
(function ($) {
    'use strict';

    /**
     * The pagetree is loaded via `/admin/cms/page` and has a custom admin
     * templates stored within `templates/admin/cms/page/tree`.
     *
     * @class PageTree
     * @namespace CMS
     * @uses CMS.API.Helpers
     */
    CMS.PageTree = new CMS.Class({
        // TODO add mechanics to set the home page
        initialize: function initialize(options) {
            // options are loaded from the pagetree html node
            this.options = $('.js-cms-pagetree').data('json');
            this.options = $.extend(true, {}, this.options, options);

            // states and events
            this.click = 'click.cms.pagetree';
            this.cache = {
                id: null,
                target: null,
                type: ''
            };
            this.successTimer = 1000;

            // elements
            this._setupUI();
            this._events();

            // cancel if pagtree is not available
            if (!$.isEmptyObject(this.options)) {
                this._setup();
            }
        },

        /**
         * Stores all jQuery references within `this.ui`.
         *
         * @method _setupUI
         * @private
         */
        _setupUI: function _setupUI() {
            var pagetree = $('.cms-pagetree');
            this.ui = {
                container: pagetree,
                document: $(document),
                tree: pagetree.find('.js-cms-pagetree'),
                dialog: $('.js-cms-tree-dialog'),
                siteForm: $('.js-cms-pagetree-site-form')
            };
        },

        /**
         * Setting up the jstree and the related columns.
         *
         * @method _setup
         * @private
         */
        _setup: function _setup() {
            var that = this;
            var columns = [];
            var obj = {
                language: this.options.lang.code,
                openNodes: []
            };
            var data = false;

            // make sure that ajax request send the csrf token
            CMS.API.Helpers.csrf(this.options.csrf);

            // setup column headings
            $.each(this.options.columns, function (index, obj) {
                if (obj.key === '') {
                    // the first row is already populated, to avoid overwrites
                    // just leave the "key" param empty
                    columns.push({
                        header: obj.title,
                        width: obj.width || '1%',
                        wideCellClass: obj.cls
                    });
                } else {
                    columns.push({
                        header: obj.title,
                        value: function (node) {
                            // it needs to have the "colde" format and not "col-de"
                            // as jstree will convert "col-de" to "colde"
                            // also we strip dashes, in case language code contains it
                            // e.g. zh-hans, zh-cn etc
                            if (node.data) {
                                return node.data['col' + obj.key.replace('-', '')];
                            } else {
                                return '';
                            }
                        },
                        width: obj.width || '1%',
                        wideCellClass: obj.cls
                    });
                }
            });

            // prepare data
            if (!this.options.filtered) {
                data = {
                    url: this.options.urls.tree,
                    data: function (node) {
                        // '#' is rendered if its the root node, there we only
                        // care about `obj.openNodes`, in the following case
                        // we are requesting a specific node
                        if (node.id !== '#') {
                            obj.pageId = that._storeNodeId(node.data.id);
                        } else {
                            obj.pageId = null;
                        }

                        // we need to store the opened items inside the localstorage
                        // as we have to load the pagetree with the previous opened
                        // state
                        obj.openNodes = that._getStoredNodeIds();

                        // we need to set the site id to get the correct tree
                        obj.site = that.options.site;

                        return obj;
                    }
                };
            }

            // bind options to the jstree instance
            this.ui.tree.jstree({
                core: {
                    // disable open/close animations
                    animation: 0,
                    // core setting to allow actions
                    check_callback: function () {
                        // cancel dragging when filtering is active by setting `false`
                        return (that.options.filtered) ? false : true;
                    },
                    // https://www.jstree.com/api/#/?f=$.jstree.defaults.core.data
                    data: data,
                    // strings used within jstree that are called using `get_string`
                    strings: {
                        'Loading ...': this.options.lang.loading,
                        'New node': this.options.lang.newNode,
                        'nodes': this.options.lang.nodes
                    },
                    error: function (error) {
                        that.showError(error.reason);
                    },
                    themes: {
                        name: 'django-cms'
                    },
                    // disable the multi selection of nodes for now
                    multiple: false
                },
                // activate drag and drop plugin
                plugins : ['dnd', 'search', 'grid'],
                // https://www.jstree.com/api/#/?f=$.jstree.defaults.dnd
                dnd: {
                    inside_pos: 'last',
                    // disable the multi selection of nodes for now
                    drag_selection: false,
                    // disable dragging if filtered
                    is_draggable: function () {
                        return (that.options.filtered) ? false : true;
                    },
                    // disable CMD/CTRL copy
                    copy: false
                },
                // https://github.com/deitch/jstree-grid
                grid: {
                    // columns are provided from base.html options
                    width: '100%',
                    columns: columns
                }
            });
        },

        /**
         * Sets up all the event handlers, such as opening and moving.
         *
         * @method _events
         * @private
         */
        _events: function _events() {
            var that = this;

            // set events for the nodeId updates
            this.ui.tree.on('after_close.jstree', function (e, el) {
                that._removeNodeId(el.node.data.id);
            });
            this.ui.tree.on('after_open.jstree', function (e, el) {
                that._storeNodeId(el.node.data.id);
                that._checkHelpers();
            });

            // store moved position node
            this.ui.tree.on('move_node.jstree copy_node.jstree', function (e, obj) {
                if (!that.cache.type || that.cache.type === 'cut') {
                    that._moveNode(that._getNodePosition(obj)).done(function () {
                        var instance = that.ui.tree.jstree(true);

                        instance._hide_grid(instance.get_node(obj.parent));
                        if (obj.parent === '#') {
                            instance.refresh();
                        } else {
                            // have to refresh parent, because refresh only
                            // refreshes children of the node, never the node itself
                            instance.refresh_node(obj.parent);
                        }
                    });
                } else {
                    that._copyNode(obj);
                }
                // we need to open the parent node if we trigger an element
                // if not already opened
                that.ui.tree.jstree('open_node', obj.parent);
            });

            // set event for cut and paste
            this.ui.container.on(this.click, '.js-cms-tree-item-cut', function (e) {
                e.preventDefault();
                that._cutOrCopy({ type: 'cut', element: $(this) });
            });

            // set event for cut and paste
            this.ui.container.on(this.click, '.js-cms-tree-item-copy', function (e) {
                e.preventDefault();
                that._cutOrCopy({ type: 'copy', element: $(this) });
            });

            // attach events to paste
            this.ui.container.on(this.click, '.cms-tree-item-helpers a', function (e) {
                e.preventDefault();
                that._paste(e);
            });

            // advanced settings link handling
            this.ui.container.on(this.click, '.js-cms-tree-advanced-settings', function (e) {
                if (e.shiftKey) {
                    e.preventDefault();
                    window.location.href = $(this).data('url');
                }
            });

            // add events for error reload (messagelist)
            this.ui.document.on(this.click, '.messagelist .cms-tree-reload', function (e) {
                e.preventDefault();
                that._reloadHelper();
            });

            // propagnate the sites dropdown to the hidden sites form
            this.ui.container.find('.js-cms-pagetree-site-trigger').on(this.click, function (e) {
                e.preventDefault();
                // prevent if parent is active
                if ($(this).parent().hasClass('active')) {
                    return false;
                }
                that.ui.siteForm.find('select')
                    .val($(this).data().id).end().submit();
            });

            // additional event handlers
            this._setTooltips();
            this._setSearch();

            // make sure ajax post requests are working
            this._setAjaxPost('.js-cms-tree-item-menu a');
            this._setAjaxPost('.js-cms-tree-lang-trigger');
        },

        /**
         * Helper to process the cut and copy events.
         *
         * @method _cutOrCopy
         * @param {Object} [opts]
         * @param {Number} [opts.type] either 'cut' or 'copy'
         * @param {Number} [opts.element] originated trigger element
         * @private
         */
        _cutOrCopy: function _cutOrCopy(obj) {
            // prevent actions if you try to copy a page with an apphook
            if (obj.type === 'copy' && obj.element.data().apphook) {
                this.showError(this.options.lang.apphook);
                return false;
            }

            var jsTreeId = this._getNodeId(obj.element.closest('.jstree-grid-cell'));
            // resets if we click again
            if (this.cache.type === obj.type && jsTreeId === this.cache.id) {
                this.cache.type = null;
                this._hideHelpers();
            } else {
                // we need to cache the node and type so `_showHelpers`
                // will trigger the correct behaviour
                this.cache.target = obj.element;
                this.cache.type = obj.type;
                this.cache.id = jsTreeId;
                this._showHelpers();
                this._checkHelpers();
            }
        },

        /**
         * Helper to process the paste event.
         *
         * @method _paste
         * @private
         * @return {Object} event originated event handler
         */
        _paste: function _paste(event) {
            // hide helpers after we picked one
            this._hideHelpers();

            var copyFromId = this._getNodeId(this.cache.target);
            var copyToId = this._getNodeId($(event.currentTarget));

            // copyToId contains `jstree-1`, assign to root
            if (copyToId.indexOf('jstree-1') > -1) {
                copyToId = '#';
            }

            if (this.cache.type === 'cut') {
                this.ui.tree.jstree('cut', copyFromId);
            } else {
                this.ui.tree.jstree('copy', copyFromId);
            }

            this.ui.tree.jstree('paste', copyToId, 'last');
            this.cache.type = null;
            this.cache.target = null;
        },

        /**
         * Retreives a list of nodes from local storage.
         *
         * @method _getStoredNodeIds
         * @private
         * @return {Array} list of ids
         */
        _getStoredNodeIds: function _getStoredNodeIds() {
            return CMS.settings.pagetree || [];
        },

        /**
         * Stores a node in local storage.
         *
         * @method _storeNodeId
         * @private
         * @param {String} id to be stored
         * @return {String} id that has been stored
         */
        _storeNodeId: function _storeNodeId(id) {
            var number = id;
            var storage = this._getStoredNodeIds();

            // store value only if it isn't there yet
            if (storage.indexOf(number) === -1) {
                storage.push(number);
            }

            CMS.settings.pagetree = storage;
            CMS.API.Helpers.setSettings(CMS.settings);

            return number;
        },

        /**
         * Removes a node in local storage.
         *
         * @method _removeNodeId
         * @private
         * @param {String} id to be stored
         * @return {String} id that has been removed
         */
        _removeNodeId: function _removeNodeId(id) {
            var number = id;
            var storage = this._getStoredNodeIds();
            var index = storage.indexOf(number);

            // remove given id from storage
            if (index !== -1) {
                storage.splice(index, 1);
            }

            CMS.settings.pagetree = storage;
            CMS.API.Helpers.setSettings(CMS.settings);

            return number;
        },

        /**
         * Moves a node after drag & drop.
         *
         * @method _moveNode
         * @param {Object} [opts]
         * @param {Number} [opts.id] current element id for url matching
         * @param {Number} [opts.target] target sibling or parent
         * @param {Number} [opts.position] either `left`, `right` or `last-child`
         * @returns {$.Deferred} ajax request object
         * @private
         */
        _moveNode: function _moveNode(obj) {
            var that = this;
            obj.site = that.options.site;

            return $.ajax({
                method: 'post',
                url: that.options.urls.move.replace('{id}', obj.id),
                data: obj
            }).done(function () {
                that._showSuccess(obj.id);
            }).fail(function (error) {
                that.showError(error.statusText);
            });
        },

        /**
         * Copies a node into the selected node.
         *
         * @method _copyNode
         * @param {String} copyFromId element to be cut
         * @param {String} copyToId destination to inject
         * @private
         */
        _copyNode: function _copyNode(obj) {
            var that = this;
            var node = that._getNodePosition(obj);
            var data = {
                site: this.options.site,
                // we need to refer to the original item here, as the copied
                // node will have no data attributes stored at it (not a clone)
                id: obj.original.data.id,
                position: node.position
            };

            // if there is no target provided, the node lands in root
            if (node.target) {
                data.target = node.target;
            }

            // we need to load a dialog first, to check if permissions should
            // be copied or not
            $.ajax({
                method: 'post',
                url: that.options.urls.copyPermission.replace('{id}', data.id),
                data: data
            // the dialog is loaded via the ajax respons originating from
            // `templates/admin/cms/page/tree/copy_premissions.html`
            }).done(function (dialog) {
                that.ui.dialog.append(dialog);
            }).fail(function (error) {
                that.showError(error.statusText);
            });

            // attach events to the permission dialog
            this.ui.dialog.off(this.click, '.cancel').on(this.click, '.cancel', function (e) {
                e.preventDefault();
                // remove just copied node
                that.ui.tree.jstree('delete_node', obj.node.id);
                $('.js-cms-dialog').remove();
                $('.js-cms-dialog-dimmer').remove();
            }).off(this.click, '.submit').on(this.click, '.submit', function (e) {
                e.preventDefault();
                var formData = $(this).closest('form').serialize().split('&');
                // loop through form data and attach to obj
                for (var i = 0; i < formData.length; i++) {
                    data[formData[i].split('=')[0]] = formData[i].split('=')[1];
                }
                // send the real ajax request for copying the plugin
                $.ajax({
                    method: 'post',
                    url: that.options.urls.copy.replace('{id}', data.id),
                    data: data
                }).done(function () {
                    that._reloadHelper();
                }).fail(function (error) {
                    that.showError(error.statusText);
                });
            });
        },

        /**
         * Returns element from any sub nodes.
         *
         * @method _getElement
         * @private
         * @param {jQuery} el jQuery node form where to search
         * @return {String|Boolean} jsTree node element id
         */
        _getNodeId: function _getElement(el) {
            var cls = el.closest('.jstree-grid-cell').attr('class');

            return (cls) ? cls.replace(/.*jsgrid_(.+?)_col.*/, '$1') : false;
        },

        /**
         * Gets the new node position after moving.
         *
         * @method _getNodePosition
         * @private
         * @param {Object} obj jstree move object
         * @return {Object} evaluated object with params
         */
        _getNodePosition: function _getNodePosition(obj) {
            var data = {};
            var node = this.ui.tree.jstree('get_node', obj.node.parent);

            data.position = obj.position;

            // jstree indicates no parent with `#`, in this case we do not
            // need to set the target attribute at all
            if (obj.parent !== '#') {
                data.target = node.data.id;
            }

            // some functions like copy create a new element with a new id,
            // in this case we need to set `data.id` manually
            if (obj.node && obj.node.data) {
                data.id = obj.node.data.id;
            }

            return data;
        },

        /**
         * Sets up general tooltips that can have a list of links or content.
         *
         * @method _setTooltips
         * @private
         */
        _setTooltips: function _setTooltips() {
            var that = this;
            var triggerCls = '.js-cms-tree-tooltip-trigger';
            var containerCls = '.js-cms-tree-tooltip-container';
            var triggers;
            var containers;
            var index;

            // attach event to the trigger
            this.ui.container.on(this.click, triggerCls, function (e) {
                e.preventDefault();
                e.stopImmediatePropagation();

                triggers = $(triggerCls);
                containers = $(containerCls);
                index = triggers.index(this);

                // cancel if opened tooltip is triggered again
                if (containers.eq(index).is(':visible')) {
                    containers.removeClass('cms-tree-tooltip-container-open');
                    return false;
                }

                // otherwise show the dropdown
                containers
                    .removeClass('cms-tree-tooltip-container-open')
                    .eq(index)
                    .addClass('cms-tree-tooltip-container-open');

                that.ui.document.one(that.click, function () {
                    containers.removeClass('cms-tree-tooltip-container-open');
                });
            });

            // stop propagnation on the element
            this.ui.container.on(this.click, containerCls, function (e) {
                e.stopImmediatePropagation();
            });
        },

        /**
         * Triggers the links `href` as ajax post request.
         *
         * @method _setAjaxPost
         * @private
         * @param {jQuery} trigger jQuery link target
         */
        _setAjaxPost: function _setAjaxPost(trigger) {
            var that = this;

            this.ui.container.on(this.click, trigger, function (e) {
                e.preventDefault();
                $.ajax({
                    method: 'post',
                    url: $(this).attr('href')
                }).done(function () {
                    if (window.self !== window.top) {
                        // if we're in the sideframe we have to actually
                        // check if we are publishing a page we're currently in
                        // because if the slug did change we would need to
                        // redirect to that new slug
                        // Problem here is that in case of the apphooked page
                        // the model and pk are empty and reloadBrowser doesn't really
                        // do anything - so here we specifically force the data
                        // to be the data about the page and not the model
                        var parent = (window.parent ? window.parent : window);
                        var data = {
                            // FIXME shouldn't be hardcoded
                            model: 'cms.page',
                            pk: parent.CMS.config.request.page_id
                        };
                        CMS.API.Helpers.reloadBrowser(false, false, true, data);
                    } else {
                        // otherwise simply reload the page
                        that._reloadHelper();
                    }
                }).fail(function (error) {
                    that.showError(error.statusText);
                });
            });
        },

        /**
         * Sets events for the search on the header.
         *
         * @method _setSearch
         * @private
         */
        _setSearch: function () {
            var trigger = this.ui.container.find('.js-cms-pagetree-header-filter-trigger');
            var container = this.ui.container.find('.js-cms-pagetree-header-filter-container');
            var close = container.find('.js-cms-pagetree-header-search-close');
            var visibleForm = this.ui.container.find('.js-cms-pagetree-header-search');
            var hiddenForm = this.ui.container.find('.js-cms-pagetree-header-search-copy form');

            trigger.add(close).on(this.click, function (e) {
                e.preventDefault();
                container.toggle();
                container.parent()
                    .toggleClass('cms-pagetree-header-search-field-active');
            });

            // add hidden fields
            visibleForm.append(hiddenForm.find('input[type="hidden"]'));
        },

        /**
         * Shows paste helpers.
         *
         * @method _showHelpers
         * @private
         */
        _showHelpers: function _showHelpers() {
            // helpers are generated on the fly, so we need to reference
            // them every single time
            $('.cms-tree-item-helpers').removeClass('cms-hidden');
        },

        /**
         * Hides paste helpers.
         *
         * @method _hideHelpers
         * @private
         */
        _hideHelpers: function _hideHelpers() {
            // helpers are generated on the fly, so we need to reference
            // them every single time
            $('.cms-tree-item-helpers').addClass('cms-hidden');
            this.cache.id = null;
        },

        /**
         * Checks the current state of the helpers after `after_open.jstree`
         * or `_cutOrCopy` is triggered.
         *
         * @method _checkHelpers
         * @private
         */
        _checkHelpers: function _checkHelpers() {
            if (this.cache.type && this.cache.id) {
                this._showHelpers(this.cache.type);
            }

            // hide cut element and it's descendants' paste helpers if it is visible
            if (this.cache.type === 'cut' && this.cache.target) {
                var descendantIds = this.ui.tree.jstree(true).get_node(this.cache.id).children_d;

                [this.cache.id].concat(descendantIds).forEach(function (id) {
                    $('.jsgrid_' + id + '_col .cms-tree-item-helpers')
                        .addClass('cms-hidden');
                });
            }
        },

        /**
         * Shows success message on node after successful action.
         *
         * @method _showSuccess
         * @param {Number} id id of the element to add the success class
         * @private
         */
        _showSuccess: function _showSuccess(id) {
            var element = this.ui.tree.find('li[data-id="' + id + '"]');
            element.addClass('cms-tree-node-success');
            setTimeout(function () {
                element.removeClass('cms-tree-node-success');
            }, this.successTimer);
            // hide elements
            this._hideHelpers();
        },

        /**
         * Checks if we should reload the iframe or entire window. For this we
         * need to skip `CMS.API.Helpers.reloadBrowser();`.
         *
         * @method _reloadHelper
         * @private
         */
        _reloadHelper: function _reloadHelper() {
            if (window.self !== window.top) {
                window.location.reload();
            } else {
                CMS.API.Helpers.reloadBrowser();
            }
        },

        /**
         * Displays an error within the django UI.
         *
         * @method showError
         * @param {String} message string message to display
         */
        showError: function showError(message) {
            var messages = $('.messagelist');
            var breadcrumb = $('.breadcrumbs');
            var reload = this.options.lang.reload;
            var tpl = '' +
                '<ul class="messagelist">' +
                '   <li class="error">' +
                '       {msg} ' +
                '       <a href="#reload" class="cms-tree-reload"> ' + reload + ' </a>' +
                '   </li>' +
                '</ul>';
            var msg = tpl.replace('{msg}', '<strong>' + this.options.lang.error + '</strong> ' + message);

            messages.length ? messages.replaceWith(msg) : breadcrumb.after(msg);
        }

    });

    // shorthand for jQuery(document).ready();
    $(function () {
        // load cms settings beforehand
        // have to set toolbar to "expanded" by default
        // otherwise initialization will be incorrect when you
        // go first to pages and then to normal page
        CMS.config = {
            settings: {
                toolbar: 'expanded'
            },
            urls: {
                settings: $('.js-cms-pagetree').data('settings-url')
            }
        };
        CMS.settings = CMS.API.Helpers.getSettings();
        // autoload the pagetree
        new CMS.PageTree();
    });

})(CMS.$);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzdHJlZS5taW4uanMiLCJqc3RyZWUuZ3JpZC5taW4uanMiLCJjbXMucGFnZXRyZWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImJ1bmRsZS5hZG1pbi5wYWdldHJlZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICAgIFRISVMgRklMRSBIQVMgQkVFTiBNQU5VQUxMWSBQQVRDSEVEIFVOVElMIFBSICMxMzQyIEdFVFMgUkVMRUFTRURcbiAgICBodHRwczovL2dpdGh1Yi5jb20vdmFrYXRhL2pzdHJlZS9wdWxsLzEzNDIvZmlsZXNcbiAqL1xuIWZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW1wianF1ZXJ5XCJdLGUpOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcImpxdWVyeVwiKSk6ZShqUXVlcnkpfShmdW5jdGlvbihlLHQpe1widXNlIHN0cmljdFwiO2lmKCFlLmpzdHJlZSl7dmFyIGkscixzPTAsbj0hMSxhPSExLG89ITEsZD1bXSxjPWUoXCJzY3JpcHQ6bGFzdFwiKS5hdHRyKFwic3JjXCIpLGw9d2luZG93LmRvY3VtZW50LGg9bC5jcmVhdGVFbGVtZW50KFwiTElcIik7aC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJ0cmVlaXRlbVwiKSxpPWwuY3JlYXRlRWxlbWVudChcIklcIiksaS5jbGFzc05hbWU9XCJqc3RyZWUtaWNvbiBqc3RyZWUtb2NsXCIsaS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJwcmVzZW50YXRpb25cIiksaC5hcHBlbmRDaGlsZChpKSxpPWwuY3JlYXRlRWxlbWVudChcIkFcIiksaS5jbGFzc05hbWU9XCJqc3RyZWUtYW5jaG9yXCIsaS5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsXCIjXCIpLGkuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIixcIi0xXCIpLHI9bC5jcmVhdGVFbGVtZW50KFwiSVwiKSxyLmNsYXNzTmFtZT1cImpzdHJlZS1pY29uIGpzdHJlZS10aGVtZWljb25cIixyLnNldEF0dHJpYnV0ZShcInJvbGVcIixcInByZXNlbnRhdGlvblwiKSxpLmFwcGVuZENoaWxkKHIpLGguYXBwZW5kQ2hpbGQoaSksaT1yPW51bGwsZS5qc3RyZWU9e3ZlcnNpb246XCIzLjIuMVwiLGRlZmF1bHRzOntwbHVnaW5zOltdfSxwbHVnaW5zOnt9LHBhdGg6YyYmLTEhPT1jLmluZGV4T2YoXCIvXCIpP2MucmVwbGFjZSgvXFwvW15cXC9dKyQvLFwiXCIpOlwiXCIsaWRyZWdleDovW1xcXFw6JiFefCgpXFxbXFxdPD5AKicrfiNcIjsuLD1cXC0gXFwvJHt9JT9gXS9nLHJvb3Q6XCIjXCJ9LGUuanN0cmVlLmNyZWF0ZT1mdW5jdGlvbih0LGkpe3ZhciByPW5ldyBlLmpzdHJlZS5jb3JlKCsrcyksbj1pO3JldHVybiBpPWUuZXh0ZW5kKCEwLHt9LGUuanN0cmVlLmRlZmF1bHRzLGkpLG4mJm4ucGx1Z2lucyYmKGkucGx1Z2lucz1uLnBsdWdpbnMpLGUuZWFjaChpLnBsdWdpbnMsZnVuY3Rpb24oZSx0KXtcImNvcmVcIiE9PWUmJihyPXIucGx1Z2luKHQsaVt0XSkpfSksZSh0KS5kYXRhKFwianN0cmVlXCIsciksci5pbml0KHQsaSkscn0sZS5qc3RyZWUuZGVzdHJveT1mdW5jdGlvbigpe2UoXCIuanN0cmVlOmpzdHJlZVwiKS5qc3RyZWUoXCJkZXN0cm95XCIpLGUobCkub2ZmKFwiLmpzdHJlZVwiKX0sZS5qc3RyZWUuY29yZT1mdW5jdGlvbihlKXt0aGlzLl9pZD1lLHRoaXMuX2NudD0wLHRoaXMuX3dyaz1udWxsLHRoaXMuX2RhdGE9e2NvcmU6e3RoZW1lczp7bmFtZTohMSxkb3RzOiExLGljb25zOiExfSxzZWxlY3RlZDpbXSxsYXN0X2Vycm9yOnt9LHdvcmtpbmc6ITEsd29ya2VyX3F1ZXVlOltdLGZvY3VzZWQ6bnVsbH19fSxlLmpzdHJlZS5yZWZlcmVuY2U9ZnVuY3Rpb24odCl7dmFyIGk9bnVsbCxyPW51bGw7aWYoIXR8fCF0LmlkfHx0LnRhZ05hbWUmJnQubm9kZVR5cGV8fCh0PXQuaWQpLCFyfHwhci5sZW5ndGgpdHJ5e3I9ZSh0KX1jYXRjaChzKXt9aWYoIXJ8fCFyLmxlbmd0aCl0cnl7cj1lKFwiI1wiK3QucmVwbGFjZShlLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpKX1jYXRjaChzKXt9cmV0dXJuIHImJnIubGVuZ3RoJiYocj1yLmNsb3Nlc3QoXCIuanN0cmVlXCIpKS5sZW5ndGgmJihyPXIuZGF0YShcImpzdHJlZVwiKSk/aT1yOmUoXCIuanN0cmVlXCIpLmVhY2goZnVuY3Rpb24oKXt2YXIgcj1lKHRoaXMpLmRhdGEoXCJqc3RyZWVcIik7cmV0dXJuIHImJnIuX21vZGVsLmRhdGFbdF0/KGk9ciwhMSk6dm9pZCAwfSksaX0sZS5mbi5qc3RyZWU9ZnVuY3Rpb24oaSl7dmFyIHI9XCJzdHJpbmdcIj09dHlwZW9mIGkscz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksbj1udWxsO3JldHVybiBpIT09ITB8fHRoaXMubGVuZ3RoPyh0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYT1lLmpzdHJlZS5yZWZlcmVuY2UodGhpcyksbz1yJiZhP2FbaV06bnVsbDtyZXR1cm4gbj1yJiZvP28uYXBwbHkoYSxzKTpudWxsLGF8fHJ8fGkhPT10JiYhZS5pc1BsYWluT2JqZWN0KGkpfHxlLmpzdHJlZS5jcmVhdGUodGhpcyxpKSwoYSYmIXJ8fGk9PT0hMCkmJihuPWF8fCExKSxudWxsIT09biYmbiE9PXQ/ITE6dm9pZCAwfSksbnVsbCE9PW4mJm4hPT10P246dGhpcyk6ITF9LGUuZXhwcltcIjpcIl0uanN0cmVlPWUuZXhwci5jcmVhdGVQc2V1ZG8oZnVuY3Rpb24oaSl7cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiBlKGkpLmhhc0NsYXNzKFwianN0cmVlXCIpJiZlKGkpLmRhdGEoXCJqc3RyZWVcIikhPT10fX0pLGUuanN0cmVlLmRlZmF1bHRzLmNvcmU9e2RhdGE6ITEsc3RyaW5nczohMSxjaGVja19jYWxsYmFjazohMSxlcnJvcjplLm5vb3AsYW5pbWF0aW9uOjIwMCxtdWx0aXBsZTohMCx0aGVtZXM6e25hbWU6ITEsdXJsOiExLGRpcjohMSxkb3RzOiEwLGljb25zOiEwLHN0cmlwZXM6ITEsdmFyaWFudDohMSxyZXNwb25zaXZlOiExfSxleHBhbmRfc2VsZWN0ZWRfb25sb2FkOiEwLHdvcmtlcjohMCxmb3JjZV90ZXh0OiExLGRibGNsaWNrX3RvZ2dsZTohMH0sZS5qc3RyZWUuY29yZS5wcm90b3R5cGU9e3BsdWdpbjpmdW5jdGlvbih0LGkpe3ZhciByPWUuanN0cmVlLnBsdWdpbnNbdF07cmV0dXJuIHI/KHRoaXMuX2RhdGFbdF09e30sci5wcm90b3R5cGU9dGhpcyxuZXcgcihpLHRoaXMpKTp0aGlzfSxpbml0OmZ1bmN0aW9uKHQsaSl7dGhpcy5fbW9kZWw9e2RhdGE6e30sY2hhbmdlZDpbXSxmb3JjZV9mdWxsX3JlZHJhdzohMSxyZWRyYXdfdGltZW91dDohMSxkZWZhdWx0X3N0YXRlOntsb2FkZWQ6ITAsb3BlbmVkOiExLHNlbGVjdGVkOiExLGRpc2FibGVkOiExfX0sdGhpcy5fbW9kZWwuZGF0YVtlLmpzdHJlZS5yb290XT17aWQ6ZS5qc3RyZWUucm9vdCxwYXJlbnQ6bnVsbCxwYXJlbnRzOltdLGNoaWxkcmVuOltdLGNoaWxkcmVuX2Q6W10sc3RhdGU6e2xvYWRlZDohMX19LHRoaXMuZWxlbWVudD1lKHQpLmFkZENsYXNzKFwianN0cmVlIGpzdHJlZS1cIit0aGlzLl9pZCksdGhpcy5zZXR0aW5ncz1pLHRoaXMuX2RhdGEuY29yZS5yZWFkeT0hMSx0aGlzLl9kYXRhLmNvcmUubG9hZGVkPSExLHRoaXMuX2RhdGEuY29yZS5ydGw9XCJydGxcIj09PXRoaXMuZWxlbWVudC5jc3MoXCJkaXJlY3Rpb25cIiksdGhpcy5lbGVtZW50W3RoaXMuX2RhdGEuY29yZS5ydGw/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJqc3RyZWUtcnRsXCIpLHRoaXMuZWxlbWVudC5hdHRyKFwicm9sZVwiLFwidHJlZVwiKSx0aGlzLnNldHRpbmdzLmNvcmUubXVsdGlwbGUmJnRoaXMuZWxlbWVudC5hdHRyKFwiYXJpYS1tdWx0aXNlbGVjdGFibGVcIiwhMCksdGhpcy5lbGVtZW50LmF0dHIoXCJ0YWJpbmRleFwiKXx8dGhpcy5lbGVtZW50LmF0dHIoXCJ0YWJpbmRleFwiLFwiMFwiKSx0aGlzLmJpbmQoKSx0aGlzLnRyaWdnZXIoXCJpbml0XCIpLHRoaXMuX2RhdGEuY29yZS5vcmlnaW5hbF9jb250YWluZXJfaHRtbD10aGlzLmVsZW1lbnQuZmluZChcIiA+IHVsID4gbGlcIikuY2xvbmUoITApLHRoaXMuX2RhdGEuY29yZS5vcmlnaW5hbF9jb250YWluZXJfaHRtbC5maW5kKFwibGlcIikuYWRkQmFjaygpLmNvbnRlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIDM9PT10aGlzLm5vZGVUeXBlJiYoIXRoaXMubm9kZVZhbHVlfHwvXlxccyskLy50ZXN0KHRoaXMubm9kZVZhbHVlKSl9KS5yZW1vdmUoKSx0aGlzLmVsZW1lbnQuaHRtbChcIjx1bCBjbGFzcz0nanN0cmVlLWNvbnRhaW5lci11bCBqc3RyZWUtY2hpbGRyZW4nIHJvbGU9J2dyb3VwJz48bGkgaWQ9J2pcIit0aGlzLl9pZCtcIl9sb2FkaW5nJyBjbGFzcz0nanN0cmVlLWluaXRpYWwtbm9kZSBqc3RyZWUtbG9hZGluZyBqc3RyZWUtbGVhZiBqc3RyZWUtbGFzdCcgcm9sZT0ndHJlZS1pdGVtJz48aSBjbGFzcz0nanN0cmVlLWljb24ganN0cmVlLW9jbCc+PC9pPjxhIGNsYXNzPSdqc3RyZWUtYW5jaG9yJyBocmVmPScjJz48aSBjbGFzcz0nanN0cmVlLWljb24ganN0cmVlLXRoZW1laWNvbi1oaWRkZW4nPjwvaT5cIit0aGlzLmdldF9zdHJpbmcoXCJMb2FkaW5nIC4uLlwiKStcIjwvYT48L2xpPjwvdWw+XCIpLHRoaXMuZWxlbWVudC5hdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsXCJqXCIrdGhpcy5faWQrXCJfbG9hZGluZ1wiKSx0aGlzLl9kYXRhLmNvcmUubGlfaGVpZ2h0PXRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmNoaWxkcmVuKFwibGlcIikuZmlyc3QoKS5oZWlnaHQoKXx8MjQsdGhpcy50cmlnZ2VyKFwibG9hZGluZ1wiKSx0aGlzLmxvYWRfbm9kZShlLmpzdHJlZS5yb290KX0sZGVzdHJveTpmdW5jdGlvbihlKXtpZih0aGlzLl93cmspdHJ5e3dpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHRoaXMuX3dyayksdGhpcy5fd3JrPW51bGx9Y2F0Y2godCl7fWV8fHRoaXMuZWxlbWVudC5lbXB0eSgpLHRoaXMudGVhcmRvd24oKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt0aGlzLnVuYmluZCgpLHRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcImpzdHJlZVwiKS5yZW1vdmVEYXRhKFwianN0cmVlXCIpLmZpbmQoXCJbY2xhc3NePSdqc3RyZWUnXVwiKS5hZGRCYWNrKCkuYXR0cihcImNsYXNzXCIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbGFzc05hbWUucmVwbGFjZSgvanN0cmVlW14gXSp8JC9naSxcIlwiKX0pLHRoaXMuZWxlbWVudD1udWxsfSxiaW5kOmZ1bmN0aW9uKCl7dmFyIHQ9XCJcIixpPW51bGwscj0wO3RoaXMuZWxlbWVudC5vbihcImRibGNsaWNrLmpzdHJlZVwiLGZ1bmN0aW9uKGUpe2lmKGUudGFyZ2V0LnRhZ05hbWUmJlwiaW5wdXRcIj09PWUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4hMDtpZihsLnNlbGVjdGlvbiYmbC5zZWxlY3Rpb24uZW1wdHkpbC5zZWxlY3Rpb24uZW1wdHkoKTtlbHNlIGlmKHdpbmRvdy5nZXRTZWxlY3Rpb24pe3ZhciB0PXdpbmRvdy5nZXRTZWxlY3Rpb24oKTt0cnl7dC5yZW1vdmVBbGxSYW5nZXMoKSx0LmNvbGxhcHNlKCl9Y2F0Y2goaSl7fX19KS5vbihcIm1vdXNlZG93bi5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUpe2UudGFyZ2V0PT09dGhpcy5lbGVtZW50WzBdJiYoZS5wcmV2ZW50RGVmYXVsdCgpLHI9K25ldyBEYXRlKX0sdGhpcykpLm9uKFwibW91c2Vkb3duLmpzdHJlZVwiLFwiLmpzdHJlZS1vY2xcIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCl9KS5vbihcImNsaWNrLmpzdHJlZVwiLFwiLmpzdHJlZS1vY2xcIixlLnByb3h5KGZ1bmN0aW9uKGUpe3RoaXMudG9nZ2xlX25vZGUoZS50YXJnZXQpfSx0aGlzKSkub24oXCJkYmxjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbihlKXtyZXR1cm4gZS50YXJnZXQudGFnTmFtZSYmXCJpbnB1dFwiPT09ZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpPyEwOnZvaWQodGhpcy5zZXR0aW5ncy5jb3JlLmRibGNsaWNrX3RvZ2dsZSYmdGhpcy50b2dnbGVfbm9kZShlLnRhcmdldCkpfSx0aGlzKSkub24oXCJjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5jdXJyZW50VGFyZ2V0IT09bC5hY3RpdmVFbGVtZW50JiZlKHQuY3VycmVudFRhcmdldCkuZm9jdXMoKSx0aGlzLmFjdGl2YXRlX25vZGUodC5jdXJyZW50VGFyZ2V0LHQpfSx0aGlzKSkub24oXCJrZXlkb3duLmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixlLnByb3h5KGZ1bmN0aW9uKHQpe2lmKHQudGFyZ2V0LnRhZ05hbWUmJlwiaW5wdXRcIj09PXQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4hMDtpZigzMiE9PXQud2hpY2gmJjEzIT09dC53aGljaCYmKHQuc2hpZnRLZXl8fHQuY3RybEtleXx8dC5hbHRLZXl8fHQubWV0YUtleSkpcmV0dXJuITA7dmFyIGk9bnVsbDtzd2l0Y2godGhpcy5fZGF0YS5jb3JlLnJ0bCYmKDM3PT09dC53aGljaD90LndoaWNoPTM5OjM5PT09dC53aGljaCYmKHQud2hpY2g9MzcpKSx0LndoaWNoKXtjYXNlIDMyOnQuY3RybEtleSYmKHQudHlwZT1cImNsaWNrXCIsZSh0LmN1cnJlbnRUYXJnZXQpLnRyaWdnZXIodCkpO2JyZWFrO2Nhc2UgMTM6dC50eXBlPVwiY2xpY2tcIixlKHQuY3VycmVudFRhcmdldCkudHJpZ2dlcih0KTticmVhaztjYXNlIDM3OnQucHJldmVudERlZmF1bHQoKSx0aGlzLmlzX29wZW4odC5jdXJyZW50VGFyZ2V0KT90aGlzLmNsb3NlX25vZGUodC5jdXJyZW50VGFyZ2V0KTooaT10aGlzLmdldF9wYXJlbnQodC5jdXJyZW50VGFyZ2V0KSxpJiZpLmlkIT09ZS5qc3RyZWUucm9vdCYmdGhpcy5nZXRfbm9kZShpLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCkpO2JyZWFrO2Nhc2UgMzg6dC5wcmV2ZW50RGVmYXVsdCgpLGk9dGhpcy5nZXRfcHJldl9kb20odC5jdXJyZW50VGFyZ2V0KSxpJiZpLmxlbmd0aCYmaS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCk7YnJlYWs7Y2FzZSAzOTp0LnByZXZlbnREZWZhdWx0KCksdGhpcy5pc19jbG9zZWQodC5jdXJyZW50VGFyZ2V0KT90aGlzLm9wZW5fbm9kZSh0LmN1cnJlbnRUYXJnZXQsZnVuY3Rpb24oZSl7dGhpcy5nZXRfbm9kZShlLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCl9KTp0aGlzLmlzX29wZW4odC5jdXJyZW50VGFyZ2V0KSYmKGk9dGhpcy5nZXRfbm9kZSh0LmN1cnJlbnRUYXJnZXQsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKVswXSxpJiZlKHRoaXMuX2ZpcnN0Q2hpbGQoaSkpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKSk7YnJlYWs7Y2FzZSA0MDp0LnByZXZlbnREZWZhdWx0KCksaT10aGlzLmdldF9uZXh0X2RvbSh0LmN1cnJlbnRUYXJnZXQpLGkmJmkubGVuZ3RoJiZpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKTticmVhaztjYXNlIDEwNjp0aGlzLm9wZW5fYWxsKCk7YnJlYWs7Y2FzZSAzNjp0LnByZXZlbnREZWZhdWx0KCksaT10aGlzLl9maXJzdENoaWxkKHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpWzBdKSxpJiZlKGkpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZmlsdGVyKFwiOnZpc2libGVcIikuZm9jdXMoKTticmVhaztjYXNlIDM1OnQucHJldmVudERlZmF1bHQoKSx0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtYW5jaG9yXCIpLmZpbHRlcihcIjp2aXNpYmxlXCIpLmxhc3QoKS5mb2N1cygpfX0sdGhpcykpLm9uKFwibG9hZF9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24odCxpKXtpLnN0YXR1cyYmKGkubm9kZS5pZCE9PWUuanN0cmVlLnJvb3R8fHRoaXMuX2RhdGEuY29yZS5sb2FkZWR8fCh0aGlzLl9kYXRhLmNvcmUubG9hZGVkPSEwLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pJiZ0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pLmlkKSx0aGlzLnRyaWdnZXIoXCJsb2FkZWRcIikpLHRoaXMuX2RhdGEuY29yZS5yZWFkeXx8c2V0VGltZW91dChlLnByb3h5KGZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50JiYhdGhpcy5nZXRfY29udGFpbmVyX3VsKCkuZmluZChcIi5qc3RyZWUtbG9hZGluZ1wiKS5sZW5ndGgpe2lmKHRoaXMuX2RhdGEuY29yZS5yZWFkeT0hMCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoKXtpZih0aGlzLnNldHRpbmdzLmNvcmUuZXhwYW5kX3NlbGVjdGVkX29ubG9hZCl7dmFyIHQsaSxyPVtdO2Zvcih0PTAsaT10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoO2k+dDt0Kyspcj1yLmNvbmNhdCh0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFt0XV0ucGFyZW50cyk7Zm9yKHI9ZS52YWthdGEuYXJyYXlfdW5pcXVlKHIpLHQ9MCxpPXIubGVuZ3RoO2k+dDt0KyspdGhpcy5vcGVuX25vZGUoclt0XSwhMSwwKX10aGlzLnRyaWdnZXIoXCJjaGFuZ2VkXCIse2FjdGlvbjpcInJlYWR5XCIsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkfSl9dGhpcy50cmlnZ2VyKFwicmVhZHlcIil9fSx0aGlzKSwwKSl9LHRoaXMpKS5vbihcImtleXByZXNzLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24ocil7aWYoci50YXJnZXQudGFnTmFtZSYmXCJpbnB1dFwiPT09ci50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiEwO2kmJmNsZWFyVGltZW91dChpKSxpPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0PVwiXCJ9LDUwMCk7dmFyIHM9U3RyaW5nLmZyb21DaGFyQ29kZShyLndoaWNoKS50b0xvd2VyQ2FzZSgpLG49dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLWFuY2hvclwiKS5maWx0ZXIoXCI6dmlzaWJsZVwiKSxhPW4uaW5kZXgobC5hY3RpdmVFbGVtZW50KXx8MCxvPSExO2lmKHQrPXMsdC5sZW5ndGg+MSl7aWYobi5zbGljZShhKS5lYWNoKGUucHJveHkoZnVuY3Rpb24oaSxyKXtyZXR1cm4gMD09PWUocikudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0KT8oZShyKS5mb2N1cygpLG89ITAsITEpOnZvaWQgMH0sdGhpcykpLG8pcmV0dXJuO2lmKG4uc2xpY2UoMCxhKS5lYWNoKGUucHJveHkoZnVuY3Rpb24oaSxyKXtyZXR1cm4gMD09PWUocikudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0KT8oZShyKS5mb2N1cygpLG89ITAsITEpOnZvaWQgMH0sdGhpcykpLG8pcmV0dXJufWlmKG5ldyBSZWdFeHAoXCJeXCIrcy5yZXBsYWNlKC9bLVxcL1xcXFxeJCorPy4oKXxbXFxde31dL2csXCJcXFxcJCZcIikrXCIrJFwiKS50ZXN0KHQpKXtpZihuLnNsaWNlKGErMSkuZWFjaChlLnByb3h5KGZ1bmN0aW9uKHQsaSl7cmV0dXJuIGUoaSkudGV4dCgpLnRvTG93ZXJDYXNlKCkuY2hhckF0KDApPT09cz8oZShpKS5mb2N1cygpLG89ITAsITEpOnZvaWQgMH0sdGhpcykpLG8pcmV0dXJuO2lmKG4uc2xpY2UoMCxhKzEpLmVhY2goZS5wcm94eShmdW5jdGlvbih0LGkpe3JldHVybiBlKGkpLnRleHQoKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKT09PXM/KGUoaSkuZm9jdXMoKSxvPSEwLCExKTp2b2lkIDB9LHRoaXMpKSxvKXJldHVybn19LHRoaXMpKS5vbihcImluaXQuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbigpe3ZhciBlPXRoaXMuc2V0dGluZ3MuY29yZS50aGVtZXM7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzPWUuZG90cyx0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM9ZS5zdHJpcGVzLHRoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM9ZS5pY29ucyx0aGlzLnNldF90aGVtZShlLm5hbWV8fFwiZGVmYXVsdFwiLGUudXJsKSx0aGlzLnNldF90aGVtZV92YXJpYW50KGUudmFyaWFudCl9LHRoaXMpKS5vbihcImxvYWRpbmcuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbigpe3RoaXNbdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzP1wic2hvd19kb3RzXCI6XCJoaWRlX2RvdHNcIl0oKSx0aGlzW3RoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM/XCJzaG93X2ljb25zXCI6XCJoaWRlX2ljb25zXCJdKCksdGhpc1t0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM/XCJzaG93X3N0cmlwZXNcIjpcImhpZGVfc3RyaXBlc1wiXSgpfSx0aGlzKSkub24oXCJibHVyLmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixlLnByb3h5KGZ1bmN0aW9uKHQpe3RoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW51bGwsZSh0LmN1cnJlbnRUYXJnZXQpLmZpbHRlcihcIi5qc3RyZWUtaG92ZXJlZFwiKS5tb3VzZWxlYXZlKCksdGhpcy5lbGVtZW50LmF0dHIoXCJ0YWJpbmRleFwiLFwiMFwiKX0sdGhpcykpLm9uKFwiZm9jdXMuanN0cmVlXCIsXCIuanN0cmVlLWFuY2hvclwiLGUucHJveHkoZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXRfbm9kZSh0LmN1cnJlbnRUYXJnZXQpO2kmJmkuaWQmJih0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1pLmlkKSx0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtaG92ZXJlZFwiKS5ub3QodC5jdXJyZW50VGFyZ2V0KS5tb3VzZWxlYXZlKCksZSh0LmN1cnJlbnRUYXJnZXQpLm1vdXNlZW50ZXIoKSx0aGlzLmVsZW1lbnQuYXR0cihcInRhYmluZGV4XCIsXCItMVwiKX0sdGhpcykpLm9uKFwiZm9jdXMuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbigpe2lmKCtuZXcgRGF0ZS1yPjUwMCYmIXRoaXMuX2RhdGEuY29yZS5mb2N1c2VkKXtyPTA7dmFyIGU9dGhpcy5nZXRfbm9kZSh0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiKSwhMCk7ZSYmZS5maW5kKFwiPiAuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpfX0sdGhpcykpLm9uKFwibW91c2VlbnRlci5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbihlKXt0aGlzLmhvdmVyX25vZGUoZS5jdXJyZW50VGFyZ2V0KX0sdGhpcykpLm9uKFwibW91c2VsZWF2ZS5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbihlKXt0aGlzLmRlaG92ZXJfbm9kZShlLmN1cnJlbnRUYXJnZXQpfSx0aGlzKSl9LHVuYmluZDpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5vZmYoXCIuanN0cmVlXCIpLGUobCkub2ZmKFwiLmpzdHJlZS1cIit0aGlzLl9pZCl9LHRyaWdnZXI6ZnVuY3Rpb24oZSx0KXt0fHwodD17fSksdC5pbnN0YW5jZT10aGlzLHRoaXMuZWxlbWVudC50cmlnZ2VySGFuZGxlcihlLnJlcGxhY2UoXCIuanN0cmVlXCIsXCJcIikrXCIuanN0cmVlXCIsdCl9LGdldF9jb250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50fSxnZXRfY29udGFpbmVyX3VsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuZmlyc3QoKX0sZ2V0X3N0cmluZzpmdW5jdGlvbih0KXt2YXIgaT10aGlzLnNldHRpbmdzLmNvcmUuc3RyaW5ncztyZXR1cm4gZS5pc0Z1bmN0aW9uKGkpP2kuY2FsbCh0aGlzLHQpOmkmJmlbdF0/aVt0XTp0fSxfZmlyc3RDaGlsZDpmdW5jdGlvbihlKXtmb3IoZT1lP2UuZmlyc3RDaGlsZDpudWxsO251bGwhPT1lJiYxIT09ZS5ub2RlVHlwZTspZT1lLm5leHRTaWJsaW5nO3JldHVybiBlfSxfbmV4dFNpYmxpbmc6ZnVuY3Rpb24oZSl7Zm9yKGU9ZT9lLm5leHRTaWJsaW5nOm51bGw7bnVsbCE9PWUmJjEhPT1lLm5vZGVUeXBlOyllPWUubmV4dFNpYmxpbmc7cmV0dXJuIGV9LF9wcmV2aW91c1NpYmxpbmc6ZnVuY3Rpb24oZSl7Zm9yKGU9ZT9lLnByZXZpb3VzU2libGluZzpudWxsO251bGwhPT1lJiYxIT09ZS5ub2RlVHlwZTspZT1lLnByZXZpb3VzU2libGluZztyZXR1cm4gZX0sZ2V0X25vZGU6ZnVuY3Rpb24odCxpKXt0JiZ0LmlkJiYodD10LmlkKTt2YXIgcjt0cnl7aWYodGhpcy5fbW9kZWwuZGF0YVt0XSl0PXRoaXMuX21vZGVsLmRhdGFbdF07ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgdCYmdGhpcy5fbW9kZWwuZGF0YVt0LnJlcGxhY2UoL14jLyxcIlwiKV0pdD10aGlzLl9tb2RlbC5kYXRhW3QucmVwbGFjZSgvXiMvLFwiXCIpXTtlbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiB0JiYocj1lKFwiI1wiK3QucmVwbGFjZShlLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpLHRoaXMuZWxlbWVudCkpLmxlbmd0aCYmdGhpcy5fbW9kZWwuZGF0YVtyLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuYXR0cihcImlkXCIpXSl0PXRoaXMuX21vZGVsLmRhdGFbci5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmF0dHIoXCJpZFwiKV07ZWxzZSBpZigocj1lKHQsdGhpcy5lbGVtZW50KSkubGVuZ3RoJiZ0aGlzLl9tb2RlbC5kYXRhW3IuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKS5hdHRyKFwiaWRcIildKXQ9dGhpcy5fbW9kZWwuZGF0YVtyLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuYXR0cihcImlkXCIpXTtlbHNle2lmKCEocj1lKHQsdGhpcy5lbGVtZW50KSkubGVuZ3RofHwhci5oYXNDbGFzcyhcImpzdHJlZVwiKSlyZXR1cm4hMTt0PXRoaXMuX21vZGVsLmRhdGFbZS5qc3RyZWUucm9vdF19cmV0dXJuIGkmJih0PXQuaWQ9PT1lLmpzdHJlZS5yb290P3RoaXMuZWxlbWVudDplKFwiI1wiK3QuaWQucmVwbGFjZShlLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpLHRoaXMuZWxlbWVudCkpLHR9Y2F0Y2gocyl7cmV0dXJuITF9fSxnZXRfcGF0aDpmdW5jdGlvbih0LGkscil7aWYodD10LnBhcmVudHM/dDp0aGlzLmdldF9ub2RlKHQpLCF0fHx0LmlkPT09ZS5qc3RyZWUucm9vdHx8IXQucGFyZW50cylyZXR1cm4hMTt2YXIgcyxuLGE9W107Zm9yKGEucHVzaChyP3QuaWQ6dC50ZXh0KSxzPTAsbj10LnBhcmVudHMubGVuZ3RoO24+cztzKyspYS5wdXNoKHI/dC5wYXJlbnRzW3NdOnRoaXMuZ2V0X3RleHQodC5wYXJlbnRzW3NdKSk7cmV0dXJuIGE9YS5yZXZlcnNlKCkuc2xpY2UoMSksaT9hLmpvaW4oaSk6YX0sZ2V0X25leHRfZG9tOmZ1bmN0aW9uKHQsaSl7dmFyIHI7aWYodD10aGlzLmdldF9ub2RlKHQsITApLHRbMF09PT10aGlzLmVsZW1lbnRbMF0pe2ZvcihyPXRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pO3ImJjA9PT1yLm9mZnNldEhlaWdodDspcj10aGlzLl9uZXh0U2libGluZyhyKTtyZXR1cm4gcj9lKHIpOiExfWlmKCF0fHwhdC5sZW5ndGgpcmV0dXJuITE7aWYoaSl7cj10WzBdO2RvIHI9dGhpcy5fbmV4dFNpYmxpbmcocik7d2hpbGUociYmMD09PXIub2Zmc2V0SGVpZ2h0KTtyZXR1cm4gcj9lKHIpOiExfWlmKHQuaGFzQ2xhc3MoXCJqc3RyZWUtb3BlblwiKSl7Zm9yKHI9dGhpcy5fZmlyc3RDaGlsZCh0LmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKVswXSk7ciYmMD09PXIub2Zmc2V0SGVpZ2h0OylyPXRoaXMuX25leHRTaWJsaW5nKHIpO2lmKG51bGwhPT1yKXJldHVybiBlKHIpfXI9dFswXTtkbyByPXRoaXMuX25leHRTaWJsaW5nKHIpO3doaWxlKHImJjA9PT1yLm9mZnNldEhlaWdodCk7cmV0dXJuIG51bGwhPT1yP2Uocik6dC5wYXJlbnRzVW50aWwoXCIuanN0cmVlXCIsXCIuanN0cmVlLW5vZGVcIikubmV4dEFsbChcIi5qc3RyZWUtbm9kZTp2aXNpYmxlXCIpLmZpcnN0KCl9LGdldF9wcmV2X2RvbTpmdW5jdGlvbih0LGkpe3ZhciByO2lmKHQ9dGhpcy5nZXRfbm9kZSh0LCEwKSx0WzBdPT09dGhpcy5lbGVtZW50WzBdKXtmb3Iocj10aGlzLmdldF9jb250YWluZXJfdWwoKVswXS5sYXN0Q2hpbGQ7ciYmMD09PXIub2Zmc2V0SGVpZ2h0OylyPXRoaXMuX3ByZXZpb3VzU2libGluZyhyKTtyZXR1cm4gcj9lKHIpOiExfWlmKCF0fHwhdC5sZW5ndGgpcmV0dXJuITE7aWYoaSl7cj10WzBdO2RvIHI9dGhpcy5fcHJldmlvdXNTaWJsaW5nKHIpO3doaWxlKHImJjA9PT1yLm9mZnNldEhlaWdodCk7cmV0dXJuIHI/ZShyKTohMX1yPXRbMF07ZG8gcj10aGlzLl9wcmV2aW91c1NpYmxpbmcocik7d2hpbGUociYmMD09PXIub2Zmc2V0SGVpZ2h0KTtpZihudWxsIT09cil7Zm9yKHQ9ZShyKTt0Lmhhc0NsYXNzKFwianN0cmVlLW9wZW5cIik7KXQ9dC5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuZmlyc3QoKS5jaGlsZHJlbihcIi5qc3RyZWUtbm9kZTp2aXNpYmxlOmxhc3RcIik7cmV0dXJuIHR9cmV0dXJuIHI9dFswXS5wYXJlbnROb2RlLnBhcmVudE5vZGUsciYmci5jbGFzc05hbWUmJi0xIT09ci5jbGFzc05hbWUuaW5kZXhPZihcImpzdHJlZS1ub2RlXCIpP2Uocik6ITF9LGdldF9wYXJlbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy5nZXRfbm9kZSh0KSx0JiZ0LmlkIT09ZS5qc3RyZWUucm9vdD90LnBhcmVudDohMX0sZ2V0X2NoaWxkcmVuX2RvbTpmdW5jdGlvbihlKXtyZXR1cm4gZT10aGlzLmdldF9ub2RlKGUsITApLGVbMF09PT10aGlzLmVsZW1lbnRbMF0/dGhpcy5nZXRfY29udGFpbmVyX3VsKCkuY2hpbGRyZW4oXCIuanN0cmVlLW5vZGVcIik6ZSYmZS5sZW5ndGg/ZS5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuY2hpbGRyZW4oXCIuanN0cmVlLW5vZGVcIik6ITF9LGlzX3BhcmVudDpmdW5jdGlvbihlKXtyZXR1cm4gZT10aGlzLmdldF9ub2RlKGUpLGUmJihlLnN0YXRlLmxvYWRlZD09PSExfHxlLmNoaWxkcmVuLmxlbmd0aD4wKX0saXNfbG9hZGVkOmZ1bmN0aW9uKGUpe3JldHVybiBlPXRoaXMuZ2V0X25vZGUoZSksZSYmZS5zdGF0ZS5sb2FkZWR9LGlzX2xvYWRpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dGhpcy5nZXRfbm9kZShlKSxlJiZlLnN0YXRlJiZlLnN0YXRlLmxvYWRpbmd9LGlzX29wZW46ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dGhpcy5nZXRfbm9kZShlKSxlJiZlLnN0YXRlLm9wZW5lZH0saXNfY2xvc2VkOmZ1bmN0aW9uKGUpe3JldHVybiBlPXRoaXMuZ2V0X25vZGUoZSksZSYmdGhpcy5pc19wYXJlbnQoZSkmJiFlLnN0YXRlLm9wZW5lZH0saXNfbGVhZjpmdW5jdGlvbihlKXtyZXR1cm4hdGhpcy5pc19wYXJlbnQoZSl9LGxvYWRfbm9kZTpmdW5jdGlvbih0LGkpe3ZhciByLHMsbixhLG87aWYoZS5pc0FycmF5KHQpKXJldHVybiB0aGlzLl9sb2FkX25vZGVzKHQuc2xpY2UoKSxpKSwhMDtpZih0PXRoaXMuZ2V0X25vZGUodCksIXQpcmV0dXJuIGkmJmkuY2FsbCh0aGlzLHQsITEpLCExO2lmKHQuc3RhdGUubG9hZGVkKXtmb3IodC5zdGF0ZS5sb2FkZWQ9ITEscj0wLHM9dC5jaGlsZHJlbl9kLmxlbmd0aDtzPnI7cisrKXtmb3Iobj0wLGE9dC5wYXJlbnRzLmxlbmd0aDthPm47bisrKXRoaXMuX21vZGVsLmRhdGFbdC5wYXJlbnRzW25dXS5jaGlsZHJlbl9kPWUudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKHRoaXMuX21vZGVsLmRhdGFbdC5wYXJlbnRzW25dXS5jaGlsZHJlbl9kLHQuY2hpbGRyZW5fZFtyXSk7dGhpcy5fbW9kZWwuZGF0YVt0LmNoaWxkcmVuX2Rbcl1dLnN0YXRlLnNlbGVjdGVkJiYobz0hMCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQ9ZS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW0odGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLHQuY2hpbGRyZW5fZFtyXSkpLGRlbGV0ZSB0aGlzLl9tb2RlbC5kYXRhW3QuY2hpbGRyZW5fZFtyXV19dC5jaGlsZHJlbj1bXSx0LmNoaWxkcmVuX2Q9W10sbyYmdGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJsb2FkX25vZGVcIixub2RlOnQsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkfSl9cmV0dXJuIHQuc3RhdGUuZmFpbGVkPSExLHQuc3RhdGUubG9hZGluZz0hMCx0aGlzLmdldF9ub2RlKHQsITApLmFkZENsYXNzKFwianN0cmVlLWxvYWRpbmdcIikuYXR0cihcImFyaWEtYnVzeVwiLCEwKSx0aGlzLl9sb2FkX25vZGUodCxlLnByb3h5KGZ1bmN0aW9uKGUpe3Q9dGhpcy5fbW9kZWwuZGF0YVt0LmlkXSx0LnN0YXRlLmxvYWRpbmc9ITEsdC5zdGF0ZS5sb2FkZWQ9ZSx0LnN0YXRlLmZhaWxlZD0hdC5zdGF0ZS5sb2FkZWQ7dmFyIHI9dGhpcy5nZXRfbm9kZSh0LCEwKSxzPTAsbj0wLGE9dGhpcy5fbW9kZWwuZGF0YSxvPSExO2ZvcihzPTAsbj10LmNoaWxkcmVuLmxlbmd0aDtuPnM7cysrKWlmKGFbdC5jaGlsZHJlbltzXV0mJiFhW3QuY2hpbGRyZW5bc11dLnN0YXRlLmhpZGRlbil7bz0hMDticmVha310LnN0YXRlLmxvYWRlZCYmIW8mJnImJnIubGVuZ3RoJiYhci5oYXNDbGFzcyhcImpzdHJlZS1sZWFmXCIpJiZyLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsb3NlZCBqc3RyZWUtb3BlblwiKS5hZGRDbGFzcyhcImpzdHJlZS1sZWFmXCIpLHIucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtbG9hZGluZ1wiKS5hdHRyKFwiYXJpYS1idXN5XCIsITEpLHRoaXMudHJpZ2dlcihcImxvYWRfbm9kZVwiLHtub2RlOnQsc3RhdHVzOmV9KSxpJiZpLmNhbGwodGhpcyx0LGUpfSx0aGlzKSksITB9LF9sb2FkX25vZGVzOmZ1bmN0aW9uKGUsdCxpKXt2YXIgcixzLG49ITAsYT1mdW5jdGlvbigpe3RoaXMuX2xvYWRfbm9kZXMoZSx0LCEwKX0sbz10aGlzLl9tb2RlbC5kYXRhLGQ9W107Zm9yKHI9MCxzPWUubGVuZ3RoO3M+cjtyKyspIW9bZVtyXV18fChvW2Vbcl1dLnN0YXRlLmxvYWRlZHx8b1tlW3JdXS5zdGF0ZS5mYWlsZWQpJiZpfHwodGhpcy5pc19sb2FkaW5nKGVbcl0pfHx0aGlzLmxvYWRfbm9kZShlW3JdLGEpLG49ITEpO2lmKG4pe2ZvcihyPTAscz1lLmxlbmd0aDtzPnI7cisrKW9bZVtyXV0mJm9bZVtyXV0uc3RhdGUubG9hZGVkJiZkLnB1c2goZVtyXSk7dCYmIXQuZG9uZSYmKHQuY2FsbCh0aGlzLGQpLHQuZG9uZT0hMCl9fSxsb2FkX2FsbDpmdW5jdGlvbih0LGkpe2lmKHR8fCh0PWUuanN0cmVlLnJvb3QpLHQ9dGhpcy5nZXRfbm9kZSh0KSwhdClyZXR1cm4hMTt2YXIgcixzLG49W10sYT10aGlzLl9tb2RlbC5kYXRhLG89YVt0LmlkXS5jaGlsZHJlbl9kO2Zvcih0LnN0YXRlJiYhdC5zdGF0ZS5sb2FkZWQmJm4ucHVzaCh0LmlkKSxyPTAscz1vLmxlbmd0aDtzPnI7cisrKWFbb1tyXV0mJmFbb1tyXV0uc3RhdGUmJiFhW29bcl1dLnN0YXRlLmxvYWRlZCYmbi5wdXNoKG9bcl0pO24ubGVuZ3RoP3RoaXMuX2xvYWRfbm9kZXMobixmdW5jdGlvbigpe3RoaXMubG9hZF9hbGwodCxpKX0pOihpJiZpLmNhbGwodGhpcyx0KSx0aGlzLnRyaWdnZXIoXCJsb2FkX2FsbFwiLHtub2RlOnR9KSl9LF9sb2FkX25vZGU6ZnVuY3Rpb24odCxpKXt2YXIgcixzPXRoaXMuc2V0dGluZ3MuY29yZS5kYXRhO3JldHVybiBzP2UuaXNGdW5jdGlvbihzKT9zLmNhbGwodGhpcyx0LGUucHJveHkoZnVuY3Rpb24ocil7cj09PSExJiZpLmNhbGwodGhpcywhMSksdGhpc1tcInN0cmluZ1wiPT10eXBlb2Ygcj9cIl9hcHBlbmRfaHRtbF9kYXRhXCI6XCJfYXBwZW5kX2pzb25fZGF0YVwiXSh0LFwic3RyaW5nXCI9PXR5cGVvZiByP2UoZS5wYXJzZUhUTUwocikpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAzIT09dGhpcy5ub2RlVHlwZX0pOnIsZnVuY3Rpb24oZSl7aS5jYWxsKHRoaXMsZSl9KX0sdGhpcykpOlwib2JqZWN0XCI9PXR5cGVvZiBzP3MudXJsPyhzPWUuZXh0ZW5kKCEwLHt9LHMpLGUuaXNGdW5jdGlvbihzLnVybCkmJihzLnVybD1zLnVybC5jYWxsKHRoaXMsdCkpLGUuaXNGdW5jdGlvbihzLmRhdGEpJiYocy5kYXRhPXMuZGF0YS5jYWxsKHRoaXMsdCkpLGUuYWpheChzKS5kb25lKGUucHJveHkoZnVuY3Rpb24ocixzLG4pe3ZhciBhPW4uZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7cmV0dXJuIGEmJi0xIT09YS5pbmRleE9mKFwianNvblwiKXx8XCJvYmplY3RcIj09dHlwZW9mIHI/dGhpcy5fYXBwZW5kX2pzb25fZGF0YSh0LHIsZnVuY3Rpb24oZSl7aS5jYWxsKHRoaXMsZSl9KTphJiYtMSE9PWEuaW5kZXhPZihcImh0bWxcIil8fFwic3RyaW5nXCI9PXR5cGVvZiByP3RoaXMuX2FwcGVuZF9odG1sX2RhdGEodCxlKGUucGFyc2VIVE1MKHIpKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gMyE9PXRoaXMubm9kZVR5cGV9KSxmdW5jdGlvbihlKXtpLmNhbGwodGhpcyxlKX0pOih0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJhamF4XCIscGx1Z2luOlwiY29yZVwiLGlkOlwiY29yZV8wNFwiLHJlYXNvbjpcIkNvdWxkIG5vdCBsb2FkIG5vZGVcIixkYXRhOkpTT04uc3RyaW5naWZ5KHtpZDp0LmlkLHhocjpufSl9LHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLGkuY2FsbCh0aGlzLCExKSl9LHRoaXMpKS5mYWlsKGUucHJveHkoZnVuY3Rpb24oZSl7aS5jYWxsKHRoaXMsITEpLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImFqYXhcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzA0XCIscmVhc29uOlwiQ291bGQgbm90IGxvYWQgbm9kZVwiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2lkOnQuaWQseGhyOmV9KX0sdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcil9LHRoaXMpKSk6KHI9ZS5pc0FycmF5KHMpfHxlLmlzUGxhaW5PYmplY3Qocyk/SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzKSk6cyx0LmlkPT09ZS5qc3RyZWUucm9vdD90aGlzLl9hcHBlbmRfanNvbl9kYXRhKHQscixmdW5jdGlvbihlKXtpLmNhbGwodGhpcyxlKX0pOih0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJub2RhdGFcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzA1XCIscmVhc29uOlwiQ291bGQgbm90IGxvYWQgbm9kZVwiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2lkOnQuaWR9KX0sdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksaS5jYWxsKHRoaXMsITEpKSk6XCJzdHJpbmdcIj09dHlwZW9mIHM/dC5pZD09PWUuanN0cmVlLnJvb3Q/dGhpcy5fYXBwZW5kX2h0bWxfZGF0YSh0LGUoZS5wYXJzZUhUTUwocykpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAzIT09dGhpcy5ub2RlVHlwZX0pLGZ1bmN0aW9uKGUpe2kuY2FsbCh0aGlzLGUpfSk6KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcIm5vZGF0YVwiLHBsdWdpbjpcImNvcmVcIixpZDpcImNvcmVfMDZcIixyZWFzb246XCJDb3VsZCBub3QgbG9hZCBub2RlXCIsZGF0YTpKU09OLnN0cmluZ2lmeSh7aWQ6dC5pZH0pfSx0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKSxpLmNhbGwodGhpcywhMSkpOmkuY2FsbCh0aGlzLCExKTp0LmlkPT09ZS5qc3RyZWUucm9vdD90aGlzLl9hcHBlbmRfaHRtbF9kYXRhKHQsdGhpcy5fZGF0YS5jb3JlLm9yaWdpbmFsX2NvbnRhaW5lcl9odG1sLmNsb25lKCEwKSxmdW5jdGlvbihlKXtpLmNhbGwodGhpcyxlKX0pOmkuY2FsbCh0aGlzLCExKX0sX25vZGVfY2hhbmdlZDpmdW5jdGlvbihlKXtlPXRoaXMuZ2V0X25vZGUoZSksZSYmdGhpcy5fbW9kZWwuY2hhbmdlZC5wdXNoKGUuaWQpfSxfYXBwZW5kX2h0bWxfZGF0YTpmdW5jdGlvbih0LGkscil7dD10aGlzLmdldF9ub2RlKHQpLHQuY2hpbGRyZW49W10sdC5jaGlsZHJlbl9kPVtdO3ZhciBzLG4sYSxvPWkuaXMoXCJ1bFwiKT9pLmNoaWxkcmVuKCk6aSxkPXQuaWQsYz1bXSxsPVtdLGg9dGhpcy5fbW9kZWwuZGF0YSxfPWhbZF0sdT10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoO2ZvcihvLmVhY2goZS5wcm94eShmdW5jdGlvbih0LGkpe3M9dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9odG1sKGUoaSksZCxfLnBhcmVudHMuY29uY2F0KCkpLHMmJihjLnB1c2gocyksbC5wdXNoKHMpLGhbc10uY2hpbGRyZW5fZC5sZW5ndGgmJihsPWwuY29uY2F0KGhbc10uY2hpbGRyZW5fZCkpKX0sdGhpcykpLF8uY2hpbGRyZW49YyxfLmNoaWxkcmVuX2Q9bCxuPTAsYT1fLnBhcmVudHMubGVuZ3RoO2E+bjtuKyspaFtfLnBhcmVudHNbbl1dLmNoaWxkcmVuX2Q9aFtfLnBhcmVudHNbbl1dLmNoaWxkcmVuX2QuY29uY2F0KGwpO3RoaXMudHJpZ2dlcihcIm1vZGVsXCIse25vZGVzOmwscGFyZW50OmR9KSxkIT09ZS5qc3RyZWUucm9vdD8odGhpcy5fbm9kZV9jaGFuZ2VkKGQpLHRoaXMucmVkcmF3KCkpOih0aGlzLmdldF9jb250YWluZXJfdWwoKS5jaGlsZHJlbihcIi5qc3RyZWUtaW5pdGlhbC1ub2RlXCIpLnJlbW92ZSgpLHRoaXMucmVkcmF3KCEwKSksdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmxlbmd0aCE9PXUmJnRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwibW9kZWxcIixzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWR9KSxyLmNhbGwodGhpcywhMCl9LF9hcHBlbmRfanNvbl9kYXRhOmZ1bmN0aW9uKHQsaSxyLHMpe2lmKG51bGwhPT10aGlzLmVsZW1lbnQpe3Q9dGhpcy5nZXRfbm9kZSh0KSx0LmNoaWxkcmVuPVtdLHQuY2hpbGRyZW5fZD1bXSxpLmQmJihpPWkuZCxcInN0cmluZ1wiPT10eXBlb2YgaSYmKGk9SlNPTi5wYXJzZShpKSkpLGUuaXNBcnJheShpKXx8KGk9W2ldKTt2YXIgbj1udWxsLGE9e2RmOnRoaXMuX21vZGVsLmRlZmF1bHRfc3RhdGUsZGF0OmkscGFyOnQuaWQsbTp0aGlzLl9tb2RlbC5kYXRhLHRfaWQ6dGhpcy5faWQsdF9jbnQ6dGhpcy5fY250LHNlbDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWR9LG89ZnVuY3Rpb24oZSx0KXtlLmRhdGEmJihlPWUuZGF0YSk7dmFyIGkscixzLG4sYT1lLmRhdCxvPWUucGFyLGQ9W10sYz1bXSxsPVtdLGg9ZS5kZixfPWUudF9pZCx1PWUudF9jbnQsZz1lLm0sZj1nW29dLHA9ZS5zZWwsbT1mdW5jdGlvbihlLGkscil7cj1yP3IuY29uY2F0KCk6W10saSYmci51bnNoaWZ0KGkpO3ZhciBzLG4sYSxvLGQ9ZS5pZC50b1N0cmluZygpLGM9e2lkOmQsdGV4dDplLnRleHR8fFwiXCIsaWNvbjplLmljb24hPT10P2UuaWNvbjohMCxwYXJlbnQ6aSxwYXJlbnRzOnIsY2hpbGRyZW46ZS5jaGlsZHJlbnx8W10sY2hpbGRyZW5fZDplLmNoaWxkcmVuX2R8fFtdLGRhdGE6ZS5kYXRhLHN0YXRlOnt9LGxpX2F0dHI6e2lkOiExfSxhX2F0dHI6e2hyZWY6XCIjXCJ9LG9yaWdpbmFsOiExfTtmb3IocyBpbiBoKWguaGFzT3duUHJvcGVydHkocykmJihjLnN0YXRlW3NdPWhbc10pO2lmKGUmJmUuZGF0YSYmZS5kYXRhLmpzdHJlZSYmZS5kYXRhLmpzdHJlZS5pY29uJiYoYy5pY29uPWUuZGF0YS5qc3RyZWUuaWNvbiksKGMuaWNvbj09PXR8fG51bGw9PT1jLmljb258fFwiXCI9PT1jLmljb24pJiYoYy5pY29uPSEwKSxlJiZlLmRhdGEmJihjLmRhdGE9ZS5kYXRhLGUuZGF0YS5qc3RyZWUpKWZvcihzIGluIGUuZGF0YS5qc3RyZWUpZS5kYXRhLmpzdHJlZS5oYXNPd25Qcm9wZXJ0eShzKSYmKGMuc3RhdGVbc109ZS5kYXRhLmpzdHJlZVtzXSk7aWYoZSYmXCJvYmplY3RcIj09dHlwZW9mIGUuc3RhdGUpZm9yKHMgaW4gZS5zdGF0ZSllLnN0YXRlLmhhc093blByb3BlcnR5KHMpJiYoYy5zdGF0ZVtzXT1lLnN0YXRlW3NdKTtpZihlJiZcIm9iamVjdFwiPT10eXBlb2YgZS5saV9hdHRyKWZvcihzIGluIGUubGlfYXR0cillLmxpX2F0dHIuaGFzT3duUHJvcGVydHkocykmJihjLmxpX2F0dHJbc109ZS5saV9hdHRyW3NdKTtpZihjLmxpX2F0dHIuaWR8fChjLmxpX2F0dHIuaWQ9ZCksZSYmXCJvYmplY3RcIj09dHlwZW9mIGUuYV9hdHRyKWZvcihzIGluIGUuYV9hdHRyKWUuYV9hdHRyLmhhc093blByb3BlcnR5KHMpJiYoYy5hX2F0dHJbc109ZS5hX2F0dHJbc10pO2ZvcihlJiZlLmNoaWxkcmVuJiZlLmNoaWxkcmVuPT09ITAmJihjLnN0YXRlLmxvYWRlZD0hMSxjLmNoaWxkcmVuPVtdLGMuY2hpbGRyZW5fZD1bXSksZ1tjLmlkXT1jLHM9MCxuPWMuY2hpbGRyZW4ubGVuZ3RoO24+cztzKyspYT1tKGdbYy5jaGlsZHJlbltzXV0sYy5pZCxyKSxvPWdbYV0sYy5jaGlsZHJlbl9kLnB1c2goYSksby5jaGlsZHJlbl9kLmxlbmd0aCYmKGMuY2hpbGRyZW5fZD1jLmNoaWxkcmVuX2QuY29uY2F0KG8uY2hpbGRyZW5fZCkpO3JldHVybiBkZWxldGUgZS5kYXRhLGRlbGV0ZSBlLmNoaWxkcmVuLGdbYy5pZF0ub3JpZ2luYWw9ZSxjLnN0YXRlLnNlbGVjdGVkJiZsLnB1c2goYy5pZCksYy5pZH0sdj1mdW5jdGlvbihlLGkscil7cj1yP3IuY29uY2F0KCk6W10saSYmci51bnNoaWZ0KGkpO3ZhciBzLG4sYSxvLGQsYz0hMTtkbyBjPVwialwiK18rXCJfXCIrICsrdTt3aGlsZShnW2NdKTtkPXtpZDohMSx0ZXh0Olwic3RyaW5nXCI9PXR5cGVvZiBlP2U6XCJcIixpY29uOlwib2JqZWN0XCI9PXR5cGVvZiBlJiZlLmljb24hPT10P2UuaWNvbjohMCxwYXJlbnQ6aSxwYXJlbnRzOnIsY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxkYXRhOm51bGwsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihzIGluIGgpaC5oYXNPd25Qcm9wZXJ0eShzKSYmKGQuc3RhdGVbc109aFtzXSk7aWYoZSYmZS5pZCYmKGQuaWQ9ZS5pZC50b1N0cmluZygpKSxlJiZlLnRleHQmJihkLnRleHQ9ZS50ZXh0KSxlJiZlLmRhdGEmJmUuZGF0YS5qc3RyZWUmJmUuZGF0YS5qc3RyZWUuaWNvbiYmKGQuaWNvbj1lLmRhdGEuanN0cmVlLmljb24pLChkLmljb249PT10fHxudWxsPT09ZC5pY29ufHxcIlwiPT09ZC5pY29uKSYmKGQuaWNvbj0hMCksZSYmZS5kYXRhJiYoZC5kYXRhPWUuZGF0YSxlLmRhdGEuanN0cmVlKSlmb3IocyBpbiBlLmRhdGEuanN0cmVlKWUuZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkocykmJihkLnN0YXRlW3NdPWUuZGF0YS5qc3RyZWVbc10pO2lmKGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlLnN0YXRlKWZvcihzIGluIGUuc3RhdGUpZS5zdGF0ZS5oYXNPd25Qcm9wZXJ0eShzKSYmKGQuc3RhdGVbc109ZS5zdGF0ZVtzXSk7aWYoZSYmXCJvYmplY3RcIj09dHlwZW9mIGUubGlfYXR0cilmb3IocyBpbiBlLmxpX2F0dHIpZS5saV9hdHRyLmhhc093blByb3BlcnR5KHMpJiYoZC5saV9hdHRyW3NdPWUubGlfYXR0cltzXSk7aWYoZC5saV9hdHRyLmlkJiYhZC5pZCYmKGQuaWQ9ZC5saV9hdHRyLmlkLnRvU3RyaW5nKCkpLGQuaWR8fChkLmlkPWMpLGQubGlfYXR0ci5pZHx8KGQubGlfYXR0ci5pZD1kLmlkKSxlJiZcIm9iamVjdFwiPT10eXBlb2YgZS5hX2F0dHIpZm9yKHMgaW4gZS5hX2F0dHIpZS5hX2F0dHIuaGFzT3duUHJvcGVydHkocykmJihkLmFfYXR0cltzXT1lLmFfYXR0cltzXSk7aWYoZSYmZS5jaGlsZHJlbiYmZS5jaGlsZHJlbi5sZW5ndGgpe2ZvcihzPTAsbj1lLmNoaWxkcmVuLmxlbmd0aDtuPnM7cysrKWE9dihlLmNoaWxkcmVuW3NdLGQuaWQsciksbz1nW2FdLGQuY2hpbGRyZW4ucHVzaChhKSxvLmNoaWxkcmVuX2QubGVuZ3RoJiYoZC5jaGlsZHJlbl9kPWQuY2hpbGRyZW5fZC5jb25jYXQoby5jaGlsZHJlbl9kKSk7ZC5jaGlsZHJlbl9kPWQuY2hpbGRyZW5fZC5jb25jYXQoZC5jaGlsZHJlbil9cmV0dXJuIGUmJmUuY2hpbGRyZW4mJmUuY2hpbGRyZW49PT0hMCYmKGQuc3RhdGUubG9hZGVkPSExLGQuY2hpbGRyZW49W10sZC5jaGlsZHJlbl9kPVtdKSxkZWxldGUgZS5kYXRhLGRlbGV0ZSBlLmNoaWxkcmVuLGQub3JpZ2luYWw9ZSxnW2QuaWRdPWQsZC5zdGF0ZS5zZWxlY3RlZCYmbC5wdXNoKGQuaWQpLGQuaWR9O2lmKGEubGVuZ3RoJiZhWzBdLmlkIT09dCYmYVswXS5wYXJlbnQhPT10KXtmb3Iocj0wLHM9YS5sZW5ndGg7cz5yO3IrKylhW3JdLmNoaWxkcmVufHwoYVtyXS5jaGlsZHJlbj1bXSksZ1thW3JdLmlkLnRvU3RyaW5nKCldPWFbcl07Zm9yKHI9MCxzPWEubGVuZ3RoO3M+cjtyKyspZ1thW3JdLnBhcmVudC50b1N0cmluZygpXS5jaGlsZHJlbi5wdXNoKGFbcl0uaWQudG9TdHJpbmcoKSksZi5jaGlsZHJlbl9kLnB1c2goYVtyXS5pZC50b1N0cmluZygpKTtmb3Iocj0wLHM9Zi5jaGlsZHJlbi5sZW5ndGg7cz5yO3IrKylpPW0oZ1tmLmNoaWxkcmVuW3JdXSxvLGYucGFyZW50cy5jb25jYXQoKSksYy5wdXNoKGkpLGdbaV0uY2hpbGRyZW5fZC5sZW5ndGgmJihjPWMuY29uY2F0KGdbaV0uY2hpbGRyZW5fZCkpO2ZvcihyPTAscz1mLnBhcmVudHMubGVuZ3RoO3M+cjtyKyspZ1tmLnBhcmVudHNbcl1dLmNoaWxkcmVuX2Q9Z1tmLnBhcmVudHNbcl1dLmNoaWxkcmVuX2QuY29uY2F0KGMpO249e2NudDp1LG1vZDpnLHNlbDpwLHBhcjpvLGRwYzpjLGFkZDpsfX1lbHNle2ZvcihyPTAscz1hLmxlbmd0aDtzPnI7cisrKWk9dihhW3JdLG8sZi5wYXJlbnRzLmNvbmNhdCgpKSxpJiYoZC5wdXNoKGkpLGMucHVzaChpKSxnW2ldLmNoaWxkcmVuX2QubGVuZ3RoJiYoYz1jLmNvbmNhdChnW2ldLmNoaWxkcmVuX2QpKSk7Zm9yKGYuY2hpbGRyZW49ZCxmLmNoaWxkcmVuX2Q9YyxyPTAscz1mLnBhcmVudHMubGVuZ3RoO3M+cjtyKyspZ1tmLnBhcmVudHNbcl1dLmNoaWxkcmVuX2Q9Z1tmLnBhcmVudHNbcl1dLmNoaWxkcmVuX2QuY29uY2F0KGMpO249e2NudDp1LG1vZDpnLHNlbDpwLHBhcjpvLGRwYzpjLGFkZDpsfX1yZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93LmRvY3VtZW50P246dm9pZCBwb3N0TWVzc2FnZShuKX0sZD1mdW5jdGlvbih0LGkpe2lmKG51bGwhPT10aGlzLmVsZW1lbnQpe2lmKHRoaXMuX2NudD10LmNudCx0aGlzLl9tb2RlbC5kYXRhPXQubW9kLGkpe3ZhciBzLG4sYT10LmFkZCxvPXQuc2VsLGQ9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLnNsaWNlKCksYz10aGlzLl9tb2RlbC5kYXRhO2lmKG8ubGVuZ3RoIT09ZC5sZW5ndGh8fGUudmFrYXRhLmFycmF5X3VuaXF1ZShvLmNvbmNhdChkKSkubGVuZ3RoIT09by5sZW5ndGgpe2ZvcihzPTAsbj1vLmxlbmd0aDtuPnM7cysrKS0xPT09ZS5pbkFycmF5KG9bc10sYSkmJi0xPT09ZS5pbkFycmF5KG9bc10sZCkmJihjW29bc11dLnN0YXRlLnNlbGVjdGVkPSExKTtmb3Iocz0wLG49ZC5sZW5ndGg7bj5zO3MrKyktMT09PWUuaW5BcnJheShkW3NdLG8pJiYoY1tkW3NdXS5zdGF0ZS5zZWxlY3RlZD0hMCl9fXQuYWRkLmxlbmd0aCYmKHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuY29uY2F0KHQuYWRkKSksdGhpcy50cmlnZ2VyKFwibW9kZWxcIix7bm9kZXM6dC5kcGMscGFyZW50OnQucGFyfSksdC5wYXIhPT1lLmpzdHJlZS5yb290Pyh0aGlzLl9ub2RlX2NoYW5nZWQodC5wYXIpLHRoaXMucmVkcmF3KCkpOnRoaXMucmVkcmF3KCEwKSx0LmFkZC5sZW5ndGgmJnRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwibW9kZWxcIixzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWR9KSxyLmNhbGwodGhpcywhMCl9fTtpZih0aGlzLnNldHRpbmdzLmNvcmUud29ya2VyJiZ3aW5kb3cuQmxvYiYmd2luZG93LlVSTCYmd2luZG93Lldvcmtlcil0cnl7bnVsbD09PXRoaXMuX3dyayYmKHRoaXMuX3dyaz13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgd2luZG93LkJsb2IoW1wic2VsZi5vbm1lc3NhZ2UgPSBcIitvLnRvU3RyaW5nKCldLHt0eXBlOlwidGV4dC9qYXZhc2NyaXB0XCJ9KSkpLCF0aGlzLl9kYXRhLmNvcmUud29ya2luZ3x8cz8odGhpcy5fZGF0YS5jb3JlLndvcmtpbmc9ITAsbj1uZXcgd2luZG93Lldvcmtlcih0aGlzLl93cmspLG4ub25tZXNzYWdlPWUucHJveHkoZnVuY3Rpb24oZSl7ZC5jYWxsKHRoaXMsZS5kYXRhLCEwKTt0cnl7bi50ZXJtaW5hdGUoKSxuPW51bGx9Y2F0Y2godCl7fXRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUubGVuZ3RoP3RoaXMuX2FwcGVuZF9qc29uX2RhdGEuYXBwbHkodGhpcyx0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnNoaWZ0KCkpOnRoaXMuX2RhdGEuY29yZS53b3JraW5nPSExfSx0aGlzKSxhLnBhcj9uLnBvc3RNZXNzYWdlKGEpOnRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUubGVuZ3RoP3RoaXMuX2FwcGVuZF9qc29uX2RhdGEuYXBwbHkodGhpcyx0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnNoaWZ0KCkpOnRoaXMuX2RhdGEuY29yZS53b3JraW5nPSExKTp0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnB1c2goW3QsaSxyLCEwXSl9Y2F0Y2goYyl7ZC5jYWxsKHRoaXMsbyhhKSwhMSksdGhpcy5fZGF0YS5jb3JlLndvcmtlcl9xdWV1ZS5sZW5ndGg/dGhpcy5fYXBwZW5kX2pzb25fZGF0YS5hcHBseSh0aGlzLHRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUuc2hpZnQoKSk6dGhpcy5fZGF0YS5jb3JlLndvcmtpbmc9ITF9ZWxzZSBkLmNhbGwodGhpcyxvKGEpLCExKX19LF9wYXJzZV9tb2RlbF9mcm9tX2h0bWw6ZnVuY3Rpb24oaSxyLHMpe3M9cz9bXS5jb25jYXQocyk6W10sciYmcy51bnNoaWZ0KHIpO3ZhciBuLGEsbyxkLGMsbD10aGlzLl9tb2RlbC5kYXRhLGg9e2lkOiExLHRleHQ6ITEsaWNvbjohMCxwYXJlbnQ6cixwYXJlbnRzOnMsY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxkYXRhOm51bGwsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihvIGluIHRoaXMuX21vZGVsLmRlZmF1bHRfc3RhdGUpdGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZS5oYXNPd25Qcm9wZXJ0eShvKSYmKGguc3RhdGVbb109dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZVtvXSk7aWYoZD1lLnZha2F0YS5hdHRyaWJ1dGVzKGksITApLGUuZWFjaChkLGZ1bmN0aW9uKHQsaSl7cmV0dXJuIGk9ZS50cmltKGkpLGkubGVuZ3RoPyhoLmxpX2F0dHJbdF09aSx2b2lkKFwiaWRcIj09PXQmJihoLmlkPWkudG9TdHJpbmcoKSkpKTohMH0pLGQ9aS5jaGlsZHJlbihcImFcIikuZmlyc3QoKSxkLmxlbmd0aCYmKGQ9ZS52YWthdGEuYXR0cmlidXRlcyhkLCEwKSxlLmVhY2goZCxmdW5jdGlvbih0LGkpe2k9ZS50cmltKGkpLGkubGVuZ3RoJiYoaC5hX2F0dHJbdF09aSl9KSksZD1pLmNoaWxkcmVuKFwiYVwiKS5maXJzdCgpLmxlbmd0aD9pLmNoaWxkcmVuKFwiYVwiKS5maXJzdCgpLmNsb25lKCk6aS5jbG9uZSgpLGQuY2hpbGRyZW4oXCJpbnMsIGksIHVsXCIpLnJlbW92ZSgpLGQ9ZC5odG1sKCksZD1lKFwiPGRpdiAvPlwiKS5odG1sKGQpLGgudGV4dD10aGlzLnNldHRpbmdzLmNvcmUuZm9yY2VfdGV4dD9kLnRleHQoKTpkLmh0bWwoKSxkPWkuZGF0YSgpLGguZGF0YT1kP2UuZXh0ZW5kKCEwLHt9LGQpOm51bGwsaC5zdGF0ZS5vcGVuZWQ9aS5oYXNDbGFzcyhcImpzdHJlZS1vcGVuXCIpLGguc3RhdGUuc2VsZWN0ZWQ9aS5jaGlsZHJlbihcImFcIikuaGFzQ2xhc3MoXCJqc3RyZWUtY2xpY2tlZFwiKSxoLnN0YXRlLmRpc2FibGVkPWkuY2hpbGRyZW4oXCJhXCIpLmhhc0NsYXNzKFwianN0cmVlLWRpc2FibGVkXCIpLGguZGF0YSYmaC5kYXRhLmpzdHJlZSlmb3IobyBpbiBoLmRhdGEuanN0cmVlKWguZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkobykmJihoLnN0YXRlW29dPWguZGF0YS5qc3RyZWVbb10pO2Q9aS5jaGlsZHJlbihcImFcIikuY2hpbGRyZW4oXCIuanN0cmVlLXRoZW1laWNvblwiKSxkLmxlbmd0aCYmKGguaWNvbj1kLmhhc0NsYXNzKFwianN0cmVlLXRoZW1laWNvbi1oaWRkZW5cIik/ITE6ZC5hdHRyKFwicmVsXCIpKSxoLnN0YXRlLmljb24hPT10JiYoaC5pY29uPWguc3RhdGUuaWNvbiksKGguaWNvbj09PXR8fG51bGw9PT1oLmljb258fFwiXCI9PT1oLmljb24pJiYoaC5pY29uPSEwKSxkPWkuY2hpbGRyZW4oXCJ1bFwiKS5jaGlsZHJlbihcImxpXCIpO2RvIGM9XCJqXCIrdGhpcy5faWQrXCJfXCIrICsrdGhpcy5fY250O3doaWxlKGxbY10pO3JldHVybiBoLmlkPWgubGlfYXR0ci5pZD9oLmxpX2F0dHIuaWQudG9TdHJpbmcoKTpjLGQubGVuZ3RoPyhkLmVhY2goZS5wcm94eShmdW5jdGlvbih0LGkpe249dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9odG1sKGUoaSksaC5pZCxzKSxhPXRoaXMuX21vZGVsLmRhdGFbbl0saC5jaGlsZHJlbi5wdXNoKG4pLGEuY2hpbGRyZW5fZC5sZW5ndGgmJihoLmNoaWxkcmVuX2Q9aC5jaGlsZHJlbl9kLmNvbmNhdChhLmNoaWxkcmVuX2QpKX0sdGhpcykpLGguY2hpbGRyZW5fZD1oLmNoaWxkcmVuX2QuY29uY2F0KGguY2hpbGRyZW4pKTppLmhhc0NsYXNzKFwianN0cmVlLWNsb3NlZFwiKSYmKGguc3RhdGUubG9hZGVkPSExKSxoLmxpX2F0dHJbXCJjbGFzc1wiXSYmKGgubGlfYXR0cltcImNsYXNzXCJdPWgubGlfYXR0cltcImNsYXNzXCJdLnJlcGxhY2UoXCJqc3RyZWUtY2xvc2VkXCIsXCJcIikucmVwbGFjZShcImpzdHJlZS1vcGVuXCIsXCJcIikpLGguYV9hdHRyW1wiY2xhc3NcIl0mJihoLmFfYXR0cltcImNsYXNzXCJdPWguYV9hdHRyW1wiY2xhc3NcIl0ucmVwbGFjZShcImpzdHJlZS1jbGlja2VkXCIsXCJcIikucmVwbGFjZShcImpzdHJlZS1kaXNhYmxlZFwiLFwiXCIpKSxsW2guaWRdPWgsaC5zdGF0ZS5zZWxlY3RlZCYmdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLnB1c2goaC5pZCksaC5pZH0sX3BhcnNlX21vZGVsX2Zyb21fZmxhdF9qc29uOmZ1bmN0aW9uKGUsaSxyKXtyPXI/ci5jb25jYXQoKTpbXSxpJiZyLnVuc2hpZnQoaSk7dmFyIHMsbixhLG8sZD1lLmlkLnRvU3RyaW5nKCksYz10aGlzLl9tb2RlbC5kYXRhLGw9dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZSxoPXtpZDpkLHRleHQ6ZS50ZXh0fHxcIlwiLGljb246ZS5pY29uIT09dD9lLmljb246ITAscGFyZW50OmkscGFyZW50czpyLGNoaWxkcmVuOmUuY2hpbGRyZW58fFtdLGNoaWxkcmVuX2Q6ZS5jaGlsZHJlbl9kfHxbXSxkYXRhOmUuZGF0YSxzdGF0ZTp7fSxsaV9hdHRyOntpZDohMX0sYV9hdHRyOntocmVmOlwiI1wifSxvcmlnaW5hbDohMX07Zm9yKHMgaW4gbClsLmhhc093blByb3BlcnR5KHMpJiYoaC5zdGF0ZVtzXT1sW3NdKTtpZihlJiZlLmRhdGEmJmUuZGF0YS5qc3RyZWUmJmUuZGF0YS5qc3RyZWUuaWNvbiYmKGguaWNvbj1lLmRhdGEuanN0cmVlLmljb24pLChoLmljb249PT10fHxudWxsPT09aC5pY29ufHxcIlwiPT09aC5pY29uKSYmKGguaWNvbj0hMCksZSYmZS5kYXRhJiYoaC5kYXRhPWUuZGF0YSxlLmRhdGEuanN0cmVlKSlmb3IocyBpbiBlLmRhdGEuanN0cmVlKWUuZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkocykmJihoLnN0YXRlW3NdPWUuZGF0YS5qc3RyZWVbc10pO2lmKGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlLnN0YXRlKWZvcihzIGluIGUuc3RhdGUpZS5zdGF0ZS5oYXNPd25Qcm9wZXJ0eShzKSYmKGguc3RhdGVbc109ZS5zdGF0ZVtzXSk7aWYoZSYmXCJvYmplY3RcIj09dHlwZW9mIGUubGlfYXR0cilmb3IocyBpbiBlLmxpX2F0dHIpZS5saV9hdHRyLmhhc093blByb3BlcnR5KHMpJiYoaC5saV9hdHRyW3NdPWUubGlfYXR0cltzXSk7aWYoaC5saV9hdHRyLmlkfHwoaC5saV9hdHRyLmlkPWQpLGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlLmFfYXR0cilmb3IocyBpbiBlLmFfYXR0cillLmFfYXR0ci5oYXNPd25Qcm9wZXJ0eShzKSYmKGguYV9hdHRyW3NdPWUuYV9hdHRyW3NdKTtmb3IoZSYmZS5jaGlsZHJlbiYmZS5jaGlsZHJlbj09PSEwJiYoaC5zdGF0ZS5sb2FkZWQ9ITEsaC5jaGlsZHJlbj1bXSxoLmNoaWxkcmVuX2Q9W10pLGNbaC5pZF09aCxzPTAsbj1oLmNoaWxkcmVuLmxlbmd0aDtuPnM7cysrKWE9dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9mbGF0X2pzb24oY1toLmNoaWxkcmVuW3NdXSxoLmlkLHIpLG89Y1thXSxoLmNoaWxkcmVuX2QucHVzaChhKSxvLmNoaWxkcmVuX2QubGVuZ3RoJiYoaC5jaGlsZHJlbl9kPWguY2hpbGRyZW5fZC5jb25jYXQoby5jaGlsZHJlbl9kKSk7cmV0dXJuIGRlbGV0ZSBlLmRhdGEsZGVsZXRlIGUuY2hpbGRyZW4sY1toLmlkXS5vcmlnaW5hbD1lLGguc3RhdGUuc2VsZWN0ZWQmJnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5wdXNoKGguaWQpLGguaWR9LF9wYXJzZV9tb2RlbF9mcm9tX2pzb246ZnVuY3Rpb24oZSxpLHIpe3I9cj9yLmNvbmNhdCgpOltdLGkmJnIudW5zaGlmdChpKTt2YXIgcyxuLGEsbyxkLGM9ITEsbD10aGlzLl9tb2RlbC5kYXRhLGg9dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZTtkbyBjPVwialwiK3RoaXMuX2lkK1wiX1wiKyArK3RoaXMuX2NudDt3aGlsZShsW2NdKTtkPXtpZDohMSx0ZXh0Olwic3RyaW5nXCI9PXR5cGVvZiBlP2U6XCJcIixpY29uOlwib2JqZWN0XCI9PXR5cGVvZiBlJiZlLmljb24hPT10P2UuaWNvbjohMCxwYXJlbnQ6aSxwYXJlbnRzOnIsY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxkYXRhOm51bGwsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihzIGluIGgpaC5oYXNPd25Qcm9wZXJ0eShzKSYmKGQuc3RhdGVbc109aFtzXSk7aWYoZSYmZS5pZCYmKGQuaWQ9ZS5pZC50b1N0cmluZygpKSxlJiZlLnRleHQmJihkLnRleHQ9ZS50ZXh0KSxlJiZlLmRhdGEmJmUuZGF0YS5qc3RyZWUmJmUuZGF0YS5qc3RyZWUuaWNvbiYmKGQuaWNvbj1lLmRhdGEuanN0cmVlLmljb24pLChkLmljb249PT10fHxudWxsPT09ZC5pY29ufHxcIlwiPT09ZC5pY29uKSYmKGQuaWNvbj0hMCksZSYmZS5kYXRhJiYoZC5kYXRhPWUuZGF0YSxlLmRhdGEuanN0cmVlKSlmb3IocyBpbiBlLmRhdGEuanN0cmVlKWUuZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkocykmJihkLnN0YXRlW3NdPWUuZGF0YS5qc3RyZWVbc10pO2lmKGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlLnN0YXRlKWZvcihzIGluIGUuc3RhdGUpZS5zdGF0ZS5oYXNPd25Qcm9wZXJ0eShzKSYmKGQuc3RhdGVbc109ZS5zdGF0ZVtzXSk7aWYoZSYmXCJvYmplY3RcIj09dHlwZW9mIGUubGlfYXR0cilmb3IocyBpbiBlLmxpX2F0dHIpZS5saV9hdHRyLmhhc093blByb3BlcnR5KHMpJiYoZC5saV9hdHRyW3NdPWUubGlfYXR0cltzXSk7aWYoZC5saV9hdHRyLmlkJiYhZC5pZCYmKGQuaWQ9ZC5saV9hdHRyLmlkLnRvU3RyaW5nKCkpLGQuaWR8fChkLmlkPWMpLGQubGlfYXR0ci5pZHx8KGQubGlfYXR0ci5pZD1kLmlkKSxlJiZcIm9iamVjdFwiPT10eXBlb2YgZS5hX2F0dHIpZm9yKHMgaW4gZS5hX2F0dHIpZS5hX2F0dHIuaGFzT3duUHJvcGVydHkocykmJihkLmFfYXR0cltzXT1lLmFfYXR0cltzXSk7aWYoZSYmZS5jaGlsZHJlbiYmZS5jaGlsZHJlbi5sZW5ndGgpe2ZvcihzPTAsbj1lLmNoaWxkcmVuLmxlbmd0aDtuPnM7cysrKWE9dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9qc29uKGUuY2hpbGRyZW5bc10sZC5pZCxyKSxvPWxbYV0sZC5jaGlsZHJlbi5wdXNoKGEpLG8uY2hpbGRyZW5fZC5sZW5ndGgmJihkLmNoaWxkcmVuX2Q9ZC5jaGlsZHJlbl9kLmNvbmNhdChvLmNoaWxkcmVuX2QpKTtkLmNoaWxkcmVuX2Q9ZC5jaGlsZHJlbl9kLmNvbmNhdChkLmNoaWxkcmVuKX1yZXR1cm4gZSYmZS5jaGlsZHJlbiYmZS5jaGlsZHJlbj09PSEwJiYoZC5zdGF0ZS5sb2FkZWQ9ITEsZC5jaGlsZHJlbj1bXSxkLmNoaWxkcmVuX2Q9W10pLGRlbGV0ZSBlLmRhdGEsZGVsZXRlIGUuY2hpbGRyZW4sZC5vcmlnaW5hbD1lLGxbZC5pZF09ZCxkLnN0YXRlLnNlbGVjdGVkJiZ0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQucHVzaChkLmlkKSxkLmlkfSxfcmVkcmF3OmZ1bmN0aW9uKCl7dmFyIHQsaSxyLHM9dGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXc/dGhpcy5fbW9kZWwuZGF0YVtlLmpzdHJlZS5yb290XS5jaGlsZHJlbi5jb25jYXQoW10pOnRoaXMuX21vZGVsLmNoYW5nZWQuY29uY2F0KFtdKSxuPWwuY3JlYXRlRWxlbWVudChcIlVMXCIpLGE9dGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQ7Zm9yKGk9MCxyPXMubGVuZ3RoO3I+aTtpKyspdD10aGlzLnJlZHJhd19ub2RlKHNbaV0sITAsdGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXcpLHQmJnRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3JiZuLmFwcGVuZENoaWxkKHQpO3RoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3JiYobi5jbGFzc05hbWU9dGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0uY2xhc3NOYW1lLG4uc2V0QXR0cmlidXRlKFwicm9sZVwiLFwiZ3JvdXBcIiksdGhpcy5lbGVtZW50LmVtcHR5KCkuYXBwZW5kKG4pKSxudWxsIT09YSYmKHQ9dGhpcy5nZXRfbm9kZShhLCEwKSx0JiZ0Lmxlbmd0aCYmdC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpWzBdIT09bC5hY3RpdmVFbGVtZW50P3QuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpOnRoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW51bGwpLHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSExLHRoaXMuX21vZGVsLmNoYW5nZWQ9W10sdGhpcy50cmlnZ2VyKFwicmVkcmF3XCIse25vZGVzOnN9KX0scmVkcmF3OmZ1bmN0aW9uKGUpe2UmJih0aGlzLl9tb2RlbC5mb3JjZV9mdWxsX3JlZHJhdz0hMCksdGhpcy5fcmVkcmF3KCl9LGRyYXdfY2hpbGRyZW46ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXRfbm9kZSh0KSxyPSExLHM9ITEsbj0hMSxhPWw7aWYoIWkpcmV0dXJuITE7aWYoaS5pZD09PWUuanN0cmVlLnJvb3QpcmV0dXJuIHRoaXMucmVkcmF3KCEwKTtpZih0PXRoaXMuZ2V0X25vZGUodCwhMCksIXR8fCF0Lmxlbmd0aClyZXR1cm4hMTtpZih0LmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5yZW1vdmUoKSx0PXRbMF0saS5jaGlsZHJlbi5sZW5ndGgmJmkuc3RhdGUubG9hZGVkKXtmb3Iobj1hLmNyZWF0ZUVsZW1lbnQoXCJVTFwiKSxuLnNldEF0dHJpYnV0ZShcInJvbGVcIixcImdyb3VwXCIpLG4uY2xhc3NOYW1lPVwianN0cmVlLWNoaWxkcmVuXCIscj0wLHM9aS5jaGlsZHJlbi5sZW5ndGg7cz5yO3IrKyluLmFwcGVuZENoaWxkKHRoaXMucmVkcmF3X25vZGUoaS5jaGlsZHJlbltyXSwhMCwhMCkpO3QuYXBwZW5kQ2hpbGQobil9fSxyZWRyYXdfbm9kZTpmdW5jdGlvbih0LGkscixzKXt2YXIgbj10aGlzLmdldF9ub2RlKHQpLGE9ITEsbz0hMSxkPSExLGM9ITEsXz0hMSx1PSExLGc9XCJcIixmPWwscD10aGlzLl9tb2RlbC5kYXRhLG09ITEsdj1udWxsLGo9MCx5PTAsaz0hMSx4PSExO2lmKCFuKXJldHVybiExO2lmKG4uaWQ9PT1lLmpzdHJlZS5yb290KXJldHVybiB0aGlzLnJlZHJhdyghMCk7aWYoaT1pfHwwPT09bi5jaGlsZHJlbi5sZW5ndGgsdD1sLnF1ZXJ5U2VsZWN0b3I/dGhpcy5lbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoXCIjXCIrKC0xIT09XCIwMTIzNDU2Nzg5XCIuaW5kZXhPZihuLmlkWzBdKT9cIlxcXFwzXCIrbi5pZFswXStcIiBcIituLmlkLnN1YnN0cigxKS5yZXBsYWNlKGUuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIik6bi5pZC5yZXBsYWNlKGUuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIikpKTpsLmdldEVsZW1lbnRCeUlkKG4uaWQpKXQ9ZSh0KSxyfHwoYT10LnBhcmVudCgpLnBhcmVudCgpWzBdLGE9PT10aGlzLmVsZW1lbnRbMF0mJihhPW51bGwpLG89dC5pbmRleCgpKSxpfHwhbi5jaGlsZHJlbi5sZW5ndGh8fHQuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLmxlbmd0aHx8KGk9ITApLFxuaXx8KGQ9dC5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIilbMF0pLG09dC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpWzBdPT09bC5hY3RpdmVFbGVtZW50LHQucmVtb3ZlKCk7ZWxzZSBpZihpPSEwLCFyKXtpZihhPW4ucGFyZW50IT09ZS5qc3RyZWUucm9vdD9lKFwiI1wiK24ucGFyZW50LnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKSx0aGlzLmVsZW1lbnQpWzBdOm51bGwsIShudWxsPT09YXx8YSYmcFtuLnBhcmVudF0uc3RhdGUub3BlbmVkKSlyZXR1cm4hMTtvPWUuaW5BcnJheShuLmlkLG51bGw9PT1hP3BbZS5qc3RyZWUucm9vdF0uY2hpbGRyZW46cFtuLnBhcmVudF0uY2hpbGRyZW4pfXQ9aC5jbG9uZU5vZGUoITApLGc9XCJqc3RyZWUtbm9kZSBcIjtmb3IoYyBpbiBuLmxpX2F0dHIpaWYobi5saV9hdHRyLmhhc093blByb3BlcnR5KGMpKXtpZihcImlkXCI9PT1jKWNvbnRpbnVlO1wiY2xhc3NcIiE9PWM/dC5zZXRBdHRyaWJ1dGUoYyxuLmxpX2F0dHJbY10pOmcrPW4ubGlfYXR0cltjXX1mb3Iobi5hX2F0dHIuaWR8fChuLmFfYXR0ci5pZD1uLmlkK1wiX2FuY2hvclwiKSx0LnNldEF0dHJpYnV0ZShcImFyaWEtc2VsZWN0ZWRcIiwhIW4uc3RhdGUuc2VsZWN0ZWQpLHQuc2V0QXR0cmlidXRlKFwiYXJpYS1sZXZlbFwiLG4ucGFyZW50cy5sZW5ndGgpLHQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbGxlZGJ5XCIsbi5hX2F0dHIuaWQpLG4uc3RhdGUuZGlzYWJsZWQmJnQuc2V0QXR0cmlidXRlKFwiYXJpYS1kaXNhYmxlZFwiLCEwKSxjPTAsXz1uLmNoaWxkcmVuLmxlbmd0aDtfPmM7YysrKWlmKCFwW24uY2hpbGRyZW5bY11dLnN0YXRlLmhpZGRlbil7az0hMDticmVha31pZihudWxsIT09bi5wYXJlbnQmJnBbbi5wYXJlbnRdJiYhbi5zdGF0ZS5oaWRkZW4mJihjPWUuaW5BcnJheShuLmlkLHBbbi5wYXJlbnRdLmNoaWxkcmVuKSx4PW4uaWQsLTEhPT1jKSlmb3IoYysrLF89cFtuLnBhcmVudF0uY2hpbGRyZW4ubGVuZ3RoO18+YyYmKHBbcFtuLnBhcmVudF0uY2hpbGRyZW5bY11dLnN0YXRlLmhpZGRlbnx8KHg9cFtuLnBhcmVudF0uY2hpbGRyZW5bY10pLHg9PT1uLmlkKTtjKyspO24uc3RhdGUuaGlkZGVuJiYoZys9XCIganN0cmVlLWhpZGRlblwiKSxuLnN0YXRlLmxvYWRlZCYmIWs/Zys9XCIganN0cmVlLWxlYWZcIjooZys9bi5zdGF0ZS5vcGVuZWQmJm4uc3RhdGUubG9hZGVkP1wiIGpzdHJlZS1vcGVuXCI6XCIganN0cmVlLWNsb3NlZFwiLHQuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLG4uc3RhdGUub3BlbmVkJiZuLnN0YXRlLmxvYWRlZCkpLHg9PT1uLmlkJiYoZys9XCIganN0cmVlLWxhc3RcIiksdC5pZD1uLmlkLHQuY2xhc3NOYW1lPWcsZz0obi5zdGF0ZS5zZWxlY3RlZD9cIiBqc3RyZWUtY2xpY2tlZFwiOlwiXCIpKyhuLnN0YXRlLmRpc2FibGVkP1wiIGpzdHJlZS1kaXNhYmxlZFwiOlwiXCIpO2ZvcihfIGluIG4uYV9hdHRyKWlmKG4uYV9hdHRyLmhhc093blByb3BlcnR5KF8pKXtpZihcImhyZWZcIj09PV8mJlwiI1wiPT09bi5hX2F0dHJbX10pY29udGludWU7XCJjbGFzc1wiIT09Xz90LmNoaWxkTm9kZXNbMV0uc2V0QXR0cmlidXRlKF8sbi5hX2F0dHJbX10pOmcrPVwiIFwiK24uYV9hdHRyW19dfWlmKGcubGVuZ3RoJiYodC5jaGlsZE5vZGVzWzFdLmNsYXNzTmFtZT1cImpzdHJlZS1hbmNob3IgXCIrZyksKG4uaWNvbiYmbi5pY29uIT09ITB8fG4uaWNvbj09PSExKSYmKG4uaWNvbj09PSExP3QuY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLmNsYXNzTmFtZSs9XCIganN0cmVlLXRoZW1laWNvbi1oaWRkZW5cIjotMT09PW4uaWNvbi5pbmRleE9mKFwiL1wiKSYmLTE9PT1uLmljb24uaW5kZXhPZihcIi5cIik/dC5jaGlsZE5vZGVzWzFdLmNoaWxkTm9kZXNbMF0uY2xhc3NOYW1lKz1cIiBcIituLmljb24rXCIganN0cmVlLXRoZW1laWNvbi1jdXN0b21cIjoodC5jaGlsZE5vZGVzWzFdLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZEltYWdlPVwidXJsKFwiK24uaWNvbitcIilcIix0LmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1swXS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb249XCJjZW50ZXIgY2VudGVyXCIsdC5jaGlsZE5vZGVzWzFdLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZFNpemU9XCJhdXRvXCIsdC5jaGlsZE5vZGVzWzFdLmNoaWxkTm9kZXNbMF0uY2xhc3NOYW1lKz1cIiBqc3RyZWUtdGhlbWVpY29uLWN1c3RvbVwiKSksdGhpcy5zZXR0aW5ncy5jb3JlLmZvcmNlX3RleHQ/dC5jaGlsZE5vZGVzWzFdLmFwcGVuZENoaWxkKGYuY3JlYXRlVGV4dE5vZGUobi50ZXh0KSk6dC5jaGlsZE5vZGVzWzFdLmlubmVySFRNTCs9bi50ZXh0LGkmJm4uY2hpbGRyZW4ubGVuZ3RoJiYobi5zdGF0ZS5vcGVuZWR8fHMpJiZuLnN0YXRlLmxvYWRlZCl7Zm9yKHU9Zi5jcmVhdGVFbGVtZW50KFwiVUxcIiksdS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJncm91cFwiKSx1LmNsYXNzTmFtZT1cImpzdHJlZS1jaGlsZHJlblwiLGM9MCxfPW4uY2hpbGRyZW4ubGVuZ3RoO18+YztjKyspdS5hcHBlbmRDaGlsZCh0aGlzLnJlZHJhd19ub2RlKG4uY2hpbGRyZW5bY10saSwhMCkpO3QuYXBwZW5kQ2hpbGQodSl9aWYoZCYmdC5hcHBlbmRDaGlsZChkKSwhcil7Zm9yKGF8fChhPXRoaXMuZWxlbWVudFswXSksYz0wLF89YS5jaGlsZE5vZGVzLmxlbmd0aDtfPmM7YysrKWlmKGEuY2hpbGROb2Rlc1tjXSYmYS5jaGlsZE5vZGVzW2NdLmNsYXNzTmFtZSYmLTEhPT1hLmNoaWxkTm9kZXNbY10uY2xhc3NOYW1lLmluZGV4T2YoXCJqc3RyZWUtY2hpbGRyZW5cIikpe3Y9YS5jaGlsZE5vZGVzW2NdO2JyZWFrfXZ8fCh2PWYuY3JlYXRlRWxlbWVudChcIlVMXCIpLHYuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwiZ3JvdXBcIiksdi5jbGFzc05hbWU9XCJqc3RyZWUtY2hpbGRyZW5cIixhLmFwcGVuZENoaWxkKHYpKSxhPXYsbzxhLmNoaWxkTm9kZXMubGVuZ3RoP2EuaW5zZXJ0QmVmb3JlKHQsYS5jaGlsZE5vZGVzW29dKTphLmFwcGVuZENoaWxkKHQpLG0mJihqPXRoaXMuZWxlbWVudFswXS5zY3JvbGxUb3AseT10aGlzLmVsZW1lbnRbMF0uc2Nyb2xsTGVmdCx0LmNoaWxkTm9kZXNbMV0uZm9jdXMoKSx0aGlzLmVsZW1lbnRbMF0uc2Nyb2xsVG9wPWosdGhpcy5lbGVtZW50WzBdLnNjcm9sbExlZnQ9eSl9cmV0dXJuIG4uc3RhdGUub3BlbmVkJiYhbi5zdGF0ZS5sb2FkZWQmJihuLnN0YXRlLm9wZW5lZD0hMSxzZXRUaW1lb3V0KGUucHJveHkoZnVuY3Rpb24oKXt0aGlzLm9wZW5fbm9kZShuLmlkLCExLDApfSx0aGlzKSwwKSksdH0sb3Blbl9ub2RlOmZ1bmN0aW9uKGkscixzKXt2YXIgbixhLG8sZDtpZihlLmlzQXJyYXkoaSkpe2ZvcihpPWkuc2xpY2UoKSxuPTAsYT1pLmxlbmd0aDthPm47bisrKXRoaXMub3Blbl9ub2RlKGlbbl0scixzKTtyZXR1cm4hMH1yZXR1cm4gaT10aGlzLmdldF9ub2RlKGkpLGkmJmkuaWQhPT1lLmpzdHJlZS5yb290PyhzPXM9PT10P3RoaXMuc2V0dGluZ3MuY29yZS5hbmltYXRpb246cyx0aGlzLmlzX2Nsb3NlZChpKT90aGlzLmlzX2xvYWRlZChpKT8obz10aGlzLmdldF9ub2RlKGksITApLGQ9dGhpcyxvLmxlbmd0aCYmKHMmJm8uY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLmxlbmd0aCYmby5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuc3RvcCghMCwhMCksaS5jaGlsZHJlbi5sZW5ndGgmJiF0aGlzLl9maXJzdENoaWxkKG8uY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpWzBdKSYmdGhpcy5kcmF3X2NoaWxkcmVuKGkpLHM/KHRoaXMudHJpZ2dlcihcImJlZm9yZV9vcGVuXCIse25vZGU6aX0pLG8uY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIikuZW5kKCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtY2xvc2VkXCIpLmFkZENsYXNzKFwianN0cmVlLW9wZW5cIikuYXR0cihcImFyaWEtZXhwYW5kZWRcIiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLnN0b3AoITAsITApLnNsaWRlRG93bihzLGZ1bmN0aW9uKCl7dGhpcy5zdHlsZS5kaXNwbGF5PVwiXCIsZC50cmlnZ2VyKFwiYWZ0ZXJfb3BlblwiLHtub2RlOml9KX0pKToodGhpcy50cmlnZ2VyKFwiYmVmb3JlX29wZW5cIix7bm9kZTppfSksb1swXS5jbGFzc05hbWU9b1swXS5jbGFzc05hbWUucmVwbGFjZShcImpzdHJlZS1jbG9zZWRcIixcImpzdHJlZS1vcGVuXCIpLG9bMF0uc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCEwKSkpLGkuc3RhdGUub3BlbmVkPSEwLHImJnIuY2FsbCh0aGlzLGksITApLG8ubGVuZ3RofHx0aGlzLnRyaWdnZXIoXCJiZWZvcmVfb3BlblwiLHtub2RlOml9KSx0aGlzLnRyaWdnZXIoXCJvcGVuX25vZGVcIix7bm9kZTppfSkscyYmby5sZW5ndGh8fHRoaXMudHJpZ2dlcihcImFmdGVyX29wZW5cIix7bm9kZTppfSksITApOnRoaXMuaXNfbG9hZGluZyhpKT9zZXRUaW1lb3V0KGUucHJveHkoZnVuY3Rpb24oKXt0aGlzLm9wZW5fbm9kZShpLHIscyl9LHRoaXMpLDUwMCk6dm9pZCB0aGlzLmxvYWRfbm9kZShpLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/dGhpcy5vcGVuX25vZGUoZSxyLHMpOnI/ci5jYWxsKHRoaXMsZSwhMSk6ITF9KToociYmci5jYWxsKHRoaXMsaSwhMSksITEpKTohMX0sX29wZW5fdG86ZnVuY3Rpb24odCl7aWYodD10aGlzLmdldF9ub2RlKHQpLCF0fHx0LmlkPT09ZS5qc3RyZWUucm9vdClyZXR1cm4hMTt2YXIgaSxyLHM9dC5wYXJlbnRzO2ZvcihpPTAscj1zLmxlbmd0aDtyPmk7aSs9MSlpIT09ZS5qc3RyZWUucm9vdCYmdGhpcy5vcGVuX25vZGUoc1tpXSwhMSwwKTtyZXR1cm4gZShcIiNcIit0LmlkLnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKSx0aGlzLmVsZW1lbnQpfSxjbG9zZV9ub2RlOmZ1bmN0aW9uKGkscil7dmFyIHMsbixhLG87aWYoZS5pc0FycmF5KGkpKXtmb3IoaT1pLnNsaWNlKCkscz0wLG49aS5sZW5ndGg7bj5zO3MrKyl0aGlzLmNsb3NlX25vZGUoaVtzXSxyKTtyZXR1cm4hMH1yZXR1cm4gaT10aGlzLmdldF9ub2RlKGkpLGkmJmkuaWQhPT1lLmpzdHJlZS5yb290P3RoaXMuaXNfY2xvc2VkKGkpPyExOihyPXI9PT10P3RoaXMuc2V0dGluZ3MuY29yZS5hbmltYXRpb246cixhPXRoaXMsbz10aGlzLmdldF9ub2RlKGksITApLG8ubGVuZ3RoJiYocj9vLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5hdHRyKFwic3R5bGVcIixcImRpc3BsYXk6YmxvY2sgIWltcG9ydGFudFwiKS5lbmQoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1vcGVuXCIpLmFkZENsYXNzKFwianN0cmVlLWNsb3NlZFwiKS5hdHRyKFwiYXJpYS1leHBhbmRlZFwiLCExKS5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuc3RvcCghMCwhMCkuc2xpZGVVcChyLGZ1bmN0aW9uKCl7dGhpcy5zdHlsZS5kaXNwbGF5PVwiXCIsby5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikucmVtb3ZlKCksYS50cmlnZ2VyKFwiYWZ0ZXJfY2xvc2VcIix7bm9kZTppfSl9KToob1swXS5jbGFzc05hbWU9b1swXS5jbGFzc05hbWUucmVwbGFjZShcImpzdHJlZS1vcGVuXCIsXCJqc3RyZWUtY2xvc2VkXCIpLG8uYXR0cihcImFyaWEtZXhwYW5kZWRcIiwhMSkuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLnJlbW92ZSgpKSksaS5zdGF0ZS5vcGVuZWQ9ITEsdGhpcy50cmlnZ2VyKFwiY2xvc2Vfbm9kZVwiLHtub2RlOml9KSx2b2lkKHImJm8ubGVuZ3RofHx0aGlzLnRyaWdnZXIoXCJhZnRlcl9jbG9zZVwiLHtub2RlOml9KSkpOiExfSx0b2dnbGVfbm9kZTpmdW5jdGlvbih0KXt2YXIgaSxyO2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLGk9MCxyPXQubGVuZ3RoO3I+aTtpKyspdGhpcy50b2dnbGVfbm9kZSh0W2ldKTtyZXR1cm4hMH1yZXR1cm4gdGhpcy5pc19jbG9zZWQodCk/dGhpcy5vcGVuX25vZGUodCk6dGhpcy5pc19vcGVuKHQpP3RoaXMuY2xvc2Vfbm9kZSh0KTp2b2lkIDB9LG9wZW5fYWxsOmZ1bmN0aW9uKHQsaSxyKXtpZih0fHwodD1lLmpzdHJlZS5yb290KSx0PXRoaXMuZ2V0X25vZGUodCksIXQpcmV0dXJuITE7dmFyIHMsbixhLG89dC5pZD09PWUuanN0cmVlLnJvb3Q/dGhpcy5nZXRfY29udGFpbmVyX3VsKCk6dGhpcy5nZXRfbm9kZSh0LCEwKTtpZighby5sZW5ndGgpe2ZvcihzPTAsbj10LmNoaWxkcmVuX2QubGVuZ3RoO24+cztzKyspdGhpcy5pc19jbG9zZWQodGhpcy5fbW9kZWwuZGF0YVt0LmNoaWxkcmVuX2Rbc11dKSYmKHRoaXMuX21vZGVsLmRhdGFbdC5jaGlsZHJlbl9kW3NdXS5zdGF0ZS5vcGVuZWQ9ITApO3JldHVybiB0aGlzLnRyaWdnZXIoXCJvcGVuX2FsbFwiLHtub2RlOnR9KX1yPXJ8fG8sYT10aGlzLG89dGhpcy5pc19jbG9zZWQodCk/by5maW5kKFwiLmpzdHJlZS1jbG9zZWRcIikuYWRkQmFjaygpOm8uZmluZChcIi5qc3RyZWUtY2xvc2VkXCIpLG8uZWFjaChmdW5jdGlvbigpe2Eub3Blbl9ub2RlKHRoaXMsZnVuY3Rpb24oZSx0KXt0JiZ0aGlzLmlzX3BhcmVudChlKSYmdGhpcy5vcGVuX2FsbChlLGkscil9LGl8fDApfSksMD09PXIuZmluZChcIi5qc3RyZWUtY2xvc2VkXCIpLmxlbmd0aCYmdGhpcy50cmlnZ2VyKFwib3Blbl9hbGxcIix7bm9kZTp0aGlzLmdldF9ub2RlKHIpfSl9LGNsb3NlX2FsbDpmdW5jdGlvbih0LGkpe2lmKHR8fCh0PWUuanN0cmVlLnJvb3QpLHQ9dGhpcy5nZXRfbm9kZSh0KSwhdClyZXR1cm4hMTt2YXIgcixzLG49dC5pZD09PWUuanN0cmVlLnJvb3Q/dGhpcy5nZXRfY29udGFpbmVyX3VsKCk6dGhpcy5nZXRfbm9kZSh0LCEwKSxhPXRoaXM7Zm9yKG4ubGVuZ3RoJiYobj10aGlzLmlzX29wZW4odCk/bi5maW5kKFwiLmpzdHJlZS1vcGVuXCIpLmFkZEJhY2soKTpuLmZpbmQoXCIuanN0cmVlLW9wZW5cIiksZShuLmdldCgpLnJldmVyc2UoKSkuZWFjaChmdW5jdGlvbigpe2EuY2xvc2Vfbm9kZSh0aGlzLGl8fDApfSkpLHI9MCxzPXQuY2hpbGRyZW5fZC5sZW5ndGg7cz5yO3IrKyl0aGlzLl9tb2RlbC5kYXRhW3QuY2hpbGRyZW5fZFtyXV0uc3RhdGUub3BlbmVkPSExO3RoaXMudHJpZ2dlcihcImNsb3NlX2FsbFwiLHtub2RlOnR9KX0saXNfZGlzYWJsZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dGhpcy5nZXRfbm9kZShlKSxlJiZlLnN0YXRlJiZlLnN0YXRlLmRpc2FibGVkfSxlbmFibGVfbm9kZTpmdW5jdGlvbih0KXt2YXIgaSxyO2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLGk9MCxyPXQubGVuZ3RoO3I+aTtpKyspdGhpcy5lbmFibGVfbm9kZSh0W2ldKTtyZXR1cm4hMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290Pyh0LnN0YXRlLmRpc2FibGVkPSExLHRoaXMuZ2V0X25vZGUodCwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1kaXNhYmxlZFwiKS5hdHRyKFwiYXJpYS1kaXNhYmxlZFwiLCExKSx2b2lkIHRoaXMudHJpZ2dlcihcImVuYWJsZV9ub2RlXCIse25vZGU6dH0pKTohMX0sZGlzYWJsZV9ub2RlOmZ1bmN0aW9uKHQpe3ZhciBpLHI7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCksaT0wLHI9dC5sZW5ndGg7cj5pO2krKyl0aGlzLmRpc2FibGVfbm9kZSh0W2ldKTtyZXR1cm4hMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290Pyh0LnN0YXRlLmRpc2FibGVkPSEwLHRoaXMuZ2V0X25vZGUodCwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5hZGRDbGFzcyhcImpzdHJlZS1kaXNhYmxlZFwiKS5hdHRyKFwiYXJpYS1kaXNhYmxlZFwiLCEwKSx2b2lkIHRoaXMudHJpZ2dlcihcImRpc2FibGVfbm9kZVwiLHtub2RlOnR9KSk6ITF9LGhpZGVfbm9kZTpmdW5jdGlvbih0LGkpe3ZhciByLHM7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCkscj0wLHM9dC5sZW5ndGg7cz5yO3IrKyl0aGlzLmhpZGVfbm9kZSh0W3JdLCEwKTtyZXR1cm4gdGhpcy5yZWRyYXcoKSwhMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290P3ZvaWQodC5zdGF0ZS5oaWRkZW58fCh0LnN0YXRlLmhpZGRlbj0hMCx0aGlzLl9ub2RlX2NoYW5nZWQodC5wYXJlbnQpLGl8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwiaGlkZV9ub2RlXCIse25vZGU6dH0pKSk6ITF9LHNob3dfbm9kZTpmdW5jdGlvbih0LGkpe3ZhciByLHM7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCkscj0wLHM9dC5sZW5ndGg7cz5yO3IrKyl0aGlzLnNob3dfbm9kZSh0W3JdLCEwKTtyZXR1cm4gdGhpcy5yZWRyYXcoKSwhMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290P3ZvaWQodC5zdGF0ZS5oaWRkZW4mJih0LnN0YXRlLmhpZGRlbj0hMSx0aGlzLl9ub2RlX2NoYW5nZWQodC5wYXJlbnQpLGl8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwic2hvd19ub2RlXCIse25vZGU6dH0pKSk6ITF9LGhpZGVfYWxsOmZ1bmN0aW9uKHQpe3ZhciBpLHI9dGhpcy5fbW9kZWwuZGF0YSxzPVtdO2ZvcihpIGluIHIpci5oYXNPd25Qcm9wZXJ0eShpKSYmaSE9PWUuanN0cmVlLnJvb3QmJiFyW2ldLnN0YXRlLmhpZGRlbiYmKHJbaV0uc3RhdGUuaGlkZGVuPSEwLHMucHVzaChpKSk7cmV0dXJuIHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSEwLHR8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwiaGlkZV9hbGxcIix7bm9kZXM6c30pLHN9LHNob3dfYWxsOmZ1bmN0aW9uKHQpe3ZhciBpLHI9dGhpcy5fbW9kZWwuZGF0YSxzPVtdO2ZvcihpIGluIHIpci5oYXNPd25Qcm9wZXJ0eShpKSYmaSE9PWUuanN0cmVlLnJvb3QmJnJbaV0uc3RhdGUuaGlkZGVuJiYocltpXS5zdGF0ZS5oaWRkZW49ITEscy5wdXNoKGkpKTtyZXR1cm4gdGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXc9ITAsdHx8dGhpcy5yZWRyYXcoKSx0aGlzLnRyaWdnZXIoXCJzaG93X2FsbFwiLHtub2RlczpzfSksc30sYWN0aXZhdGVfbm9kZTpmdW5jdGlvbihlLGkpe2lmKHRoaXMuaXNfZGlzYWJsZWQoZSkpcmV0dXJuITE7aWYoaSYmXCJvYmplY3RcIj09dHlwZW9mIGl8fChpPXt9KSx0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkPXRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQmJnRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQuaWQhPT10P3RoaXMuZ2V0X25vZGUodGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZC5pZCk6bnVsbCx0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkJiYhdGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZC5zdGF0ZS5zZWxlY3RlZCYmKHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQ9bnVsbCksIXRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQmJnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGgmJih0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkPXRoaXMuZ2V0X25vZGUodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGgtMV0pKSx0aGlzLnNldHRpbmdzLmNvcmUubXVsdGlwbGUmJihpLm1ldGFLZXl8fGkuY3RybEtleXx8aS5zaGlmdEtleSkmJighaS5zaGlmdEtleXx8dGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZCYmdGhpcy5nZXRfcGFyZW50KGUpJiZ0aGlzLmdldF9wYXJlbnQoZSk9PT10aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkLnBhcmVudCkpaWYoaS5zaGlmdEtleSl7dmFyIHIscyxuPXRoaXMuZ2V0X25vZGUoZSkuaWQsYT10aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkLmlkLG89dGhpcy5nZXRfbm9kZSh0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkLnBhcmVudCkuY2hpbGRyZW4sZD0hMTtmb3Iocj0wLHM9by5sZW5ndGg7cz5yO3IrPTEpb1tyXT09PW4mJihkPSFkKSxvW3JdPT09YSYmKGQ9IWQpLHRoaXMuaXNfZGlzYWJsZWQob1tyXSl8fCFkJiZvW3JdIT09biYmb1tyXSE9PWE/dGhpcy5kZXNlbGVjdF9ub2RlKG9bcl0sITAsaSk6dGhpcy5zZWxlY3Rfbm9kZShvW3JdLCEwLCExLGkpO3RoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwic2VsZWN0X25vZGVcIixub2RlOnRoaXMuZ2V0X25vZGUoZSksc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLGV2ZW50Oml9KX1lbHNlIHRoaXMuaXNfc2VsZWN0ZWQoZSk/dGhpcy5kZXNlbGVjdF9ub2RlKGUsITEsaSk6dGhpcy5zZWxlY3Rfbm9kZShlLCExLCExLGkpO2Vsc2UhdGhpcy5zZXR0aW5ncy5jb3JlLm11bHRpcGxlJiYoaS5tZXRhS2V5fHxpLmN0cmxLZXl8fGkuc2hpZnRLZXkpJiZ0aGlzLmlzX3NlbGVjdGVkKGUpP3RoaXMuZGVzZWxlY3Rfbm9kZShlLCExLGkpOih0aGlzLmRlc2VsZWN0X2FsbCghMCksdGhpcy5zZWxlY3Rfbm9kZShlLCExLCExLGkpLHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQ9dGhpcy5nZXRfbm9kZShlKSk7dGhpcy50cmlnZ2VyKFwiYWN0aXZhdGVfbm9kZVwiLHtub2RlOnRoaXMuZ2V0X25vZGUoZSksZXZlbnQ6aX0pfSxob3Zlcl9ub2RlOmZ1bmN0aW9uKGUpe2lmKGU9dGhpcy5nZXRfbm9kZShlLCEwKSwhZXx8IWUubGVuZ3RofHxlLmNoaWxkcmVuKFwiLmpzdHJlZS1ob3ZlcmVkXCIpLmxlbmd0aClyZXR1cm4hMTt2YXIgdD10aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtaG92ZXJlZFwiKSxpPXRoaXMuZWxlbWVudDt0JiZ0Lmxlbmd0aCYmdGhpcy5kZWhvdmVyX25vZGUodCksZS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKFwianN0cmVlLWhvdmVyZWRcIiksdGhpcy50cmlnZ2VyKFwiaG92ZXJfbm9kZVwiLHtub2RlOnRoaXMuZ2V0X25vZGUoZSl9KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aS5hdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsZVswXS5pZCl9LDApfSxkZWhvdmVyX25vZGU6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9dGhpcy5nZXRfbm9kZShlLCEwKSxlJiZlLmxlbmd0aCYmZS5jaGlsZHJlbihcIi5qc3RyZWUtaG92ZXJlZFwiKS5sZW5ndGg/KGUuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1ob3ZlcmVkXCIpLHZvaWQgdGhpcy50cmlnZ2VyKFwiZGVob3Zlcl9ub2RlXCIse25vZGU6dGhpcy5nZXRfbm9kZShlKX0pKTohMX0sc2VsZWN0X25vZGU6ZnVuY3Rpb24odCxpLHIscyl7dmFyIG4sYSxvO2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLGE9MCxvPXQubGVuZ3RoO28+YTthKyspdGhpcy5zZWxlY3Rfbm9kZSh0W2FdLGkscixzKTtyZXR1cm4hMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290PyhuPXRoaXMuZ2V0X25vZGUodCwhMCksdm9pZCh0LnN0YXRlLnNlbGVjdGVkfHwodC5zdGF0ZS5zZWxlY3RlZD0hMCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQucHVzaCh0LmlkKSxyfHwobj10aGlzLl9vcGVuX3RvKHQpKSxuJiZuLmxlbmd0aCYmbi5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKFwianN0cmVlLWNsaWNrZWRcIiksdGhpcy50cmlnZ2VyKFwic2VsZWN0X25vZGVcIix7bm9kZTp0LHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpzfSksaXx8dGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJzZWxlY3Rfbm9kZVwiLG5vZGU6dCxzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQsZXZlbnQ6c30pKSkpOiExfSxkZXNlbGVjdF9ub2RlOmZ1bmN0aW9uKHQsaSxyKXt2YXIgcyxuLGE7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCkscz0wLG49dC5sZW5ndGg7bj5zO3MrKyl0aGlzLmRlc2VsZWN0X25vZGUodFtzXSxpLHIpO3JldHVybiEwfXJldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/KGE9dGhpcy5nZXRfbm9kZSh0LCEwKSx2b2lkKHQuc3RhdGUuc2VsZWN0ZWQmJih0LnN0YXRlLnNlbGVjdGVkPSExLHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD1lLnZha2F0YS5hcnJheV9yZW1vdmVfaXRlbSh0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQsdC5pZCksYS5sZW5ndGgmJmEuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jbGlja2VkXCIpLHRoaXMudHJpZ2dlcihcImRlc2VsZWN0X25vZGVcIix7bm9kZTp0LHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpyfSksaXx8dGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJkZXNlbGVjdF9ub2RlXCIsbm9kZTp0LHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpyfSkpKSk6ITF9LHNlbGVjdF9hbGw6ZnVuY3Rpb24odCl7dmFyIGkscixzPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5jb25jYXQoW10pO2Zvcih0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQ9dGhpcy5fbW9kZWwuZGF0YVtlLmpzdHJlZS5yb290XS5jaGlsZHJlbl9kLmNvbmNhdCgpLGk9MCxyPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGg7cj5pO2krKyl0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFtpXV0mJih0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFtpXV0uc3RhdGUuc2VsZWN0ZWQ9ITApO3RoaXMucmVkcmF3KCEwKSx0aGlzLnRyaWdnZXIoXCJzZWxlY3RfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZH0pLHR8fHRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwic2VsZWN0X2FsbFwiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxvbGRfc2VsZWN0aW9uOnN9KX0sZGVzZWxlY3RfYWxsOmZ1bmN0aW9uKGUpe3ZhciB0LGkscj10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuY29uY2F0KFtdKTtmb3IodD0wLGk9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmxlbmd0aDtpPnQ7dCsrKXRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW3RdXSYmKHRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW3RdXS5zdGF0ZS5zZWxlY3RlZD0hMSk7dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkPVtdLHRoaXMuZWxlbWVudC5maW5kKFwiLmpzdHJlZS1jbGlja2VkXCIpLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsaWNrZWRcIikucGFyZW50KCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSksdGhpcy50cmlnZ2VyKFwiZGVzZWxlY3RfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxub2RlOnJ9KSxlfHx0aGlzLnRyaWdnZXIoXCJjaGFuZ2VkXCIse2FjdGlvbjpcImRlc2VsZWN0X2FsbFwiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxvbGRfc2VsZWN0aW9uOnJ9KX0saXNfc2VsZWN0ZWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy5nZXRfbm9kZSh0KSx0JiZ0LmlkIT09ZS5qc3RyZWUucm9vdD90LnN0YXRlLnNlbGVjdGVkOiExfSxnZXRfc2VsZWN0ZWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQ/ZS5tYXAodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLGUucHJveHkoZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0X25vZGUoZSl9LHRoaXMpKTp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuc2xpY2UoKX0sZ2V0X3RvcF9zZWxlY3RlZDpmdW5jdGlvbih0KXt2YXIgaSxyLHMsbixhPXRoaXMuZ2V0X3NlbGVjdGVkKCEwKSxvPXt9O2ZvcihpPTAscj1hLmxlbmd0aDtyPmk7aSsrKW9bYVtpXS5pZF09YVtpXTtmb3IoaT0wLHI9YS5sZW5ndGg7cj5pO2krKylmb3Iocz0wLG49YVtpXS5jaGlsZHJlbl9kLmxlbmd0aDtuPnM7cysrKW9bYVtpXS5jaGlsZHJlbl9kW3NdXSYmZGVsZXRlIG9bYVtpXS5jaGlsZHJlbl9kW3NdXTthPVtdO2ZvcihpIGluIG8pby5oYXNPd25Qcm9wZXJ0eShpKSYmYS5wdXNoKGkpO3JldHVybiB0P2UubWFwKGEsZS5wcm94eShmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRfbm9kZShlKX0sdGhpcykpOmF9LGdldF9ib3R0b21fc2VsZWN0ZWQ6ZnVuY3Rpb24odCl7dmFyIGkscixzPXRoaXMuZ2V0X3NlbGVjdGVkKCEwKSxuPVtdO2ZvcihpPTAscj1zLmxlbmd0aDtyPmk7aSsrKXNbaV0uY2hpbGRyZW4ubGVuZ3RofHxuLnB1c2goc1tpXS5pZCk7cmV0dXJuIHQ/ZS5tYXAobixlLnByb3h5KGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldF9ub2RlKGUpfSx0aGlzKSk6bn0sZ2V0X3N0YXRlOmZ1bmN0aW9uKCl7dmFyIHQsaT17Y29yZTp7b3BlbjpbXSxzY3JvbGw6e2xlZnQ6dGhpcy5lbGVtZW50LnNjcm9sbExlZnQoKSx0b3A6dGhpcy5lbGVtZW50LnNjcm9sbFRvcCgpfSxzZWxlY3RlZDpbXX19O2Zvcih0IGluIHRoaXMuX21vZGVsLmRhdGEpdGhpcy5fbW9kZWwuZGF0YS5oYXNPd25Qcm9wZXJ0eSh0KSYmdCE9PWUuanN0cmVlLnJvb3QmJih0aGlzLl9tb2RlbC5kYXRhW3RdLnN0YXRlLm9wZW5lZCYmaS5jb3JlLm9wZW4ucHVzaCh0KSx0aGlzLl9tb2RlbC5kYXRhW3RdLnN0YXRlLnNlbGVjdGVkJiZpLmNvcmUuc2VsZWN0ZWQucHVzaCh0KSk7cmV0dXJuIGl9LHNldF9zdGF0ZTpmdW5jdGlvbihpLHIpe2lmKGkpe2lmKGkuY29yZSl7dmFyIHMsbjtpZihpLmNvcmUub3BlbilyZXR1cm4gZS5pc0FycmF5KGkuY29yZS5vcGVuKSYmaS5jb3JlLm9wZW4ubGVuZ3RoP3RoaXMuX2xvYWRfbm9kZXMoaS5jb3JlLm9wZW4sZnVuY3Rpb24oZSl7dGhpcy5vcGVuX25vZGUoZSwhMSwwKSxkZWxldGUgaS5jb3JlLm9wZW4sdGhpcy5zZXRfc3RhdGUoaSxyKX0sITApOihkZWxldGUgaS5jb3JlLm9wZW4sdGhpcy5zZXRfc3RhdGUoaSxyKSksITE7aWYoaS5jb3JlLnNjcm9sbClyZXR1cm4gaS5jb3JlLnNjcm9sbCYmaS5jb3JlLnNjcm9sbC5sZWZ0IT09dCYmdGhpcy5lbGVtZW50LnNjcm9sbExlZnQoaS5jb3JlLnNjcm9sbC5sZWZ0KSxpLmNvcmUuc2Nyb2xsJiZpLmNvcmUuc2Nyb2xsLnRvcCE9PXQmJnRoaXMuZWxlbWVudC5zY3JvbGxUb3AoaS5jb3JlLnNjcm9sbC50b3ApLGRlbGV0ZSBpLmNvcmUuc2Nyb2xsLHRoaXMuc2V0X3N0YXRlKGksciksITE7aWYoaS5jb3JlLnNlbGVjdGVkKXJldHVybiBzPXRoaXMsdGhpcy5kZXNlbGVjdF9hbGwoKSxlLmVhY2goaS5jb3JlLnNlbGVjdGVkLGZ1bmN0aW9uKGUsdCl7cy5zZWxlY3Rfbm9kZSh0LCExLCEwKX0pLGRlbGV0ZSBpLmNvcmUuc2VsZWN0ZWQsdGhpcy5zZXRfc3RhdGUoaSxyKSwhMTtmb3IobiBpbiBpKWkuaGFzT3duUHJvcGVydHkobikmJlwiY29yZVwiIT09biYmLTE9PT1lLmluQXJyYXkobix0aGlzLnNldHRpbmdzLnBsdWdpbnMpJiZkZWxldGUgaVtuXTtpZihlLmlzRW1wdHlPYmplY3QoaS5jb3JlKSlyZXR1cm4gZGVsZXRlIGkuY29yZSx0aGlzLnNldF9zdGF0ZShpLHIpLCExfXJldHVybiBlLmlzRW1wdHlPYmplY3QoaSk/KGk9bnVsbCxyJiZyLmNhbGwodGhpcyksdGhpcy50cmlnZ2VyKFwic2V0X3N0YXRlXCIpLCExKTohMH1yZXR1cm4hMX0scmVmcmVzaDpmdW5jdGlvbih0LGkpe3RoaXMuX2RhdGEuY29yZS5zdGF0ZT1pPT09ITA/e306dGhpcy5nZXRfc3RhdGUoKSxpJiZlLmlzRnVuY3Rpb24oaSkmJih0aGlzLl9kYXRhLmNvcmUuc3RhdGU9aS5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLnN0YXRlKSksdGhpcy5fY250PTAsdGhpcy5fbW9kZWwuZGF0YT17fSx0aGlzLl9tb2RlbC5kYXRhW2UuanN0cmVlLnJvb3RdPXtpZDplLmpzdHJlZS5yb290LHBhcmVudDpudWxsLHBhcmVudHM6W10sY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxzdGF0ZTp7bG9hZGVkOiExfX0sdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkPVtdLHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQ9bnVsbCx0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1udWxsO3ZhciByPXRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpWzBdLmNsYXNzTmFtZTt0fHwodGhpcy5lbGVtZW50Lmh0bWwoXCI8dWwgY2xhc3M9J1wiK3IrXCInIHJvbGU9J2dyb3VwJz48bGkgY2xhc3M9J2pzdHJlZS1pbml0aWFsLW5vZGUganN0cmVlLWxvYWRpbmcganN0cmVlLWxlYWYganN0cmVlLWxhc3QnIHJvbGU9J3RyZWVpdGVtJyBpZD0nalwiK3RoaXMuX2lkK1wiX2xvYWRpbmcnPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtb2NsJz48L2k+PGEgY2xhc3M9J2pzdHJlZS1hbmNob3InIGhyZWY9JyMnPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtdGhlbWVpY29uLWhpZGRlbic+PC9pPlwiK3RoaXMuZ2V0X3N0cmluZyhcIkxvYWRpbmcgLi4uXCIpK1wiPC9hPjwvbGk+PC91bD5cIiksdGhpcy5lbGVtZW50LmF0dHIoXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIixcImpcIit0aGlzLl9pZCtcIl9sb2FkaW5nXCIpKSx0aGlzLmxvYWRfbm9kZShlLmpzdHJlZS5yb290LGZ1bmN0aW9uKHQsaSl7aSYmKHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpWzBdLmNsYXNzTmFtZT1yLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pJiZ0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pLmlkKSx0aGlzLnNldF9zdGF0ZShlLmV4dGVuZCghMCx7fSx0aGlzLl9kYXRhLmNvcmUuc3RhdGUpLGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKFwicmVmcmVzaFwiKX0pKSx0aGlzLl9kYXRhLmNvcmUuc3RhdGU9bnVsbH0pfSxyZWZyZXNoX25vZGU6ZnVuY3Rpb24odCl7aWYodD10aGlzLmdldF9ub2RlKHQpLCF0fHx0LmlkPT09ZS5qc3RyZWUucm9vdClyZXR1cm4hMTt2YXIgaT1bXSxyPVtdO3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5jb25jYXQoW10pO3IucHVzaCh0LmlkKSx0LnN0YXRlLm9wZW5lZD09PSEwJiZpLnB1c2godC5pZCksdGhpcy5nZXRfbm9kZSh0LCEwKS5maW5kKFwiLmpzdHJlZS1vcGVuXCIpLmVhY2goZnVuY3Rpb24oKXtpLnB1c2godGhpcy5pZCl9KSx0aGlzLl9sb2FkX25vZGVzKHIsZS5wcm94eShmdW5jdGlvbihlKXt0aGlzLm9wZW5fbm9kZShpLCExLDApLHRoaXMuc2VsZWN0X25vZGUodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkKSx0aGlzLnRyaWdnZXIoXCJyZWZyZXNoX25vZGVcIix7bm9kZTp0LG5vZGVzOmV9KX0sdGhpcykpfSxzZXRfaWQ6ZnVuY3Rpb24odCxpKXtpZih0PXRoaXMuZ2V0X25vZGUodCksIXR8fHQuaWQ9PT1lLmpzdHJlZS5yb290KXJldHVybiExO3ZhciByLHMsbj10aGlzLl9tb2RlbC5kYXRhO2ZvcihpPWkudG9TdHJpbmcoKSxuW3QucGFyZW50XS5jaGlsZHJlbltlLmluQXJyYXkodC5pZCxuW3QucGFyZW50XS5jaGlsZHJlbildPWkscj0wLHM9dC5wYXJlbnRzLmxlbmd0aDtzPnI7cisrKW5bdC5wYXJlbnRzW3JdXS5jaGlsZHJlbl9kW2UuaW5BcnJheSh0LmlkLG5bdC5wYXJlbnRzW3JdXS5jaGlsZHJlbl9kKV09aTtmb3Iocj0wLHM9dC5jaGlsZHJlbi5sZW5ndGg7cz5yO3IrKyluW3QuY2hpbGRyZW5bcl1dLnBhcmVudD1pO2ZvcihyPTAscz10LmNoaWxkcmVuX2QubGVuZ3RoO3M+cjtyKyspblt0LmNoaWxkcmVuX2Rbcl1dLnBhcmVudHNbZS5pbkFycmF5KHQuaWQsblt0LmNoaWxkcmVuX2Rbcl1dLnBhcmVudHMpXT1pO3JldHVybiByPWUuaW5BcnJheSh0LmlkLHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCksLTEhPT1yJiYodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW3JdPWkpLHI9dGhpcy5nZXRfbm9kZSh0LmlkLCEwKSxyJiYoci5hdHRyKFwiaWRcIixpKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmF0dHIoXCJpZFwiLGkrXCJfYW5jaG9yXCIpLmVuZCgpLmF0dHIoXCJhcmlhLWxhYmVsbGVkYnlcIixpK1wiX2FuY2hvclwiKSx0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiKT09PXQuaWQmJnRoaXMuZWxlbWVudC5hdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIsaSkpLGRlbGV0ZSBuW3QuaWRdLHQuaWQ9aSx0LmxpX2F0dHIuaWQ9aSxuW2ldPXQsITB9LGdldF90ZXh0OmZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/dC50ZXh0OiExfSxzZXRfdGV4dDpmdW5jdGlvbih0LGkpe3ZhciByLHM7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCkscj0wLHM9dC5sZW5ndGg7cz5yO3IrKyl0aGlzLnNldF90ZXh0KHRbcl0saSk7cmV0dXJuITB9cmV0dXJuIHQ9dGhpcy5nZXRfbm9kZSh0KSx0JiZ0LmlkIT09ZS5qc3RyZWUucm9vdD8odC50ZXh0PWksdGhpcy5nZXRfbm9kZSh0LCEwKS5sZW5ndGgmJnRoaXMucmVkcmF3X25vZGUodC5pZCksdGhpcy50cmlnZ2VyKFwic2V0X3RleHRcIix7b2JqOnQsdGV4dDppfSksITApOiExfSxnZXRfanNvbjpmdW5jdGlvbih0LGkscil7aWYodD10aGlzLmdldF9ub2RlKHR8fGUuanN0cmVlLnJvb3QpLCF0KXJldHVybiExO2kmJmkuZmxhdCYmIXImJihyPVtdKTt2YXIgcyxuLGE9e2lkOnQuaWQsdGV4dDp0LnRleHQsaWNvbjp0aGlzLmdldF9pY29uKHQpLGxpX2F0dHI6ZS5leHRlbmQoITAse30sdC5saV9hdHRyKSxhX2F0dHI6ZS5leHRlbmQoITAse30sdC5hX2F0dHIpLHN0YXRlOnt9LGRhdGE6aSYmaS5ub19kYXRhPyExOmUuZXh0ZW5kKCEwLHt9LHQuZGF0YSl9O2lmKGkmJmkuZmxhdD9hLnBhcmVudD10LnBhcmVudDphLmNoaWxkcmVuPVtdLCFpfHwhaS5ub19zdGF0ZSlmb3IocyBpbiB0LnN0YXRlKXQuc3RhdGUuaGFzT3duUHJvcGVydHkocykmJihhLnN0YXRlW3NdPXQuc3RhdGVbc10pO2lmKGkmJmkubm9faWQmJihkZWxldGUgYS5pZCxhLmxpX2F0dHImJmEubGlfYXR0ci5pZCYmZGVsZXRlIGEubGlfYXR0ci5pZCxhLmFfYXR0ciYmYS5hX2F0dHIuaWQmJmRlbGV0ZSBhLmFfYXR0ci5pZCksaSYmaS5mbGF0JiZ0LmlkIT09ZS5qc3RyZWUucm9vdCYmci5wdXNoKGEpLCFpfHwhaS5ub19jaGlsZHJlbilmb3Iocz0wLG49dC5jaGlsZHJlbi5sZW5ndGg7bj5zO3MrKylpJiZpLmZsYXQ/dGhpcy5nZXRfanNvbih0LmNoaWxkcmVuW3NdLGkscik6YS5jaGlsZHJlbi5wdXNoKHRoaXMuZ2V0X2pzb24odC5jaGlsZHJlbltzXSxpKSk7cmV0dXJuIGkmJmkuZmxhdD9yOnQuaWQ9PT1lLmpzdHJlZS5yb290P2EuY2hpbGRyZW46YX0sY3JlYXRlX25vZGU6ZnVuY3Rpb24oaSxyLHMsbixhKXtpZihudWxsPT09aSYmKGk9ZS5qc3RyZWUucm9vdCksaT10aGlzLmdldF9ub2RlKGkpLCFpKXJldHVybiExO2lmKHM9cz09PXQ/XCJsYXN0XCI6cywhcy50b1N0cmluZygpLm1hdGNoKC9eKGJlZm9yZXxhZnRlcikkLykmJiFhJiYhdGhpcy5pc19sb2FkZWQoaSkpcmV0dXJuIHRoaXMubG9hZF9ub2RlKGksZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZV9ub2RlKGkscixzLG4sITApfSk7cnx8KHI9e3RleHQ6dGhpcy5nZXRfc3RyaW5nKFwiTmV3IG5vZGVcIil9KSxcInN0cmluZ1wiPT10eXBlb2YgciYmKHI9e3RleHQ6cn0pLHIudGV4dD09PXQmJihyLnRleHQ9dGhpcy5nZXRfc3RyaW5nKFwiTmV3IG5vZGVcIikpO3ZhciBvLGQsYyxsO3N3aXRjaChpLmlkPT09ZS5qc3RyZWUucm9vdCYmKFwiYmVmb3JlXCI9PT1zJiYocz1cImZpcnN0XCIpLFwiYWZ0ZXJcIj09PXMmJihzPVwibGFzdFwiKSkscyl7Y2FzZVwiYmVmb3JlXCI6bz10aGlzLmdldF9ub2RlKGkucGFyZW50KSxzPWUuaW5BcnJheShpLmlkLG8uY2hpbGRyZW4pLGk9bzticmVhaztjYXNlXCJhZnRlclwiOm89dGhpcy5nZXRfbm9kZShpLnBhcmVudCkscz1lLmluQXJyYXkoaS5pZCxvLmNoaWxkcmVuKSsxLGk9bzticmVhaztjYXNlXCJpbnNpZGVcIjpjYXNlXCJmaXJzdFwiOnM9MDticmVhaztjYXNlXCJsYXN0XCI6cz1pLmNoaWxkcmVuLmxlbmd0aDticmVhaztkZWZhdWx0OnN8fChzPTApfWlmKHM+aS5jaGlsZHJlbi5sZW5ndGgmJihzPWkuY2hpbGRyZW4ubGVuZ3RoKSxyLmlkfHwoci5pZD0hMCksIXRoaXMuY2hlY2soXCJjcmVhdGVfbm9kZVwiLHIsaSxzKSlyZXR1cm4gdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksITE7aWYoci5pZD09PSEwJiZkZWxldGUgci5pZCxyPXRoaXMuX3BhcnNlX21vZGVsX2Zyb21fanNvbihyLGkuaWQsaS5wYXJlbnRzLmNvbmNhdCgpKSwhcilyZXR1cm4hMTtmb3Iobz10aGlzLmdldF9ub2RlKHIpLGQ9W10sZC5wdXNoKHIpLGQ9ZC5jb25jYXQoby5jaGlsZHJlbl9kKSx0aGlzLnRyaWdnZXIoXCJtb2RlbFwiLHtub2RlczpkLHBhcmVudDppLmlkfSksaS5jaGlsZHJlbl9kPWkuY2hpbGRyZW5fZC5jb25jYXQoZCksYz0wLGw9aS5wYXJlbnRzLmxlbmd0aDtsPmM7YysrKXRoaXMuX21vZGVsLmRhdGFbaS5wYXJlbnRzW2NdXS5jaGlsZHJlbl9kPXRoaXMuX21vZGVsLmRhdGFbaS5wYXJlbnRzW2NdXS5jaGlsZHJlbl9kLmNvbmNhdChkKTtmb3Iocj1vLG89W10sYz0wLGw9aS5jaGlsZHJlbi5sZW5ndGg7bD5jO2MrKylvW2M+PXM/YysxOmNdPWkuY2hpbGRyZW5bY107cmV0dXJuIG9bc109ci5pZCxpLmNoaWxkcmVuPW8sdGhpcy5yZWRyYXdfbm9kZShpLCEwKSxuJiZuLmNhbGwodGhpcyx0aGlzLmdldF9ub2RlKHIpKSx0aGlzLnRyaWdnZXIoXCJjcmVhdGVfbm9kZVwiLHtub2RlOnRoaXMuZ2V0X25vZGUocikscGFyZW50OmkuaWQscG9zaXRpb246c30pLHIuaWR9LHJlbmFtZV9ub2RlOmZ1bmN0aW9uKHQsaSl7dmFyIHIscyxuO2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLHI9MCxzPXQubGVuZ3RoO3M+cjtyKyspdGhpcy5yZW5hbWVfbm9kZSh0W3JdLGkpO3JldHVybiEwfXJldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/KG49dC50ZXh0LHRoaXMuY2hlY2soXCJyZW5hbWVfbm9kZVwiLHQsdGhpcy5nZXRfcGFyZW50KHQpLGkpPyh0aGlzLnNldF90ZXh0KHQsaSksdGhpcy50cmlnZ2VyKFwicmVuYW1lX25vZGVcIix7bm9kZTp0LHRleHQ6aSxvbGQ6bn0pLCEwKToodGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksITEpKTohMX0sZGVsZXRlX25vZGU6ZnVuY3Rpb24odCl7dmFyIGkscixzLG4sYSxvLGQsYyxsLGgsXyx1O2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLGk9MCxyPXQubGVuZ3RoO3I+aTtpKyspdGhpcy5kZWxldGVfbm9kZSh0W2ldKTtyZXR1cm4hMH1pZih0PXRoaXMuZ2V0X25vZGUodCksIXR8fHQuaWQ9PT1lLmpzdHJlZS5yb290KXJldHVybiExO2lmKHM9dGhpcy5nZXRfbm9kZSh0LnBhcmVudCksbj1lLmluQXJyYXkodC5pZCxzLmNoaWxkcmVuKSxoPSExLCF0aGlzLmNoZWNrKFwiZGVsZXRlX25vZGVcIix0LHMsbikpcmV0dXJuIHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLCExO2ZvcigtMSE9PW4mJihzLmNoaWxkcmVuPWUudmFrYXRhLmFycmF5X3JlbW92ZShzLmNoaWxkcmVuLG4pKSxhPXQuY2hpbGRyZW5fZC5jb25jYXQoW10pLGEucHVzaCh0LmlkKSxjPTAsbD1hLmxlbmd0aDtsPmM7YysrKXtmb3Iobz0wLGQ9dC5wYXJlbnRzLmxlbmd0aDtkPm87bysrKW49ZS5pbkFycmF5KGFbY10sdGhpcy5fbW9kZWwuZGF0YVt0LnBhcmVudHNbb11dLmNoaWxkcmVuX2QpLC0xIT09biYmKHRoaXMuX21vZGVsLmRhdGFbdC5wYXJlbnRzW29dXS5jaGlsZHJlbl9kPWUudmFrYXRhLmFycmF5X3JlbW92ZSh0aGlzLl9tb2RlbC5kYXRhW3QucGFyZW50c1tvXV0uY2hpbGRyZW5fZCxuKSk7dGhpcy5fbW9kZWwuZGF0YVthW2NdXS5zdGF0ZS5zZWxlY3RlZCYmKGg9ITAsbj1lLmluQXJyYXkoYVtjXSx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQpLC0xIT09biYmKHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD1lLnZha2F0YS5hcnJheV9yZW1vdmUodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLG4pKSl9Zm9yKHRoaXMudHJpZ2dlcihcImRlbGV0ZV9ub2RlXCIse25vZGU6dCxwYXJlbnQ6cy5pZH0pLGgmJnRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwiZGVsZXRlX25vZGVcIixub2RlOnQsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLHBhcmVudDpzLmlkfSksYz0wLGw9YS5sZW5ndGg7bD5jO2MrKylkZWxldGUgdGhpcy5fbW9kZWwuZGF0YVthW2NdXTtyZXR1cm4tMSE9PWUuaW5BcnJheSh0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZCxhKSYmKHRoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW51bGwsXz10aGlzLmVsZW1lbnRbMF0uc2Nyb2xsVG9wLHU9dGhpcy5lbGVtZW50WzBdLnNjcm9sbExlZnQscy5pZD09PWUuanN0cmVlLnJvb3Q/dGhpcy5nZXRfbm9kZSh0aGlzLl9tb2RlbC5kYXRhW2UuanN0cmVlLnJvb3RdLmNoaWxkcmVuWzBdLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCk6dGhpcy5nZXRfbm9kZShzLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCksdGhpcy5lbGVtZW50WzBdLnNjcm9sbFRvcD1fLHRoaXMuZWxlbWVudFswXS5zY3JvbGxMZWZ0PXUpLHRoaXMucmVkcmF3X25vZGUocywhMCksITB9LGNoZWNrOmZ1bmN0aW9uKHQsaSxyLHMsbil7aT1pJiZpLmlkP2k6dGhpcy5nZXRfbm9kZShpKSxyPXImJnIuaWQ/cjp0aGlzLmdldF9ub2RlKHIpO3ZhciBhPXQubWF0Y2goL15tb3ZlX25vZGV8Y29weV9ub2RlfGNyZWF0ZV9ub2RlJC9pKT9yOmksbz10aGlzLnNldHRpbmdzLmNvcmUuY2hlY2tfY2FsbGJhY2s7cmV0dXJuXCJtb3ZlX25vZGVcIiE9PXQmJlwiY29weV9ub2RlXCIhPT10fHxuJiZuLmlzX211bHRpfHwoaS5pZCE9PXIuaWR8fFwiY29weV9ub2RlXCI9PT10KSYmZS5pbkFycmF5KGkuaWQsci5jaGlsZHJlbikhPT1zJiYtMT09PWUuaW5BcnJheShyLmlkLGkuY2hpbGRyZW5fZCk/KGEmJmEuZGF0YSYmKGE9YS5kYXRhKSxhJiZhLmZ1bmN0aW9ucyYmKGEuZnVuY3Rpb25zW3RdPT09ITF8fGEuZnVuY3Rpb25zW3RdPT09ITApPyhhLmZ1bmN0aW9uc1t0XT09PSExJiYodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzAyXCIscmVhc29uOlwiTm9kZSBkYXRhIHByZXZlbnRzIGZ1bmN0aW9uOiBcIit0LGRhdGE6SlNPTi5zdHJpbmdpZnkoe2Noazp0LHBvczpzLG9iajppJiZpLmlkP2kuaWQ6ITEscGFyOnImJnIuaWQ/ci5pZDohMX0pfSksYS5mdW5jdGlvbnNbdF0pOm89PT0hMXx8ZS5pc0Z1bmN0aW9uKG8pJiZvLmNhbGwodGhpcyx0LGkscixzLG4pPT09ITF8fG8mJm9bdF09PT0hMT8odGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzAzXCIscmVhc29uOlwiVXNlciBjb25maWcgZm9yIGNvcmUuY2hlY2tfY2FsbGJhY2sgcHJldmVudHMgZnVuY3Rpb246IFwiK3QsZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOnQscG9zOnMsb2JqOmkmJmkuaWQ/aS5pZDohMSxwYXI6ciYmci5pZD9yLmlkOiExfSl9LCExKTohMCk6KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwiY29yZVwiLGlkOlwiY29yZV8wMVwiLHJlYXNvbjpcIk1vdmluZyBwYXJlbnQgaW5zaWRlIGNoaWxkXCIsZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOnQscG9zOnMsb2JqOmkmJmkuaWQ/aS5pZDohMSxwYXI6ciYmci5pZD9yLmlkOiExfSl9LCExKX0sbGFzdF9lcnJvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcn0sbW92ZV9ub2RlOmZ1bmN0aW9uKGkscixzLG4sYSxvLGQpe3ZhciBjLGwsaCxfLHUsZyxmLHAsbSx2LGoseSxrLHg7aWYocj10aGlzLmdldF9ub2RlKHIpLHM9cz09PXQ/MDpzLCFyKXJldHVybiExO2lmKCFzLnRvU3RyaW5nKCkubWF0Y2goL14oYmVmb3JlfGFmdGVyKSQvKSYmIWEmJiF0aGlzLmlzX2xvYWRlZChyKSlyZXR1cm4gdGhpcy5sb2FkX25vZGUocixmdW5jdGlvbigpe3RoaXMubW92ZV9ub2RlKGkscixzLG4sITAsITEsZCl9KTtpZihlLmlzQXJyYXkoaSkpe2lmKDEhPT1pLmxlbmd0aCl7Zm9yKGM9MCxsPWkubGVuZ3RoO2w+YztjKyspKG09dGhpcy5tb3ZlX25vZGUoaVtjXSxyLHMsbixhLCExLGQpKSYmKHI9bSxzPVwiYWZ0ZXJcIik7cmV0dXJuIHRoaXMucmVkcmF3KCksITB9aT1pWzBdfWlmKGk9aSYmaS5pZD9pOnRoaXMuZ2V0X25vZGUoaSksIWl8fGkuaWQ9PT1lLmpzdHJlZS5yb290KXJldHVybiExO2lmKGg9KGkucGFyZW50fHxlLmpzdHJlZS5yb290KS50b1N0cmluZygpLHU9cy50b1N0cmluZygpLm1hdGNoKC9eKGJlZm9yZXxhZnRlcikkLykmJnIuaWQhPT1lLmpzdHJlZS5yb290P3RoaXMuZ2V0X25vZGUoci5wYXJlbnQpOnIsZz1kP2Q6dGhpcy5fbW9kZWwuZGF0YVtpLmlkXT90aGlzOmUuanN0cmVlLnJlZmVyZW5jZShpLmlkKSxmPSFnfHwhZy5faWR8fHRoaXMuX2lkIT09Zy5faWQsXz1nJiZnLl9pZCYmaCYmZy5fbW9kZWwuZGF0YVtoXSYmZy5fbW9kZWwuZGF0YVtoXS5jaGlsZHJlbj9lLmluQXJyYXkoaS5pZCxnLl9tb2RlbC5kYXRhW2hdLmNoaWxkcmVuKTotMSxnJiZnLl9pZCYmKGk9Zy5fbW9kZWwuZGF0YVtpLmlkXSksZilyZXR1cm4obT10aGlzLmNvcHlfbm9kZShpLHIscyxuLGEsITEsZCkpPyhnJiZnLmRlbGV0ZV9ub2RlKGkpLG0pOiExO3N3aXRjaChyLmlkPT09ZS5qc3RyZWUucm9vdCYmKFwiYmVmb3JlXCI9PT1zJiYocz1cImZpcnN0XCIpLFwiYWZ0ZXJcIj09PXMmJihzPVwibGFzdFwiKSkscyl7Y2FzZVwiYmVmb3JlXCI6cz1lLmluQXJyYXkoci5pZCx1LmNoaWxkcmVuKTticmVhaztjYXNlXCJhZnRlclwiOnM9ZS5pbkFycmF5KHIuaWQsdS5jaGlsZHJlbikrMTticmVhaztjYXNlXCJpbnNpZGVcIjpjYXNlXCJmaXJzdFwiOnM9MDticmVhaztjYXNlXCJsYXN0XCI6cz11LmNoaWxkcmVuLmxlbmd0aDticmVhaztkZWZhdWx0OnN8fChzPTApfWlmKHM+dS5jaGlsZHJlbi5sZW5ndGgmJihzPXUuY2hpbGRyZW4ubGVuZ3RoKSwhdGhpcy5jaGVjayhcIm1vdmVfbm9kZVwiLGksdSxzLHtjb3JlOiEwLG9yaWdpbjpkLGlzX211bHRpOmcmJmcuX2lkJiZnLl9pZCE9PXRoaXMuX2lkLGlzX2ZvcmVpZ246IWd8fCFnLl9pZH0pKXJldHVybiB0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKSwhMTtpZihpLnBhcmVudD09PXUuaWQpe2ZvcihwPXUuY2hpbGRyZW4uY29uY2F0KCksbT1lLmluQXJyYXkoaS5pZCxwKSwtMSE9PW0mJihwPWUudmFrYXRhLmFycmF5X3JlbW92ZShwLG0pLHM+bSYmcy0tKSxtPVtdLHY9MCxqPXAubGVuZ3RoO2o+djt2KyspbVt2Pj1zP3YrMTp2XT1wW3ZdO21bc109aS5pZCx1LmNoaWxkcmVuPW0sdGhpcy5fbm9kZV9jaGFuZ2VkKHUuaWQpLHRoaXMucmVkcmF3KHUuaWQ9PT1lLmpzdHJlZS5yb290KX1lbHNle2ZvcihtPWkuY2hpbGRyZW5fZC5jb25jYXQoKSxtLnB1c2goaS5pZCksdj0wLGo9aS5wYXJlbnRzLmxlbmd0aDtqPnY7disrKXtmb3IocD1bXSx4PWcuX21vZGVsLmRhdGFbaS5wYXJlbnRzW3ZdXS5jaGlsZHJlbl9kLHk9MCxrPXgubGVuZ3RoO2s+eTt5KyspLTE9PT1lLmluQXJyYXkoeFt5XSxtKSYmcC5wdXNoKHhbeV0pO2cuX21vZGVsLmRhdGFbaS5wYXJlbnRzW3ZdXS5jaGlsZHJlbl9kPXB9Zm9yKGcuX21vZGVsLmRhdGFbaF0uY2hpbGRyZW49ZS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW0oZy5fbW9kZWwuZGF0YVtoXS5jaGlsZHJlbixpLmlkKSx2PTAsaj11LnBhcmVudHMubGVuZ3RoO2o+djt2KyspdGhpcy5fbW9kZWwuZGF0YVt1LnBhcmVudHNbdl1dLmNoaWxkcmVuX2Q9dGhpcy5fbW9kZWwuZGF0YVt1LnBhcmVudHNbdl1dLmNoaWxkcmVuX2QuY29uY2F0KG0pO2ZvcihwPVtdLHY9MCxqPXUuY2hpbGRyZW4ubGVuZ3RoO2o+djt2KyspcFt2Pj1zP3YrMTp2XT11LmNoaWxkcmVuW3ZdO2ZvcihwW3NdPWkuaWQsdS5jaGlsZHJlbj1wLHUuY2hpbGRyZW5fZC5wdXNoKGkuaWQpLHUuY2hpbGRyZW5fZD11LmNoaWxkcmVuX2QuY29uY2F0KGkuY2hpbGRyZW5fZCksaS5wYXJlbnQ9dS5pZCxtPXUucGFyZW50cy5jb25jYXQoKSxtLnVuc2hpZnQodS5pZCkseD1pLnBhcmVudHMubGVuZ3RoLGkucGFyZW50cz1tLG09bS5jb25jYXQoKSx2PTAsaj1pLmNoaWxkcmVuX2QubGVuZ3RoO2o+djt2KyspdGhpcy5fbW9kZWwuZGF0YVtpLmNoaWxkcmVuX2Rbdl1dLnBhcmVudHM9dGhpcy5fbW9kZWwuZGF0YVtpLmNoaWxkcmVuX2Rbdl1dLnBhcmVudHMuc2xpY2UoMCwtMSp4KSxBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSh0aGlzLl9tb2RlbC5kYXRhW2kuY2hpbGRyZW5fZFt2XV0ucGFyZW50cyxtKTsoaD09PWUuanN0cmVlLnJvb3R8fHUuaWQ9PT1lLmpzdHJlZS5yb290KSYmKHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSEwKSx0aGlzLl9tb2RlbC5mb3JjZV9mdWxsX3JlZHJhd3x8KHRoaXMuX25vZGVfY2hhbmdlZChoKSx0aGlzLl9ub2RlX2NoYW5nZWQodS5pZCkpLG98fHRoaXMucmVkcmF3KCl9cmV0dXJuIG4mJm4uY2FsbCh0aGlzLGksdSxzKSx0aGlzLnRyaWdnZXIoXCJtb3ZlX25vZGVcIix7bm9kZTppLHBhcmVudDp1LmlkLHBvc2l0aW9uOnMsb2xkX3BhcmVudDpoLG9sZF9wb3NpdGlvbjpfLGlzX211bHRpOmcmJmcuX2lkJiZnLl9pZCE9PXRoaXMuX2lkLGlzX2ZvcmVpZ246IWd8fCFnLl9pZCxvbGRfaW5zdGFuY2U6ZyxuZXdfaW5zdGFuY2U6dGhpc30pLGkuaWR9LGNvcHlfbm9kZTpmdW5jdGlvbihpLHIscyxuLGEsbyxkKXt2YXIgYyxsLGgsXyx1LGcsZixwLG0sdixqO2lmKHI9dGhpcy5nZXRfbm9kZShyKSxzPXM9PT10PzA6cywhcilyZXR1cm4hMTtpZighcy50b1N0cmluZygpLm1hdGNoKC9eKGJlZm9yZXxhZnRlcikkLykmJiFhJiYhdGhpcy5pc19sb2FkZWQocikpcmV0dXJuIHRoaXMubG9hZF9ub2RlKHIsZnVuY3Rpb24oKXt0aGlzLmNvcHlfbm9kZShpLHIscyxuLCEwLCExLGQpfSk7aWYoZS5pc0FycmF5KGkpKXtpZigxIT09aS5sZW5ndGgpe2ZvcihjPTAsbD1pLmxlbmd0aDtsPmM7YysrKShfPXRoaXMuY29weV9ub2RlKGlbY10scixzLG4sYSwhMCxkKSkmJihyPV8scz1cImFmdGVyXCIpO3JldHVybiB0aGlzLnJlZHJhdygpLCEwfWk9aVswXX1pZihpPWkmJmkuaWQ/aTp0aGlzLmdldF9ub2RlKGkpLCFpfHxpLmlkPT09ZS5qc3RyZWUucm9vdClyZXR1cm4hMTtzd2l0Y2gocD0oaS5wYXJlbnR8fGUuanN0cmVlLnJvb3QpLnRvU3RyaW5nKCksbT1zLnRvU3RyaW5nKCkubWF0Y2goL14oYmVmb3JlfGFmdGVyKSQvKSYmci5pZCE9PWUuanN0cmVlLnJvb3Q/dGhpcy5nZXRfbm9kZShyLnBhcmVudCk6cix2PWQ/ZDp0aGlzLl9tb2RlbC5kYXRhW2kuaWRdP3RoaXM6ZS5qc3RyZWUucmVmZXJlbmNlKGkuaWQpLGo9IXZ8fCF2Ll9pZHx8dGhpcy5faWQhPT12Ll9pZCx2JiZ2Ll9pZCYmKGk9di5fbW9kZWwuZGF0YVtpLmlkXSksci5pZD09PWUuanN0cmVlLnJvb3QmJihcImJlZm9yZVwiPT09cyYmKHM9XCJmaXJzdFwiKSxcImFmdGVyXCI9PT1zJiYocz1cImxhc3RcIikpLHMpe2Nhc2VcImJlZm9yZVwiOnM9ZS5pbkFycmF5KHIuaWQsbS5jaGlsZHJlbik7YnJlYWs7Y2FzZVwiYWZ0ZXJcIjpzPWUuaW5BcnJheShyLmlkLG0uY2hpbGRyZW4pKzE7YnJlYWs7Y2FzZVwiaW5zaWRlXCI6Y2FzZVwiZmlyc3RcIjpzPTA7YnJlYWs7Y2FzZVwibGFzdFwiOnM9bS5jaGlsZHJlbi5sZW5ndGg7YnJlYWs7ZGVmYXVsdDpzfHwocz0wKX1pZihzPm0uY2hpbGRyZW4ubGVuZ3RoJiYocz1tLmNoaWxkcmVuLmxlbmd0aCksIXRoaXMuY2hlY2soXCJjb3B5X25vZGVcIixpLG0scyx7Y29yZTohMCxvcmlnaW46ZCxpc19tdWx0aTp2JiZ2Ll9pZCYmdi5faWQhPT10aGlzLl9pZCxpc19mb3JlaWduOiF2fHwhdi5faWR9KSlyZXR1cm4gdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksITE7aWYoZj12P3YuZ2V0X2pzb24oaSx7bm9faWQ6ITAsbm9fZGF0YTohMCxub19zdGF0ZTohMH0pOmksIWYpcmV0dXJuITE7aWYoZi5pZD09PSEwJiZkZWxldGUgZi5pZCxmPXRoaXMuX3BhcnNlX21vZGVsX2Zyb21fanNvbihmLG0uaWQsbS5wYXJlbnRzLmNvbmNhdCgpKSwhZilyZXR1cm4hMTtmb3IoXz10aGlzLmdldF9ub2RlKGYpLGkmJmkuc3RhdGUmJmkuc3RhdGUubG9hZGVkPT09ITEmJihfLnN0YXRlLmxvYWRlZD0hMSksaD1bXSxoLnB1c2goZiksaD1oLmNvbmNhdChfLmNoaWxkcmVuX2QpLHRoaXMudHJpZ2dlcihcIm1vZGVsXCIse25vZGVzOmgscGFyZW50Om0uaWR9KSx1PTAsZz1tLnBhcmVudHMubGVuZ3RoO2c+dTt1KyspdGhpcy5fbW9kZWwuZGF0YVttLnBhcmVudHNbdV1dLmNoaWxkcmVuX2Q9dGhpcy5fbW9kZWwuZGF0YVttLnBhcmVudHNbdV1dLmNoaWxkcmVuX2QuY29uY2F0KGgpO2ZvcihoPVtdLHU9MCxnPW0uY2hpbGRyZW4ubGVuZ3RoO2c+dTt1KyspaFt1Pj1zP3UrMTp1XT1tLmNoaWxkcmVuW3VdO3JldHVybiBoW3NdPV8uaWQsbS5jaGlsZHJlbj1oLG0uY2hpbGRyZW5fZC5wdXNoKF8uaWQpLG0uY2hpbGRyZW5fZD1tLmNoaWxkcmVuX2QuY29uY2F0KF8uY2hpbGRyZW5fZCksbS5pZD09PWUuanN0cmVlLnJvb3QmJih0aGlzLl9tb2RlbC5mb3JjZV9mdWxsX3JlZHJhdz0hMCksdGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXd8fHRoaXMuX25vZGVfY2hhbmdlZChtLmlkKSxvfHx0aGlzLnJlZHJhdyhtLmlkPT09ZS5qc3RyZWUucm9vdCksbiYmbi5jYWxsKHRoaXMsXyxtLHMpLHRoaXMudHJpZ2dlcihcImNvcHlfbm9kZVwiLHtub2RlOl8sb3JpZ2luYWw6aSxwYXJlbnQ6bS5pZCxwb3NpdGlvbjpzLG9sZF9wYXJlbnQ6cCxvbGRfcG9zaXRpb246diYmdi5faWQmJnAmJnYuX21vZGVsLmRhdGFbcF0mJnYuX21vZGVsLmRhdGFbcF0uY2hpbGRyZW4/ZS5pbkFycmF5KGkuaWQsdi5fbW9kZWwuZGF0YVtwXS5jaGlsZHJlbik6LTEsaXNfbXVsdGk6diYmdi5faWQmJnYuX2lkIT09dGhpcy5faWQsaXNfZm9yZWlnbjohdnx8IXYuX2lkLG9sZF9pbnN0YW5jZTp2LG5ld19pbnN0YW5jZTp0aGlzfSksXy5pZH0sY3V0OmZ1bmN0aW9uKHQpe2lmKHR8fCh0PXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5jb25jYXQoKSksZS5pc0FycmF5KHQpfHwodD1bdF0pLCF0Lmxlbmd0aClyZXR1cm4hMTt2YXIgaSxyLHMsZD1bXTtmb3Iocj0wLHM9dC5sZW5ndGg7cz5yO3IrKylpPXRoaXMuZ2V0X25vZGUodFtyXSksaSYmaS5pZCYmaS5pZCE9PWUuanN0cmVlLnJvb3QmJmQucHVzaChpKTtyZXR1cm4gZC5sZW5ndGg/KG49ZCxvPXRoaXMsYT1cIm1vdmVfbm9kZVwiLHZvaWQgdGhpcy50cmlnZ2VyKFwiY3V0XCIse25vZGU6dH0pKTohMX0sY29weTpmdW5jdGlvbih0KXtpZih0fHwodD10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuY29uY2F0KCkpLGUuaXNBcnJheSh0KXx8KHQ9W3RdKSwhdC5sZW5ndGgpcmV0dXJuITE7dmFyIGkscixzLGQ9W107Zm9yKHI9MCxzPXQubGVuZ3RoO3M+cjtyKyspaT10aGlzLmdldF9ub2RlKHRbcl0pLGkmJmkuaWQmJmkuaWQhPT1lLmpzdHJlZS5yb290JiZkLnB1c2goaSk7cmV0dXJuIGQubGVuZ3RoPyhuPWQsbz10aGlzLGE9XCJjb3B5X25vZGVcIix2b2lkIHRoaXMudHJpZ2dlcihcImNvcHlcIix7bm9kZTp0fSkpOiExfSxnZXRfYnVmZmVyOmZ1bmN0aW9uKCl7cmV0dXJue21vZGU6YSxub2RlOm4saW5zdDpvfX0sY2FuX3Bhc3RlOmZ1bmN0aW9uKCl7cmV0dXJuIGEhPT0hMSYmbiE9PSExfSxwYXN0ZTpmdW5jdGlvbihlLHQpe3JldHVybiBlPXRoaXMuZ2V0X25vZGUoZSksZSYmYSYmYS5tYXRjaCgvXihjb3B5X25vZGV8bW92ZV9ub2RlKSQvKSYmbj8odGhpc1thXShuLGUsdCwhMSwhMSwhMSxvKSYmdGhpcy50cmlnZ2VyKFwicGFzdGVcIix7cGFyZW50OmUuaWQsbm9kZTpuLG1vZGU6YX0pLG49ITEsYT0hMSx2b2lkKG89ITEpKTohMX0sY2xlYXJfYnVmZmVyOmZ1bmN0aW9uKCl7bj0hMSxhPSExLG89ITEsdGhpcy50cmlnZ2VyKFwiY2xlYXJfYnVmZmVyXCIpfSxlZGl0OmZ1bmN0aW9uKHQsaSxyKXt2YXIgcyxuLGEsbyxkLGMsbCxoLF8sdT0hMTtyZXR1cm4odD10aGlzLmdldF9ub2RlKHQpKT90aGlzLnNldHRpbmdzLmNvcmUuY2hlY2tfY2FsbGJhY2s9PT0hMT8odGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzA3XCIscmVhc29uOlwiQ291bGQgbm90IGVkaXQgbm9kZSBiZWNhdXNlIG9mIGNoZWNrX2NhbGxiYWNrXCJ9LHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLCExKTooXz10LGk9XCJzdHJpbmdcIj09dHlwZW9mIGk/aTp0LnRleHQsdGhpcy5zZXRfdGV4dCh0LFwiXCIpLHQ9dGhpcy5fb3Blbl90byh0KSxfLnRleHQ9aSxzPXRoaXMuX2RhdGEuY29yZS5ydGwsbj10aGlzLmVsZW1lbnQud2lkdGgoKSx0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1fLmlkLGE9dC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZvY3VzKCksbz1lKFwiPHNwYW4+XCIpLGQ9aSxjPWUoXCI8ZGl2IC8+XCIse2Nzczp7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIi0yMDBweFwiLGxlZnQ6cz9cIjBweFwiOlwiLTEwMDBweFwiLHZpc2liaWxpdHk6XCJoaWRkZW5cIn19KS5hcHBlbmRUbyhcImJvZHlcIiksbD1lKFwiPGlucHV0IC8+XCIse3ZhbHVlOmQsXCJjbGFzc1wiOlwianN0cmVlLXJlbmFtZS1pbnB1dFwiLGNzczp7cGFkZGluZzpcIjBcIixib3JkZXI6XCIxcHggc29saWQgc2lsdmVyXCIsXCJib3gtc2l6aW5nXCI6XCJib3JkZXItYm94XCIsZGlzcGxheTpcImlubGluZS1ibG9ja1wiLGhlaWdodDp0aGlzLl9kYXRhLmNvcmUubGlfaGVpZ2h0K1wicHhcIixsaW5lSGVpZ2h0OnRoaXMuX2RhdGEuY29yZS5saV9oZWlnaHQrXCJweFwiLHdpZHRoOlwiMTUwcHhcIn0sYmx1cjplLnByb3h5KGZ1bmN0aW9uKGkpe2kuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksaS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBzLG49by5jaGlsZHJlbihcIi5qc3RyZWUtcmVuYW1lLWlucHV0XCIpLGw9bi52YWwoKSxoPXRoaXMuc2V0dGluZ3MuY29yZS5mb3JjZV90ZXh0O1wiXCI9PT1sJiYobD1kKSxjLnJlbW92ZSgpLG8ucmVwbGFjZVdpdGgoYSksby5yZW1vdmUoKSxkPWg/ZDplKFwiPGRpdj48L2Rpdj5cIikuYXBwZW5kKGUucGFyc2VIVE1MKGQpKS5odG1sKCksdGhpcy5zZXRfdGV4dCh0LGQpLHM9ISF0aGlzLnJlbmFtZV9ub2RlKHQsaD9lKFwiPGRpdj48L2Rpdj5cIikudGV4dChsKS50ZXh0KCk6ZShcIjxkaXY+PC9kaXY+XCIpLmFwcGVuZChlLnBhcnNlSFRNTChsKSkuaHRtbCgpKSxzfHx0aGlzLnNldF90ZXh0KHQsZCksdGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQ9Xy5pZCxzZXRUaW1lb3V0KGUucHJveHkoZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldF9ub2RlKF8uaWQsITApO2UubGVuZ3RoJiYodGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQ9Xy5pZCxlLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKSl9LHRoaXMpLDApLHImJnIuY2FsbCh0aGlzLF8scyx1KX0sdGhpcyksa2V5ZG93bjpmdW5jdGlvbihlKXt2YXIgdD1lLndoaWNoOzI3PT09dCYmKHU9ITAsdGhpcy52YWx1ZT1kKSwoMjc9PT10fHwxMz09PXR8fDM3PT09dHx8Mzg9PT10fHwzOT09PXR8fDQwPT09dHx8MzI9PT10KSYmZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSwoMjc9PT10fHwxMz09PXQpJiYoZS5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYmx1cigpKX0sY2xpY2s6ZnVuY3Rpb24oZSl7ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX0sbW91c2Vkb3duOmZ1bmN0aW9uKGUpe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCl9LGtleXVwOmZ1bmN0aW9uKGUpe2wud2lkdGgoTWF0aC5taW4oYy50ZXh0KFwicFdcIit0aGlzLnZhbHVlKS53aWR0aCgpLG4pKX0sa2V5cHJlc3M6ZnVuY3Rpb24oZSl7cmV0dXJuIDEzPT09ZS53aGljaD8hMTp2b2lkIDB9fSksaD17Zm9udEZhbWlseTphLmNzcyhcImZvbnRGYW1pbHlcIil8fFwiXCIsZm9udFNpemU6YS5jc3MoXCJmb250U2l6ZVwiKXx8XCJcIixmb250V2VpZ2h0OmEuY3NzKFwiZm9udFdlaWdodFwiKXx8XCJcIixmb250U3R5bGU6YS5jc3MoXCJmb250U3R5bGVcIil8fFwiXCIsZm9udFN0cmV0Y2g6YS5jc3MoXCJmb250U3RyZXRjaFwiKXx8XCJcIixmb250VmFyaWFudDphLmNzcyhcImZvbnRWYXJpYW50XCIpfHxcIlwiLGxldHRlclNwYWNpbmc6YS5jc3MoXCJsZXR0ZXJTcGFjaW5nXCIpfHxcIlwiLHdvcmRTcGFjaW5nOmEuY3NzKFwid29yZFNwYWNpbmdcIil8fFwiXCJ9LG8uYXR0cihcImNsYXNzXCIsYS5hdHRyKFwiY2xhc3NcIikpLmFwcGVuZChhLmNvbnRlbnRzKCkuY2xvbmUoKSkuYXBwZW5kKGwpLGEucmVwbGFjZVdpdGgobyksYy5jc3MoaCksdm9pZCBsLmNzcyhoKS53aWR0aChNYXRoLm1pbihjLnRleHQoXCJwV1wiK2xbMF0udmFsdWUpLndpZHRoKCksbikpWzBdLnNlbGVjdCgpKTohMX0sc2V0X3RoZW1lOmZ1bmN0aW9uKHQsaSl7aWYoIXQpcmV0dXJuITE7aWYoaT09PSEwKXt2YXIgcj10aGlzLnNldHRpbmdzLmNvcmUudGhlbWVzLmRpcjtyfHwocj1lLmpzdHJlZS5wYXRoK1wiL3RoZW1lc1wiKSxpPXIrXCIvXCIrdCtcIi9zdHlsZS5jc3NcIn1pJiYtMT09PWUuaW5BcnJheShpLGQpJiYoZShcImhlYWRcIikuYXBwZW5kKCc8bGluayByZWw9XCJzdHlsZXNoZWV0XCIgaHJlZj1cIicraSsnXCIgdHlwZT1cInRleHQvY3NzXCIgLz4nKSxkLnB1c2goaSkpLHRoaXMuX2RhdGEuY29yZS50aGVtZXMubmFtZSYmdGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwianN0cmVlLVwiK3RoaXMuX2RhdGEuY29yZS50aGVtZXMubmFtZSksXG50aGlzLl9kYXRhLmNvcmUudGhlbWVzLm5hbWU9dCx0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJqc3RyZWUtXCIrdCksdGhpcy5lbGVtZW50W3RoaXMuc2V0dGluZ3MuY29yZS50aGVtZXMucmVzcG9uc2l2ZT9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShcImpzdHJlZS1cIit0K1wiLXJlc3BvbnNpdmVcIiksdGhpcy50cmlnZ2VyKFwic2V0X3RoZW1lXCIse3RoZW1lOnR9KX0sZ2V0X3RoZW1lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEuY29yZS50aGVtZXMubmFtZX0sc2V0X3RoZW1lX3ZhcmlhbnQ6ZnVuY3Rpb24oZSl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy52YXJpYW50JiZ0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtXCIrdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5uYW1lK1wiLVwiK3RoaXMuX2RhdGEuY29yZS50aGVtZXMudmFyaWFudCksdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy52YXJpYW50PWUsZSYmdGhpcy5lbGVtZW50LmFkZENsYXNzKFwianN0cmVlLVwiK3RoaXMuX2RhdGEuY29yZS50aGVtZXMubmFtZStcIi1cIit0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnZhcmlhbnQpfSxnZXRfdGhlbWVfdmFyaWFudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnZhcmlhbnR9LHNob3dfc3RyaXBlczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuc3RyaXBlcz0hMCx0aGlzLmdldF9jb250YWluZXJfdWwoKS5hZGRDbGFzcyhcImpzdHJlZS1zdHJpcGVkXCIpfSxoaWRlX3N0cmlwZXM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM9ITEsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtc3RyaXBlZFwiKX0sdG9nZ2xlX3N0cmlwZXM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM/dGhpcy5oaWRlX3N0cmlwZXMoKTp0aGlzLnNob3dfc3RyaXBlcygpfSxzaG93X2RvdHM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmRvdHM9ITAsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtbm8tZG90c1wiKX0saGlkZV9kb3RzOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzPSExLHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmFkZENsYXNzKFwianN0cmVlLW5vLWRvdHNcIil9LHRvZ2dsZV9kb3RzOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzP3RoaXMuaGlkZV9kb3RzKCk6dGhpcy5zaG93X2RvdHMoKX0sc2hvd19pY29uczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM9ITAsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtbm8taWNvbnNcIil9LGhpZGVfaWNvbnM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmljb25zPSExLHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmFkZENsYXNzKFwianN0cmVlLW5vLWljb25zXCIpfSx0b2dnbGVfaWNvbnM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmljb25zP3RoaXMuaGlkZV9pY29ucygpOnRoaXMuc2hvd19pY29ucygpfSxzZXRfaWNvbjpmdW5jdGlvbihpLHIpe3ZhciBzLG4sYSxvO2lmKGUuaXNBcnJheShpKSl7Zm9yKGk9aS5zbGljZSgpLHM9MCxuPWkubGVuZ3RoO24+cztzKyspdGhpcy5zZXRfaWNvbihpW3NdLHIpO3JldHVybiEwfXJldHVybiBpPXRoaXMuZ2V0X25vZGUoaSksaSYmaS5pZCE9PWUuanN0cmVlLnJvb3Q/KG89aS5pY29uLGkuaWNvbj1yPT09ITB8fG51bGw9PT1yfHxyPT09dHx8XCJcIj09PXI/ITA6cixhPXRoaXMuZ2V0X25vZGUoaSwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtdGhlbWVpY29uXCIpLHI9PT0hMT90aGlzLmhpZGVfaWNvbihpKTpyPT09ITB8fG51bGw9PT1yfHxyPT09dHx8XCJcIj09PXI/KGEucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtdGhlbWVpY29uLWN1c3RvbSBcIitvKS5jc3MoXCJiYWNrZ3JvdW5kXCIsXCJcIikucmVtb3ZlQXR0cihcInJlbFwiKSxvPT09ITEmJnRoaXMuc2hvd19pY29uKGkpKTotMT09PXIuaW5kZXhPZihcIi9cIikmJi0xPT09ci5pbmRleE9mKFwiLlwiKT8oYS5yZW1vdmVDbGFzcyhvKS5jc3MoXCJiYWNrZ3JvdW5kXCIsXCJcIiksYS5hZGRDbGFzcyhyK1wiIGpzdHJlZS10aGVtZWljb24tY3VzdG9tXCIpLmF0dHIoXCJyZWxcIixyKSxvPT09ITEmJnRoaXMuc2hvd19pY29uKGkpKTooYS5yZW1vdmVDbGFzcyhvKS5jc3MoXCJiYWNrZ3JvdW5kXCIsXCJcIiksYS5hZGRDbGFzcyhcImpzdHJlZS10aGVtZWljb24tY3VzdG9tXCIpLmNzcyhcImJhY2tncm91bmRcIixcInVybCgnXCIrcitcIicpIGNlbnRlciBjZW50ZXIgbm8tcmVwZWF0XCIpLmF0dHIoXCJyZWxcIixyKSxvPT09ITEmJnRoaXMuc2hvd19pY29uKGkpKSwhMCk6ITF9LGdldF9pY29uOmZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/dC5pY29uOiExfSxoaWRlX2ljb246ZnVuY3Rpb24odCl7dmFyIGkscjtpZihlLmlzQXJyYXkodCkpe2Zvcih0PXQuc2xpY2UoKSxpPTAscj10Lmxlbmd0aDtyPmk7aSsrKXRoaXMuaGlkZV9pY29uKHRbaV0pO3JldHVybiEwfXJldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdCE9PWUuanN0cmVlLnJvb3Q/KHQuaWNvbj0hMSx0aGlzLmdldF9ub2RlKHQsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuY2hpbGRyZW4oXCIuanN0cmVlLXRoZW1laWNvblwiKS5hZGRDbGFzcyhcImpzdHJlZS10aGVtZWljb24taGlkZGVuXCIpLCEwKTohMX0sc2hvd19pY29uOmZ1bmN0aW9uKHQpe3ZhciBpLHIscztpZihlLmlzQXJyYXkodCkpe2Zvcih0PXQuc2xpY2UoKSxpPTAscj10Lmxlbmd0aDtyPmk7aSsrKXRoaXMuc2hvd19pY29uKHRbaV0pO3JldHVybiEwfXJldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdCE9PWUuanN0cmVlLnJvb3Q/KHM9dGhpcy5nZXRfbm9kZSh0LCEwKSx0Lmljb249cy5sZW5ndGg/cy5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS10aGVtZWljb25cIikuYXR0cihcInJlbFwiKTohMCx0Lmljb258fCh0Lmljb249ITApLHMuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtdGhlbWVpY29uXCIpLnJlbW92ZUNsYXNzKFwianN0cmVlLXRoZW1laWNvbi1oaWRkZW5cIiksITApOiExfX0sZS52YWthdGE9e30sZS52YWthdGEuYXR0cmlidXRlcz1mdW5jdGlvbih0LGkpe3Q9ZSh0KVswXTt2YXIgcj1pP3t9OltdO3JldHVybiB0JiZ0LmF0dHJpYnV0ZXMmJmUuZWFjaCh0LmF0dHJpYnV0ZXMsZnVuY3Rpb24odCxzKXstMT09PWUuaW5BcnJheShzLm5hbWUudG9Mb3dlckNhc2UoKSxbXCJzdHlsZVwiLFwiY29udGVudGVkaXRhYmxlXCIsXCJoYXNmb2N1c1wiLFwidGFiaW5kZXhcIl0pJiZudWxsIT09cy52YWx1ZSYmXCJcIiE9PWUudHJpbShzLnZhbHVlKSYmKGk/cltzLm5hbWVdPXMudmFsdWU6ci5wdXNoKHMubmFtZSkpfSkscn0sZS52YWthdGEuYXJyYXlfdW5pcXVlPWZ1bmN0aW9uKGUpe3ZhciBpLHIscz1bXSxuPXt9O2ZvcihpPTAscj1lLmxlbmd0aDtyPmk7aSsrKW5bZVtpXV09PT10JiYocy5wdXNoKGVbaV0pLG5bZVtpXV09ITApO3JldHVybiBzfSxlLnZha2F0YS5hcnJheV9yZW1vdmU9ZnVuY3Rpb24oZSx0LGkpe3ZhciByPWUuc2xpY2UoKGl8fHQpKzF8fGUubGVuZ3RoKTtyZXR1cm4gZS5sZW5ndGg9MD50P2UubGVuZ3RoK3Q6dCxlLnB1c2guYXBwbHkoZSxyKSxlfSxlLnZha2F0YS5hcnJheV9yZW1vdmVfaXRlbT1mdW5jdGlvbih0LGkpe3ZhciByPWUuaW5BcnJheShpLHQpO3JldHVybi0xIT09cj9lLnZha2F0YS5hcnJheV9yZW1vdmUodCxyKTp0fSxlLmpzdHJlZS5wbHVnaW5zLmNoYW5nZWQ9ZnVuY3Rpb24oZSx0KXt2YXIgaT1bXTt0aGlzLnRyaWdnZXI9ZnVuY3Rpb24oZSxyKXt2YXIgcyxuO2lmKHJ8fChyPXt9KSxcImNoYW5nZWRcIj09PWUucmVwbGFjZShcIi5qc3RyZWVcIixcIlwiKSl7ci5jaGFuZ2VkPXtzZWxlY3RlZDpbXSxkZXNlbGVjdGVkOltdfTt2YXIgYT17fTtmb3Iocz0wLG49aS5sZW5ndGg7bj5zO3MrKylhW2lbc11dPTE7Zm9yKHM9MCxuPXIuc2VsZWN0ZWQubGVuZ3RoO24+cztzKyspYVtyLnNlbGVjdGVkW3NdXT9hW3Iuc2VsZWN0ZWRbc11dPTI6ci5jaGFuZ2VkLnNlbGVjdGVkLnB1c2goci5zZWxlY3RlZFtzXSk7Zm9yKHM9MCxuPWkubGVuZ3RoO24+cztzKyspMT09PWFbaVtzXV0mJnIuY2hhbmdlZC5kZXNlbGVjdGVkLnB1c2goaVtzXSk7aT1yLnNlbGVjdGVkLnNsaWNlKCl9dC50cmlnZ2VyLmNhbGwodGhpcyxlLHIpfSx0aGlzLnJlZnJlc2g9ZnVuY3Rpb24oZSxyKXtyZXR1cm4gaT1bXSx0LnJlZnJlc2guYXBwbHkodGhpcyxhcmd1bWVudHMpfX07dmFyIF89bC5jcmVhdGVFbGVtZW50KFwiSVwiKTtfLmNsYXNzTmFtZT1cImpzdHJlZS1pY29uIGpzdHJlZS1jaGVja2JveFwiLF8uc2V0QXR0cmlidXRlKFwicm9sZVwiLFwicHJlc2VudGF0aW9uXCIpLGUuanN0cmVlLmRlZmF1bHRzLmNoZWNrYm94PXt2aXNpYmxlOiEwLHRocmVlX3N0YXRlOiEwLHdob2xlX25vZGU6ITAsa2VlcF9zZWxlY3RlZF9zdHlsZTohMCxjYXNjYWRlOlwiXCIsdGllX3NlbGVjdGlvbjohMH0sZS5qc3RyZWUucGx1Z2lucy5jaGVja2JveD1mdW5jdGlvbihpLHIpe3RoaXMuYmluZD1mdW5jdGlvbigpe3IuYmluZC5jYWxsKHRoaXMpLHRoaXMuX2RhdGEuY2hlY2tib3gudXRvPSExLHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQ9W10sdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aHJlZV9zdGF0ZSYmKHRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZT1cInVwK2Rvd24rdW5kZXRlcm1pbmVkXCIpLHRoaXMuZWxlbWVudC5vbihcImluaXQuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbigpe3RoaXMuX2RhdGEuY2hlY2tib3gudmlzaWJsZT10aGlzLnNldHRpbmdzLmNoZWNrYm94LnZpc2libGUsdGhpcy5zZXR0aW5ncy5jaGVja2JveC5rZWVwX3NlbGVjdGVkX3N0eWxlfHx0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3gtbm8tY2xpY2tlZFwiKSx0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24mJnRoaXMuZWxlbWVudC5hZGRDbGFzcyhcImpzdHJlZS1jaGVja2JveC1zZWxlY3Rpb25cIil9LHRoaXMpKS5vbihcImxvYWRpbmcuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbigpe3RoaXNbdGhpcy5fZGF0YS5jaGVja2JveC52aXNpYmxlP1wic2hvd19jaGVja2JveGVzXCI6XCJoaWRlX2NoZWNrYm94ZXNcIl0oKX0sdGhpcykpLC0xIT09dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLmluZGV4T2YoXCJ1bmRldGVybWluZWRcIikmJnRoaXMuZWxlbWVudC5vbihcImNoYW5nZWQuanN0cmVlIHVuY2hlY2tfbm9kZS5qc3RyZWUgY2hlY2tfbm9kZS5qc3RyZWUgdW5jaGVja19hbGwuanN0cmVlIGNoZWNrX2FsbC5qc3RyZWUgbW92ZV9ub2RlLmpzdHJlZSBjb3B5X25vZGUuanN0cmVlIHJlZHJhdy5qc3RyZWUgb3Blbl9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNoZWNrYm94LnV0byYmY2xlYXJUaW1lb3V0KHRoaXMuX2RhdGEuY2hlY2tib3gudXRvKSx0aGlzLl9kYXRhLmNoZWNrYm94LnV0bz1zZXRUaW1lb3V0KGUucHJveHkodGhpcy5fdW5kZXRlcm1pbmVkLHRoaXMpLDUwKX0sdGhpcykpLHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbnx8dGhpcy5lbGVtZW50Lm9uKFwibW9kZWwuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3ZhciBpLHIscz10aGlzLl9tb2RlbC5kYXRhLG49KHNbdC5wYXJlbnRdLHQubm9kZXMpO2ZvcihpPTAscj1uLmxlbmd0aDtyPmk7aSsrKXNbbltpXV0uc3RhdGUuY2hlY2tlZD1zW25baV1dLnN0YXRlLmNoZWNrZWR8fHNbbltpXV0ub3JpZ2luYWwmJnNbbltpXV0ub3JpZ2luYWwuc3RhdGUmJnNbbltpXV0ub3JpZ2luYWwuc3RhdGUuY2hlY2tlZCxzW25baV1dLnN0YXRlLmNoZWNrZWQmJnRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQucHVzaChuW2ldKX0sdGhpcykpLCgtMSE9PXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZS5pbmRleE9mKFwidXBcIil8fC0xIT09dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLmluZGV4T2YoXCJkb3duXCIpKSYmdGhpcy5lbGVtZW50Lm9uKFwibW9kZWwuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbih0LGkpe3ZhciByLHMsbixhLG8sZCxjPXRoaXMuX21vZGVsLmRhdGEsbD1jW2kucGFyZW50XSxoPWkubm9kZXMsXz1bXSx1PXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZSxnPXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbjtpZigtMSE9PXUuaW5kZXhPZihcImRvd25cIikpaWYobC5zdGF0ZVtnP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl0pe2ZvcihzPTAsbj1oLmxlbmd0aDtuPnM7cysrKWNbaFtzXV0uc3RhdGVbZz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwO3RoaXMuX2RhdGFbZz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkPXRoaXMuX2RhdGFbZz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLmNvbmNhdChoKX1lbHNlIGZvcihzPTAsbj1oLmxlbmd0aDtuPnM7cysrKWlmKGNbaFtzXV0uc3RhdGVbZz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdKXtmb3IoYT0wLG89Y1toW3NdXS5jaGlsZHJlbl9kLmxlbmd0aDtvPmE7YSsrKWNbY1toW3NdXS5jaGlsZHJlbl9kW2FdXS5zdGF0ZVtnP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITA7dGhpcy5fZGF0YVtnP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9dGhpcy5fZGF0YVtnP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQuY29uY2F0KGNbaFtzXV0uY2hpbGRyZW5fZCl9aWYoLTEhPT11LmluZGV4T2YoXCJ1cFwiKSl7Zm9yKHM9MCxuPWwuY2hpbGRyZW5fZC5sZW5ndGg7bj5zO3MrKyljW2wuY2hpbGRyZW5fZFtzXV0uY2hpbGRyZW4ubGVuZ3RofHxfLnB1c2goY1tsLmNoaWxkcmVuX2Rbc11dLnBhcmVudCk7Zm9yKF89ZS52YWthdGEuYXJyYXlfdW5pcXVlKF8pLGE9MCxvPV8ubGVuZ3RoO28+YTthKyspZm9yKGw9Y1tfW2FdXTtsJiZsLmlkIT09ZS5qc3RyZWUucm9vdDspe2ZvcihyPTAscz0wLG49bC5jaGlsZHJlbi5sZW5ndGg7bj5zO3MrKylyKz1jW2wuY2hpbGRyZW5bc11dLnN0YXRlW2c/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZihyIT09bilicmVhaztsLnN0YXRlW2c/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT0hMCx0aGlzLl9kYXRhW2c/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZC5wdXNoKGwuaWQpLGQ9dGhpcy5nZXRfbm9kZShsLCEwKSxkJiZkLmxlbmd0aCYmZC5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKGc/XCJqc3RyZWUtY2xpY2tlZFwiOlwianN0cmVlLWNoZWNrZWRcIiksbD10aGlzLmdldF9ub2RlKGwucGFyZW50KX19dGhpcy5fZGF0YVtnP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9ZS52YWthdGEuYXJyYXlfdW5pcXVlKHRoaXMuX2RhdGFbZz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkKX0sdGhpcykpLm9uKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj9cInNlbGVjdF9ub2RlLmpzdHJlZVwiOlwiY2hlY2tfbm9kZS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKHQsaSl7dmFyIHIscyxuLGEsbz1pLm5vZGUsZD10aGlzLl9tb2RlbC5kYXRhLGM9dGhpcy5nZXRfbm9kZShvLnBhcmVudCksbD10aGlzLmdldF9ub2RlKG8sITApLGg9dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLF89dGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uO2lmKC0xIT09aC5pbmRleE9mKFwiZG93blwiKSlmb3IodGhpcy5fZGF0YVtfP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9ZS52YWthdGEuYXJyYXlfdW5pcXVlKHRoaXMuX2RhdGFbXz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLmNvbmNhdChvLmNoaWxkcmVuX2QpKSxyPTAscz1vLmNoaWxkcmVuX2QubGVuZ3RoO3M+cjtyKyspYT1kW28uY2hpbGRyZW5fZFtyXV0sYS5zdGF0ZVtfP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITAsYSYmYS5vcmlnaW5hbCYmYS5vcmlnaW5hbC5zdGF0ZSYmYS5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJihhLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD0hMSk7aWYoLTEhPT1oLmluZGV4T2YoXCJ1cFwiKSlmb3IoO2MmJmMuaWQhPT1lLmpzdHJlZS5yb290Oyl7Zm9yKG49MCxyPTAscz1jLmNoaWxkcmVuLmxlbmd0aDtzPnI7cisrKW4rPWRbYy5jaGlsZHJlbltyXV0uc3RhdGVbXz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdO2lmKG4hPT1zKWJyZWFrO2Muc3RhdGVbXz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLHRoaXMuX2RhdGFbXz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLnB1c2goYy5pZCksYT10aGlzLmdldF9ub2RlKGMsITApLGEmJmEubGVuZ3RoJiZhLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MoXz9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKSxjPXRoaXMuZ2V0X25vZGUoYy5wYXJlbnQpfS0xIT09aC5pbmRleE9mKFwiZG93blwiKSYmbC5sZW5ndGgmJmwuZmluZChcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKF8/XCJqc3RyZWUtY2xpY2tlZFwiOlwianN0cmVlLWNoZWNrZWRcIikucGFyZW50KCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMCl9LHRoaXMpKS5vbih0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24/XCJkZXNlbGVjdF9hbGwuanN0cmVlXCI6XCJ1bmNoZWNrX2FsbC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKHQsaSl7dmFyIHIscyxuLGE9dGhpcy5nZXRfbm9kZShlLmpzdHJlZS5yb290KSxvPXRoaXMuX21vZGVsLmRhdGE7Zm9yKHI9MCxzPWEuY2hpbGRyZW5fZC5sZW5ndGg7cz5yO3IrKyluPW9bYS5jaGlsZHJlbl9kW3JdXSxuJiZuLm9yaWdpbmFsJiZuLm9yaWdpbmFsLnN0YXRlJiZuLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZCYmKG4ub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkPSExKX0sdGhpcykpLm9uKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj9cImRlc2VsZWN0X25vZGUuanN0cmVlXCI6XCJ1bmNoZWNrX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbih0LGkpe3ZhciByLHMsbixhPWkubm9kZSxvPXRoaXMuZ2V0X25vZGUoYSwhMCksZD10aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGUsYz10aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb247aWYoYSYmYS5vcmlnaW5hbCYmYS5vcmlnaW5hbC5zdGF0ZSYmYS5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJihhLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD0hMSksLTEhPT1kLmluZGV4T2YoXCJkb3duXCIpKWZvcihyPTAscz1hLmNoaWxkcmVuX2QubGVuZ3RoO3M+cjtyKyspbj10aGlzLl9tb2RlbC5kYXRhW2EuY2hpbGRyZW5fZFtyXV0sbi5zdGF0ZVtjP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITEsbiYmbi5vcmlnaW5hbCYmbi5vcmlnaW5hbC5zdGF0ZSYmbi5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJihuLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD0hMSk7aWYoLTEhPT1kLmluZGV4T2YoXCJ1cFwiKSlmb3Iocj0wLHM9YS5wYXJlbnRzLmxlbmd0aDtzPnI7cisrKW49dGhpcy5fbW9kZWwuZGF0YVthLnBhcmVudHNbcl1dLG4uc3RhdGVbYz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSExLG4mJm4ub3JpZ2luYWwmJm4ub3JpZ2luYWwuc3RhdGUmJm4ub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkJiYobi5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9ITEpLG49dGhpcy5nZXRfbm9kZShhLnBhcmVudHNbcl0sITApLG4mJm4ubGVuZ3RoJiZuLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITEpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3MoYz9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKTtmb3Iobj1bXSxyPTAscz10aGlzLl9kYXRhW2M/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZC5sZW5ndGg7cz5yO3IrKyktMSE9PWQuaW5kZXhPZihcImRvd25cIikmJi0xIT09ZS5pbkFycmF5KHRoaXMuX2RhdGFbYz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkW3JdLGEuY2hpbGRyZW5fZCl8fC0xIT09ZC5pbmRleE9mKFwidXBcIikmJi0xIT09ZS5pbkFycmF5KHRoaXMuX2RhdGFbYz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkW3JdLGEucGFyZW50cyl8fG4ucHVzaCh0aGlzLl9kYXRhW2M/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZFtyXSk7dGhpcy5fZGF0YVtjP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9ZS52YWthdGEuYXJyYXlfdW5pcXVlKG4pLC0xIT09ZC5pbmRleE9mKFwiZG93blwiKSYmby5sZW5ndGgmJm8uZmluZChcIi5qc3RyZWUtYW5jaG9yXCIpLnJlbW92ZUNsYXNzKGM/XCJqc3RyZWUtY2xpY2tlZFwiOlwianN0cmVlLWNoZWNrZWRcIikucGFyZW50KCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSl9LHRoaXMpKSwtMSE9PXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZS5pbmRleE9mKFwidXBcIikmJnRoaXMuZWxlbWVudC5vbihcImRlbGV0ZV9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24odCxpKXtmb3IodmFyIHIscyxuLGEsbz10aGlzLmdldF9ub2RlKGkucGFyZW50KSxkPXRoaXMuX21vZGVsLmRhdGEsYz10aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb247byYmby5pZCE9PWUuanN0cmVlLnJvb3QmJiFvLnN0YXRlW2M/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTspe2ZvcihuPTAscj0wLHM9by5jaGlsZHJlbi5sZW5ndGg7cz5yO3IrKyluKz1kW28uY2hpbGRyZW5bcl1dLnN0YXRlW2M/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZighKHM+MCYmbj09PXMpKWJyZWFrO28uc3RhdGVbYz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLHRoaXMuX2RhdGFbYz9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLnB1c2goby5pZCksYT10aGlzLmdldF9ub2RlKG8sITApLGEmJmEubGVuZ3RoJiZhLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MoYz9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKSxvPXRoaXMuZ2V0X25vZGUoby5wYXJlbnQpfX0sdGhpcykpLm9uKFwibW92ZV9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24odCxpKXt2YXIgcixzLG4sYSxvLGQ9aS5pc19tdWx0aSxjPWkub2xkX3BhcmVudCxsPXRoaXMuZ2V0X25vZGUoaS5wYXJlbnQpLGg9dGhpcy5fbW9kZWwuZGF0YSxfPXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbjtpZighZClmb3Iocj10aGlzLmdldF9ub2RlKGMpO3ImJnIuaWQhPT1lLmpzdHJlZS5yb290JiYhci5zdGF0ZVtfP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl07KXtmb3Iocz0wLG49MCxhPXIuY2hpbGRyZW4ubGVuZ3RoO2E+bjtuKyspcys9aFtyLmNoaWxkcmVuW25dXS5zdGF0ZVtfP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl07aWYoIShhPjAmJnM9PT1hKSlicmVhaztyLnN0YXRlW18/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT0hMCx0aGlzLl9kYXRhW18/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZC5wdXNoKHIuaWQpLG89dGhpcy5nZXRfbm9kZShyLCEwKSxvJiZvLmxlbmd0aCYmby5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKF8/XCJqc3RyZWUtY2xpY2tlZFwiOlwianN0cmVlLWNoZWNrZWRcIikscj10aGlzLmdldF9ub2RlKHIucGFyZW50KX1mb3Iocj1sO3ImJnIuaWQhPT1lLmpzdHJlZS5yb290Oyl7Zm9yKHM9MCxuPTAsYT1yLmNoaWxkcmVuLmxlbmd0aDthPm47bisrKXMrPWhbci5jaGlsZHJlbltuXV0uc3RhdGVbXz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdO2lmKHM9PT1hKXIuc3RhdGVbXz9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdfHwoci5zdGF0ZVtfP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITAsdGhpcy5fZGF0YVtfP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQucHVzaChyLmlkKSxvPXRoaXMuZ2V0X25vZGUociwhMCksbyYmby5sZW5ndGgmJm8uYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5hZGRDbGFzcyhfP1wianN0cmVlLWNsaWNrZWRcIjpcImpzdHJlZS1jaGVja2VkXCIpKTtlbHNle2lmKCFyLnN0YXRlW18/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXSlicmVhaztyLnN0YXRlW18/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT0hMSx0aGlzLl9kYXRhW18/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZD1lLnZha2F0YS5hcnJheV9yZW1vdmVfaXRlbSh0aGlzLl9kYXRhW18/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZCxyLmlkKSxvPXRoaXMuZ2V0X25vZGUociwhMCksbyYmby5sZW5ndGgmJm8uYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhfP1wianN0cmVlLWNsaWNrZWRcIjpcImpzdHJlZS1jaGVja2VkXCIpfXI9dGhpcy5nZXRfbm9kZShyLnBhcmVudCl9fSx0aGlzKSl9LHRoaXMuX3VuZGV0ZXJtaW5lZD1mdW5jdGlvbigpe2lmKG51bGwhPT10aGlzLmVsZW1lbnQpe3ZhciBpLHIscyxuLGE9e30sbz10aGlzLl9tb2RlbC5kYXRhLGQ9dGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uLGM9dGhpcy5fZGF0YVtkP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQsbD1bXSxoPXRoaXM7Zm9yKGk9MCxyPWMubGVuZ3RoO3I+aTtpKyspaWYob1tjW2ldXSYmb1tjW2ldXS5wYXJlbnRzKWZvcihzPTAsbj1vW2NbaV1dLnBhcmVudHMubGVuZ3RoO24+cztzKyspYVtvW2NbaV1dLnBhcmVudHNbc11dPT09dCYmb1tjW2ldXS5wYXJlbnRzW3NdIT09ZS5qc3RyZWUucm9vdCYmKGFbb1tjW2ldXS5wYXJlbnRzW3NdXT0hMCxsLnB1c2gob1tjW2ldXS5wYXJlbnRzW3NdKSk7Zm9yKHRoaXMuZWxlbWVudC5maW5kKFwiLmpzdHJlZS1jbG9zZWRcIikubm90KFwiOmhhcyguanN0cmVlLWNoaWxkcmVuKVwiKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQsYz1oLmdldF9ub2RlKHRoaXMpO2lmKGMuc3RhdGUubG9hZGVkKXtmb3IoaT0wLHI9Yy5jaGlsZHJlbl9kLmxlbmd0aDtyPmk7aSsrKWlmKGQ9b1tjLmNoaWxkcmVuX2RbaV1dLCFkLnN0YXRlLmxvYWRlZCYmZC5vcmlnaW5hbCYmZC5vcmlnaW5hbC5zdGF0ZSYmZC5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJmQub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkPT09ITApZm9yKGFbZC5pZF09PT10JiZkLmlkIT09ZS5qc3RyZWUucm9vdCYmKGFbZC5pZF09ITAsbC5wdXNoKGQuaWQpKSxzPTAsbj1kLnBhcmVudHMubGVuZ3RoO24+cztzKyspYVtkLnBhcmVudHNbc11dPT09dCYmZC5wYXJlbnRzW3NdIT09ZS5qc3RyZWUucm9vdCYmKGFbZC5wYXJlbnRzW3NdXT0hMCxsLnB1c2goZC5wYXJlbnRzW3NdKSl9ZWxzZSBpZihjLm9yaWdpbmFsJiZjLm9yaWdpbmFsLnN0YXRlJiZjLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZCYmYy5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9PT0hMClmb3IoYVtjLmlkXT09PXQmJmMuaWQhPT1lLmpzdHJlZS5yb290JiYoYVtjLmlkXT0hMCxsLnB1c2goYy5pZCkpLHM9MCxuPWMucGFyZW50cy5sZW5ndGg7bj5zO3MrKylhW2MucGFyZW50c1tzXV09PT10JiZjLnBhcmVudHNbc10hPT1lLmpzdHJlZS5yb290JiYoYVtjLnBhcmVudHNbc11dPSEwLGwucHVzaChjLnBhcmVudHNbc10pKX0pLHRoaXMuZWxlbWVudC5maW5kKFwiLmpzdHJlZS11bmRldGVybWluZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtdW5kZXRlcm1pbmVkXCIpLGk9MCxyPWwubGVuZ3RoO3I+aTtpKyspb1tsW2ldXS5zdGF0ZVtkP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl18fChjPXRoaXMuZ2V0X25vZGUobFtpXSwhMCksYyYmYy5sZW5ndGgmJmMuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtY2hlY2tib3hcIikuYWRkQ2xhc3MoXCJqc3RyZWUtdW5kZXRlcm1pbmVkXCIpKX19LHRoaXMucmVkcmF3X25vZGU9ZnVuY3Rpb24odCxpLHMsbil7aWYodD1yLnJlZHJhd19ub2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl7dmFyIGEsbyxkPW51bGwsYz1udWxsO2ZvcihhPTAsbz10LmNoaWxkTm9kZXMubGVuZ3RoO28+YTthKyspaWYodC5jaGlsZE5vZGVzW2FdJiZ0LmNoaWxkTm9kZXNbYV0uY2xhc3NOYW1lJiYtMSE9PXQuY2hpbGROb2Rlc1thXS5jbGFzc05hbWUuaW5kZXhPZihcImpzdHJlZS1hbmNob3JcIikpe2Q9dC5jaGlsZE5vZGVzW2FdO2JyZWFrfWQmJighdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uJiZ0aGlzLl9tb2RlbC5kYXRhW3QuaWRdLnN0YXRlLmNoZWNrZWQmJihkLmNsYXNzTmFtZSs9XCIganN0cmVlLWNoZWNrZWRcIiksYz1fLmNsb25lTm9kZSghMSksdGhpcy5fbW9kZWwuZGF0YVt0LmlkXS5zdGF0ZS5jaGVja2JveF9kaXNhYmxlZCYmKGMuY2xhc3NOYW1lKz1cIiBqc3RyZWUtY2hlY2tib3gtZGlzYWJsZWRcIiksZC5pbnNlcnRCZWZvcmUoYyxkLmNoaWxkTm9kZXNbMF0pKX1yZXR1cm4gc3x8LTE9PT10aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGUuaW5kZXhPZihcInVuZGV0ZXJtaW5lZFwiKXx8KHRoaXMuX2RhdGEuY2hlY2tib3gudXRvJiZjbGVhclRpbWVvdXQodGhpcy5fZGF0YS5jaGVja2JveC51dG8pLHRoaXMuX2RhdGEuY2hlY2tib3gudXRvPXNldFRpbWVvdXQoZS5wcm94eSh0aGlzLl91bmRldGVybWluZWQsdGhpcyksNTApKSx0fSx0aGlzLnNob3dfY2hlY2tib3hlcz1mdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuY2hlY2tib3hlcz0hMCx0aGlzLmdldF9jb250YWluZXJfdWwoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1uby1jaGVja2JveGVzXCIpfSx0aGlzLmhpZGVfY2hlY2tib3hlcz1mdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuY2hlY2tib3hlcz0hMSx0aGlzLmdldF9jb250YWluZXJfdWwoKS5hZGRDbGFzcyhcImpzdHJlZS1uby1jaGVja2JveGVzXCIpfSx0aGlzLnRvZ2dsZV9jaGVja2JveGVzPWZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5jaGVja2JveGVzP3RoaXMuaGlkZV9jaGVja2JveGVzKCk6dGhpcy5zaG93X2NoZWNrYm94ZXMoKX0sdGhpcy5pc191bmRldGVybWluZWQ9ZnVuY3Rpb24odCl7dD10aGlzLmdldF9ub2RlKHQpO3ZhciBpLHIscz10aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGUsbj10aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24sYT10aGlzLl9kYXRhW24/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZCxvPXRoaXMuX21vZGVsLmRhdGE7aWYoIXR8fHQuc3RhdGVbbj9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPT09ITB8fC0xPT09cy5pbmRleE9mKFwidW5kZXRlcm1pbmVkXCIpfHwtMT09PXMuaW5kZXhPZihcImRvd25cIikmJi0xPT09cy5pbmRleE9mKFwidXBcIikpcmV0dXJuITE7aWYoIXQuc3RhdGUubG9hZGVkJiZ0Lm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD09PSEwKXJldHVybiEwO2ZvcihpPTAscj10LmNoaWxkcmVuX2QubGVuZ3RoO3I+aTtpKyspaWYoLTEhPT1lLmluQXJyYXkodC5jaGlsZHJlbl9kW2ldLGEpfHwhb1t0LmNoaWxkcmVuX2RbaV1dLnN0YXRlLmxvYWRlZCYmb1t0LmNoaWxkcmVuX2RbaV1dLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZClyZXR1cm4hMDtyZXR1cm4hMX0sdGhpcy5kaXNhYmxlX2NoZWNrYm94PWZ1bmN0aW9uKHQpe3ZhciBpLHIscztpZihlLmlzQXJyYXkodCkpe2Zvcih0PXQuc2xpY2UoKSxpPTAscj10Lmxlbmd0aDtyPmk7aSsrKXRoaXMuZGlzYWJsZV9jaGVja2JveCh0W2ldKTtyZXR1cm4hMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290PyhzPXRoaXMuZ2V0X25vZGUodCwhMCksdm9pZCh0LnN0YXRlLmNoZWNrYm94X2Rpc2FibGVkfHwodC5zdGF0ZS5jaGVja2JveF9kaXNhYmxlZD0hMCxzJiZzLmxlbmd0aCYmcy5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGVja2JveFwiKS5hZGRDbGFzcyhcImpzdHJlZS1jaGVja2JveC1kaXNhYmxlZFwiKSx0aGlzLnRyaWdnZXIoXCJkaXNhYmxlX2NoZWNrYm94XCIse25vZGU6dH0pKSkpOiExfSx0aGlzLmVuYWJsZV9jaGVja2JveD1mdW5jdGlvbih0KXt2YXIgaSxyLHM7aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCksaT0wLHI9dC5sZW5ndGg7cj5pO2krKyl0aGlzLmVuYWJsZV9jaGVja2JveCh0W2ldKTtyZXR1cm4hMH1yZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQmJnQuaWQhPT1lLmpzdHJlZS5yb290PyhzPXRoaXMuZ2V0X25vZGUodCwhMCksdm9pZCh0LnN0YXRlLmNoZWNrYm94X2Rpc2FibGVkJiYodC5zdGF0ZS5jaGVja2JveF9kaXNhYmxlZD0hMSxzJiZzLmxlbmd0aCYmcy5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGVja2JveFwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jaGVja2JveC1kaXNhYmxlZFwiKSx0aGlzLnRyaWdnZXIoXCJlbmFibGVfY2hlY2tib3hcIix7bm9kZTp0fSkpKSk6ITF9LHRoaXMuYWN0aXZhdGVfbm9kZT1mdW5jdGlvbih0LGkpe3JldHVybiBlKGkudGFyZ2V0KS5oYXNDbGFzcyhcImpzdHJlZS1jaGVja2JveC1kaXNhYmxlZFwiKT8hMToodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uJiYodGhpcy5zZXR0aW5ncy5jaGVja2JveC53aG9sZV9ub2RlfHxlKGkudGFyZ2V0KS5oYXNDbGFzcyhcImpzdHJlZS1jaGVja2JveFwiKSkmJihpLmN0cmxLZXk9ITApLHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbnx8IXRoaXMuc2V0dGluZ3MuY2hlY2tib3gud2hvbGVfbm9kZSYmIWUoaS50YXJnZXQpLmhhc0NsYXNzKFwianN0cmVlLWNoZWNrYm94XCIpP3IuYWN0aXZhdGVfbm9kZS5jYWxsKHRoaXMsdCxpKTp0aGlzLmlzX2Rpc2FibGVkKHQpPyExOih0aGlzLmlzX2NoZWNrZWQodCk/dGhpcy51bmNoZWNrX25vZGUodCxpKTp0aGlzLmNoZWNrX25vZGUodCxpKSx2b2lkIHRoaXMudHJpZ2dlcihcImFjdGl2YXRlX25vZGVcIix7bm9kZTp0aGlzLmdldF9ub2RlKHQpfSkpKX0sdGhpcy5jaGVja19ub2RlPWZ1bmN0aW9uKHQsaSl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLnNlbGVjdF9ub2RlKHQsITEsITAsaSk7dmFyIHIscyxuO2lmKGUuaXNBcnJheSh0KSl7Zm9yKHQ9dC5zbGljZSgpLHM9MCxuPXQubGVuZ3RoO24+cztzKyspdGhpcy5jaGVja19ub2RlKHRbc10saSk7cmV0dXJuITB9cmV0dXJuIHQ9dGhpcy5nZXRfbm9kZSh0KSx0JiZ0LmlkIT09ZS5qc3RyZWUucm9vdD8ocj10aGlzLmdldF9ub2RlKHQsITApLHZvaWQodC5zdGF0ZS5jaGVja2VkfHwodC5zdGF0ZS5jaGVja2VkPSEwLHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQucHVzaCh0LmlkKSxyJiZyLmxlbmd0aCYmci5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKFwianN0cmVlLWNoZWNrZWRcIiksdGhpcy50cmlnZ2VyKFwiY2hlY2tfbm9kZVwiLHtub2RlOnQsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZCxldmVudDppfSkpKSk6ITF9LHRoaXMudW5jaGVja19ub2RlPWZ1bmN0aW9uKHQsaSl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLmRlc2VsZWN0X25vZGUodCwhMSxpKTt2YXIgcixzLG47aWYoZS5pc0FycmF5KHQpKXtmb3IodD10LnNsaWNlKCkscj0wLHM9dC5sZW5ndGg7cz5yO3IrKyl0aGlzLnVuY2hlY2tfbm9kZSh0W3JdLGkpO3JldHVybiEwfXJldHVybiB0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/KG49dGhpcy5nZXRfbm9kZSh0LCEwKSx2b2lkKHQuc3RhdGUuY2hlY2tlZCYmKHQuc3RhdGUuY2hlY2tlZD0hMSx0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPWUudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQsdC5pZCksbi5sZW5ndGgmJm4uY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jaGVja2VkXCIpLHRoaXMudHJpZ2dlcihcInVuY2hlY2tfbm9kZVwiLHtub2RlOnQsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZCxldmVudDppfSkpKSk6ITF9LHRoaXMuY2hlY2tfYWxsPWZ1bmN0aW9uKCl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLnNlbGVjdF9hbGwoKTt2YXIgdCxpO3RoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQuY29uY2F0KFtdKTtmb3IodGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZD10aGlzLl9tb2RlbC5kYXRhW2UuanN0cmVlLnJvb3RdLmNoaWxkcmVuX2QuY29uY2F0KCksdD0wLGk9dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZC5sZW5ndGg7aT50O3QrKyl0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWRbdF1dJiYodGhpcy5fbW9kZWwuZGF0YVt0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkW3RdXS5zdGF0ZS5jaGVja2VkPSEwKTt0aGlzLnJlZHJhdyghMCksdGhpcy50cmlnZ2VyKFwiY2hlY2tfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWR9KX0sdGhpcy51bmNoZWNrX2FsbD1mdW5jdGlvbigpe2lmKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbilyZXR1cm4gdGhpcy5kZXNlbGVjdF9hbGwoKTt2YXIgZSx0LGk9dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZC5jb25jYXQoW10pO2ZvcihlPTAsdD10aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLmxlbmd0aDt0PmU7ZSsrKXRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZFtlXV0mJih0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWRbZV1dLnN0YXRlLmNoZWNrZWQ9ITEpO3RoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQ9W10sdGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLWNoZWNrZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtY2hlY2tlZFwiKSx0aGlzLnRyaWdnZXIoXCJ1bmNoZWNrX2FsbFwiLHtzZWxlY3RlZDp0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLG5vZGU6aX0pfSx0aGlzLmlzX2NoZWNrZWQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj90aGlzLmlzX3NlbGVjdGVkKHQpOih0PXRoaXMuZ2V0X25vZGUodCksdCYmdC5pZCE9PWUuanN0cmVlLnJvb3Q/dC5zdGF0ZS5jaGVja2VkOiExKX0sdGhpcy5nZXRfY2hlY2tlZD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uP3RoaXMuZ2V0X3NlbGVjdGVkKHQpOnQ/ZS5tYXAodGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZCxlLnByb3h5KGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldF9ub2RlKGUpfSx0aGlzKSk6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZH0sdGhpcy5nZXRfdG9wX2NoZWNrZWQ9ZnVuY3Rpb24odCl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLmdldF90b3Bfc2VsZWN0ZWQodCk7dmFyIGkscixzLG4sYT10aGlzLmdldF9jaGVja2VkKCEwKSxvPXt9O2ZvcihpPTAscj1hLmxlbmd0aDtyPmk7aSsrKW9bYVtpXS5pZF09YVtpXTtmb3IoaT0wLHI9YS5sZW5ndGg7cj5pO2krKylmb3Iocz0wLG49YVtpXS5jaGlsZHJlbl9kLmxlbmd0aDtuPnM7cysrKW9bYVtpXS5jaGlsZHJlbl9kW3NdXSYmZGVsZXRlIG9bYVtpXS5jaGlsZHJlbl9kW3NdXTthPVtdO2ZvcihpIGluIG8pby5oYXNPd25Qcm9wZXJ0eShpKSYmYS5wdXNoKGkpO3JldHVybiB0P2UubWFwKGEsZS5wcm94eShmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRfbm9kZShlKX0sdGhpcykpOmF9LHRoaXMuZ2V0X2JvdHRvbV9jaGVja2VkPWZ1bmN0aW9uKHQpe2lmKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbilyZXR1cm4gdGhpcy5nZXRfYm90dG9tX3NlbGVjdGVkKHQpO3ZhciBpLHIscz10aGlzLmdldF9jaGVja2VkKCEwKSxuPVtdO2ZvcihpPTAscj1zLmxlbmd0aDtyPmk7aSsrKXNbaV0uY2hpbGRyZW4ubGVuZ3RofHxuLnB1c2goc1tpXS5pZCk7cmV0dXJuIHQ/ZS5tYXAobixlLnByb3h5KGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldF9ub2RlKGUpfSx0aGlzKSk6bn0sdGhpcy5sb2FkX25vZGU9ZnVuY3Rpb24odCxpKXt2YXIgcyxuLGEsbztpZighZS5pc0FycmF5KHQpJiYhdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uJiYobz10aGlzLmdldF9ub2RlKHQpLG8mJm8uc3RhdGUubG9hZGVkKSlmb3Iocz0wLG49by5jaGlsZHJlbl9kLmxlbmd0aDtuPnM7cysrKXRoaXMuX21vZGVsLmRhdGFbby5jaGlsZHJlbl9kW3NdXS5zdGF0ZS5jaGVja2VkJiYoYT0hMCx0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPWUudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQsby5jaGlsZHJlbl9kW3NdKSk7cmV0dXJuIHIubG9hZF9ub2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdGhpcy5nZXRfc3RhdGU9ZnVuY3Rpb24oKXt2YXIgZT1yLmdldF9zdGF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj9lOihlLmNoZWNrYm94PXRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQuc2xpY2UoKSxlKX0sdGhpcy5zZXRfc3RhdGU9ZnVuY3Rpb24odCxpKXt2YXIgcz1yLnNldF9zdGF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYocyYmdC5jaGVja2JveCl7aWYoIXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbil7dGhpcy51bmNoZWNrX2FsbCgpO3ZhciBuPXRoaXM7ZS5lYWNoKHQuY2hlY2tib3gsZnVuY3Rpb24oZSx0KXtuLmNoZWNrX25vZGUodCl9KX1yZXR1cm4gZGVsZXRlIHQuY2hlY2tib3gsdGhpcy5zZXRfc3RhdGUodCxpKSwhMX1yZXR1cm4gc30sdGhpcy5yZWZyZXNoPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbnx8KHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQ9W10pLHIucmVmcmVzaC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxlLmpzdHJlZS5kZWZhdWx0cy5jb25kaXRpb25hbHNlbGVjdD1mdW5jdGlvbigpe3JldHVybiEwfSxlLmpzdHJlZS5wbHVnaW5zLmNvbmRpdGlvbmFsc2VsZWN0PWZ1bmN0aW9uKGUsdCl7dGhpcy5hY3RpdmF0ZV9ub2RlPWZ1bmN0aW9uKGUsaSl7dGhpcy5zZXR0aW5ncy5jb25kaXRpb25hbHNlbGVjdC5jYWxsKHRoaXMsdGhpcy5nZXRfbm9kZShlKSxpKSYmdC5hY3RpdmF0ZV9ub2RlLmNhbGwodGhpcyxlLGkpfX0sZS5qc3RyZWUuZGVmYXVsdHMuY29udGV4dG1lbnU9e3NlbGVjdF9ub2RlOiEwLHNob3dfYXRfbm9kZTohMCxpdGVtczpmdW5jdGlvbih0LGkpe3JldHVybntjcmVhdGU6e3NlcGFyYXRvcl9iZWZvcmU6ITEsc2VwYXJhdG9yX2FmdGVyOiEwLF9kaXNhYmxlZDohMSxsYWJlbDpcIkNyZWF0ZVwiLGFjdGlvbjpmdW5jdGlvbih0KXt2YXIgaT1lLmpzdHJlZS5yZWZlcmVuY2UodC5yZWZlcmVuY2UpLHI9aS5nZXRfbm9kZSh0LnJlZmVyZW5jZSk7aS5jcmVhdGVfbm9kZShyLHt9LFwibGFzdFwiLGZ1bmN0aW9uKGUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpLmVkaXQoZSl9LDApfSl9fSxyZW5hbWU6e3NlcGFyYXRvcl9iZWZvcmU6ITEsc2VwYXJhdG9yX2FmdGVyOiExLF9kaXNhYmxlZDohMSxsYWJlbDpcIlJlbmFtZVwiLGFjdGlvbjpmdW5jdGlvbih0KXt2YXIgaT1lLmpzdHJlZS5yZWZlcmVuY2UodC5yZWZlcmVuY2UpLHI9aS5nZXRfbm9kZSh0LnJlZmVyZW5jZSk7aS5lZGl0KHIpfX0scmVtb3ZlOntzZXBhcmF0b3JfYmVmb3JlOiExLGljb246ITEsc2VwYXJhdG9yX2FmdGVyOiExLF9kaXNhYmxlZDohMSxsYWJlbDpcIkRlbGV0ZVwiLGFjdGlvbjpmdW5jdGlvbih0KXt2YXIgaT1lLmpzdHJlZS5yZWZlcmVuY2UodC5yZWZlcmVuY2UpLHI9aS5nZXRfbm9kZSh0LnJlZmVyZW5jZSk7aS5pc19zZWxlY3RlZChyKT9pLmRlbGV0ZV9ub2RlKGkuZ2V0X3NlbGVjdGVkKCkpOmkuZGVsZXRlX25vZGUocil9fSxjY3A6e3NlcGFyYXRvcl9iZWZvcmU6ITAsaWNvbjohMSxzZXBhcmF0b3JfYWZ0ZXI6ITEsbGFiZWw6XCJFZGl0XCIsYWN0aW9uOiExLHN1Ym1lbnU6e2N1dDp7c2VwYXJhdG9yX2JlZm9yZTohMSxzZXBhcmF0b3JfYWZ0ZXI6ITEsbGFiZWw6XCJDdXRcIixhY3Rpb246ZnVuY3Rpb24odCl7dmFyIGk9ZS5qc3RyZWUucmVmZXJlbmNlKHQucmVmZXJlbmNlKSxyPWkuZ2V0X25vZGUodC5yZWZlcmVuY2UpO2kuaXNfc2VsZWN0ZWQocik/aS5jdXQoaS5nZXRfdG9wX3NlbGVjdGVkKCkpOmkuY3V0KHIpfX0sY29weTp7c2VwYXJhdG9yX2JlZm9yZTohMSxpY29uOiExLHNlcGFyYXRvcl9hZnRlcjohMSxsYWJlbDpcIkNvcHlcIixhY3Rpb246ZnVuY3Rpb24odCl7dmFyIGk9ZS5qc3RyZWUucmVmZXJlbmNlKHQucmVmZXJlbmNlKSxyPWkuZ2V0X25vZGUodC5yZWZlcmVuY2UpO2kuaXNfc2VsZWN0ZWQocik/aS5jb3B5KGkuZ2V0X3RvcF9zZWxlY3RlZCgpKTppLmNvcHkocil9fSxwYXN0ZTp7c2VwYXJhdG9yX2JlZm9yZTohMSxpY29uOiExLF9kaXNhYmxlZDpmdW5jdGlvbih0KXtyZXR1cm4hZS5qc3RyZWUucmVmZXJlbmNlKHQucmVmZXJlbmNlKS5jYW5fcGFzdGUoKX0sc2VwYXJhdG9yX2FmdGVyOiExLGxhYmVsOlwiUGFzdGVcIixhY3Rpb246ZnVuY3Rpb24odCl7dmFyIGk9ZS5qc3RyZWUucmVmZXJlbmNlKHQucmVmZXJlbmNlKSxyPWkuZ2V0X25vZGUodC5yZWZlcmVuY2UpO2kucGFzdGUocil9fX19fX19LGUuanN0cmVlLnBsdWdpbnMuY29udGV4dG1lbnU9ZnVuY3Rpb24oaSxyKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtyLmJpbmQuY2FsbCh0aGlzKTt2YXIgdCxpLHM9MCxuPW51bGw7dGhpcy5lbGVtZW50Lm9uKFwiY29udGV4dG1lbnUuanN0cmVlXCIsXCIuanN0cmVlLWFuY2hvclwiLGUucHJveHkoZnVuY3Rpb24oZSx0KXtlLnByZXZlbnREZWZhdWx0KCkscz1lLmN0cmxLZXk/K25ldyBEYXRlOjAsKHR8fG4pJiYocz0rbmV3IERhdGUrMWU0KSxuJiZjbGVhclRpbWVvdXQobiksdGhpcy5pc19sb2FkaW5nKGUuY3VycmVudFRhcmdldCl8fHRoaXMuc2hvd19jb250ZXh0bWVudShlLmN1cnJlbnRUYXJnZXQsZS5wYWdlWCxlLnBhZ2VZLGUpfSx0aGlzKSkub24oXCJjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbih0KXt0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGUmJighc3x8K25ldyBEYXRlLXM+MjUwKSYmZS52YWthdGEuY29udGV4dC5oaWRlKCkscz0wfSx0aGlzKSkub24oXCJ0b3VjaHN0YXJ0LmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixmdW5jdGlvbihyKXtyLm9yaWdpbmFsRXZlbnQmJnIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmci5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYodD1yLnBhZ2VYLGk9ci5wYWdlWSxuPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlKHIuY3VycmVudFRhcmdldCkudHJpZ2dlcihcImNvbnRleHRtZW51XCIsITApfSw3NTApKX0pLm9uKFwidG91Y2htb3ZlLnZha2F0YS5qc3RyZWVcIixmdW5jdGlvbihlKXtuJiZlLm9yaWdpbmFsRXZlbnQmJmUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoTWF0aC5hYnModC1lLnBhZ2VYKT41MHx8TWF0aC5hYnMoaS1lLnBhZ2VZKT41MCkmJmNsZWFyVGltZW91dChuKX0pLm9uKFwidG91Y2hlbmQudmFrYXRhLmpzdHJlZVwiLGZ1bmN0aW9uKGUpe24mJmNsZWFyVGltZW91dChuKX0pLGUobCkub24oXCJjb250ZXh0X2hpZGUudmFrYXRhLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGU9ITF9LHRoaXMpKX0sdGhpcy50ZWFyZG93bj1mdW5jdGlvbigpe3RoaXMuX2RhdGEuY29udGV4dG1lbnUudmlzaWJsZSYmZS52YWthdGEuY29udGV4dC5oaWRlKCksci50ZWFyZG93bi5jYWxsKHRoaXMpfSx0aGlzLnNob3dfY29udGV4dG1lbnU9ZnVuY3Rpb24oaSxyLHMsbil7aWYoaT10aGlzLmdldF9ub2RlKGkpLCFpfHxpLmlkPT09ZS5qc3RyZWUucm9vdClyZXR1cm4hMTt2YXIgYT10aGlzLnNldHRpbmdzLmNvbnRleHRtZW51LG89dGhpcy5nZXRfbm9kZShpLCEwKSxkPW8uY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKSxjPSExLGw9ITE7KGEuc2hvd19hdF9ub2RlfHxyPT09dHx8cz09PXQpJiYoYz1kLm9mZnNldCgpLHI9Yy5sZWZ0LHM9Yy50b3ArdGhpcy5fZGF0YS5jb3JlLmxpX2hlaWdodCksdGhpcy5zZXR0aW5ncy5jb250ZXh0bWVudS5zZWxlY3Rfbm9kZSYmIXRoaXMuaXNfc2VsZWN0ZWQoaSkmJnRoaXMuYWN0aXZhdGVfbm9kZShpLG4pLGw9YS5pdGVtcyxlLmlzRnVuY3Rpb24obCkmJihsPWwuY2FsbCh0aGlzLGksZS5wcm94eShmdW5jdGlvbihlKXt0aGlzLl9zaG93X2NvbnRleHRtZW51KGkscixzLGUpfSx0aGlzKSkpLGUuaXNQbGFpbk9iamVjdChsKSYmdGhpcy5fc2hvd19jb250ZXh0bWVudShpLHIscyxsKX0sdGhpcy5fc2hvd19jb250ZXh0bWVudT1mdW5jdGlvbih0LGkscixzKXt2YXIgbj10aGlzLmdldF9ub2RlKHQsITApLGE9bi5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpO2UobCkub25lKFwiY29udGV4dF9zaG93LnZha2F0YS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKHQsaSl7dmFyIHI9XCJqc3RyZWUtY29udGV4dG1lbnUganN0cmVlLVwiK3RoaXMuZ2V0X3RoZW1lKCkrXCItY29udGV4dG1lbnVcIjtlKGkuZWxlbWVudCkuYWRkQ2xhc3Mocil9LHRoaXMpKSx0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGU9ITAsZS52YWthdGEuY29udGV4dC5zaG93KGEse3g6aSx5OnJ9LHMpLHRoaXMudHJpZ2dlcihcInNob3dfY29udGV4dG1lbnVcIix7bm9kZTp0LHg6aSx5OnJ9KX19LGZ1bmN0aW9uKGUpe3ZhciB0PSExLGk9e2VsZW1lbnQ6ITEscmVmZXJlbmNlOiExLHBvc2l0aW9uX3g6MCxwb3NpdGlvbl95OjAsaXRlbXM6W10saHRtbDpcIlwiLGlzX3Zpc2libGU6ITF9O2UudmFrYXRhLmNvbnRleHQ9e3NldHRpbmdzOntoaWRlX29ubW91c2VsZWF2ZTowLGljb25zOiEwfSxfdHJpZ2dlcjpmdW5jdGlvbih0KXtlKGwpLnRyaWdnZXJIYW5kbGVyKFwiY29udGV4dF9cIit0K1wiLnZha2F0YVwiLHtyZWZlcmVuY2U6aS5yZWZlcmVuY2UsZWxlbWVudDppLmVsZW1lbnQscG9zaXRpb246e3g6aS5wb3NpdGlvbl94LHk6aS5wb3NpdGlvbl95fX0pfSxfZXhlY3V0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdD1pLml0ZW1zW3RdLHQmJighdC5fZGlzYWJsZWR8fGUuaXNGdW5jdGlvbih0Ll9kaXNhYmxlZCkmJiF0Ll9kaXNhYmxlZCh7aXRlbTp0LHJlZmVyZW5jZTppLnJlZmVyZW5jZSxlbGVtZW50OmkuZWxlbWVudH0pKSYmdC5hY3Rpb24/dC5hY3Rpb24uY2FsbChudWxsLHtpdGVtOnQscmVmZXJlbmNlOmkucmVmZXJlbmNlLGVsZW1lbnQ6aS5lbGVtZW50LHBvc2l0aW9uOnt4OmkucG9zaXRpb25feCx5OmkucG9zaXRpb25feX19KTohMX0sX3BhcnNlOmZ1bmN0aW9uKHQscil7aWYoIXQpcmV0dXJuITE7cnx8KGkuaHRtbD1cIlwiLGkuaXRlbXM9W10pO3ZhciBzLG49XCJcIixhPSExO3JldHVybiByJiYobis9XCI8dWw+XCIpLGUuZWFjaCh0LGZ1bmN0aW9uKHQscil7cmV0dXJuIHI/KGkuaXRlbXMucHVzaChyKSwhYSYmci5zZXBhcmF0b3JfYmVmb3JlJiYobis9XCI8bGkgY2xhc3M9J3Zha2F0YS1jb250ZXh0LXNlcGFyYXRvcic+PGEgaHJlZj0nIycgXCIrKGUudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaWNvbnM/XCJcIjonc3R5bGU9XCJtYXJnaW4tbGVmdDowcHg7XCInKStcIj4mIzE2MDs8L2E+PC9saT5cIiksYT0hMSxuKz1cIjxsaSBjbGFzcz0nXCIrKHIuX2NsYXNzfHxcIlwiKSsoci5fZGlzYWJsZWQ9PT0hMHx8ZS5pc0Z1bmN0aW9uKHIuX2Rpc2FibGVkKSYmci5fZGlzYWJsZWQoe2l0ZW06cixyZWZlcmVuY2U6aS5yZWZlcmVuY2UsZWxlbWVudDppLmVsZW1lbnR9KT9cIiB2YWthdGEtY29udGV4dG1lbnUtZGlzYWJsZWQgXCI6XCJcIikrXCInIFwiKyhyLnNob3J0Y3V0P1wiIGRhdGEtc2hvcnRjdXQ9J1wiK3Iuc2hvcnRjdXQrXCInIFwiOlwiXCIpK1wiPlwiLG4rPVwiPGEgaHJlZj0nIycgcmVsPSdcIisoaS5pdGVtcy5sZW5ndGgtMSkrXCInPlwiLGUudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaWNvbnMmJihuKz1cIjxpIFwiLHIuaWNvbiYmKG4rPS0xIT09ci5pY29uLmluZGV4T2YoXCIvXCIpfHwtMSE9PXIuaWNvbi5pbmRleE9mKFwiLlwiKT9cIiBzdHlsZT0nYmFja2dyb3VuZDp1cmwoXFxcIlwiK3IuaWNvbitcIlxcXCIpIGNlbnRlciBjZW50ZXIgbm8tcmVwZWF0JyBcIjpcIiBjbGFzcz0nXCIrci5pY29uK1wiJyBcIiksbis9XCI+PC9pPjxzcGFuIGNsYXNzPSd2YWthdGEtY29udGV4dG1lbnUtc2VwJz4mIzE2MDs8L3NwYW4+XCIpLG4rPShlLmlzRnVuY3Rpb24oci5sYWJlbCk/ci5sYWJlbCh7aXRlbTp0LHJlZmVyZW5jZTppLnJlZmVyZW5jZSxlbGVtZW50OmkuZWxlbWVudH0pOnIubGFiZWwpKyhyLnNob3J0Y3V0PycgPHNwYW4gY2xhc3M9XCJ2YWthdGEtY29udGV4dG1lbnUtc2hvcnRjdXQgdmFrYXRhLWNvbnRleHRtZW51LXNob3J0Y3V0LScrci5zaG9ydGN1dCsnXCI+Jysoci5zaG9ydGN1dF9sYWJlbHx8XCJcIikrXCI8L3NwYW4+XCI6XCJcIikrXCI8L2E+XCIsci5zdWJtZW51JiYocz1lLnZha2F0YS5jb250ZXh0Ll9wYXJzZShyLnN1Ym1lbnUsITApLHMmJihuKz1zKSksbis9XCI8L2xpPlwiLHZvaWQoci5zZXBhcmF0b3JfYWZ0ZXImJihuKz1cIjxsaSBjbGFzcz0ndmFrYXRhLWNvbnRleHQtc2VwYXJhdG9yJz48YSBocmVmPScjJyBcIisoZS52YWthdGEuY29udGV4dC5zZXR0aW5ncy5pY29ucz9cIlwiOidzdHlsZT1cIm1hcmdpbi1sZWZ0OjBweDtcIicpK1wiPiYjMTYwOzwvYT48L2xpPlwiLGE9ITApKSk6ITB9KSxuPW4ucmVwbGFjZSgvPGxpIGNsYXNzXFw9J3Zha2F0YS1jb250ZXh0LXNlcGFyYXRvcidcXD48XFwvbGlcXD4kLyxcIlwiKSxyJiYobis9XCI8L3VsPlwiKSxyfHwoaS5odG1sPW4sZS52YWthdGEuY29udGV4dC5fdHJpZ2dlcihcInBhcnNlXCIpKSxuLmxlbmd0aD4xMD9uOiExfSxfc2hvd19zdWJtZW51OmZ1bmN0aW9uKGkpe2lmKGk9ZShpKSxpLmxlbmd0aCYmaS5jaGlsZHJlbihcInVsXCIpLmxlbmd0aCl7dmFyIHI9aS5jaGlsZHJlbihcInVsXCIpLHM9aS5vZmZzZXQoKS5sZWZ0K2kub3V0ZXJXaWR0aCgpLG49aS5vZmZzZXQoKS50b3AsYT1yLndpZHRoKCksbz1yLmhlaWdodCgpLGQ9ZSh3aW5kb3cpLndpZHRoKCkrZSh3aW5kb3cpLnNjcm9sbExlZnQoKSxjPWUod2luZG93KS5oZWlnaHQoKStlKHdpbmRvdykuc2Nyb2xsVG9wKCk7dD9pW3MtKGErMTAraS5vdXRlcldpZHRoKCkpPDA/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJ2YWthdGEtY29udGV4dC1sZWZ0XCIpOmlbcythKzEwPmQ/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJ2YWthdGEtY29udGV4dC1yaWdodFwiKSxuK28rMTA+YyYmci5jc3MoXCJib3R0b21cIixcIi0xcHhcIiksci5zaG93KCl9fSxzaG93OmZ1bmN0aW9uKHIscyxuKXt2YXIgYSxvLGQsYyxsLGgsXyx1LGc9ITA7c3dpdGNoKGkuZWxlbWVudCYmaS5lbGVtZW50Lmxlbmd0aCYmaS5lbGVtZW50LndpZHRoKFwiXCIpLGcpe2Nhc2UhcyYmIXI6cmV0dXJuITE7Y2FzZSEhcyYmISFyOmkucmVmZXJlbmNlPXIsaS5wb3NpdGlvbl94PXMueCxpLnBvc2l0aW9uX3k9cy55O2JyZWFrO2Nhc2UhcyYmISFyOmkucmVmZXJlbmNlPXIsYT1yLm9mZnNldCgpLGkucG9zaXRpb25feD1hLmxlZnQrci5vdXRlckhlaWdodCgpLGkucG9zaXRpb25feT1hLnRvcDticmVhaztjYXNlISFzJiYhcjppLnBvc2l0aW9uX3g9cy54LGkucG9zaXRpb25feT1zLnl9ciYmIW4mJmUocikuZGF0YShcInZha2F0YV9jb250ZXh0bWVudVwiKSYmKG49ZShyKS5kYXRhKFwidmFrYXRhX2NvbnRleHRtZW51XCIpKSxlLnZha2F0YS5jb250ZXh0Ll9wYXJzZShuKSYmaS5lbGVtZW50Lmh0bWwoaS5odG1sKSxpLml0ZW1zLmxlbmd0aCYmKGkuZWxlbWVudC5hcHBlbmRUbyhcImJvZHlcIiksbz1pLmVsZW1lbnQsZD1pLnBvc2l0aW9uX3gsYz1pLnBvc2l0aW9uX3ksbD1vLndpZHRoKCksaD1vLmhlaWdodCgpLF89ZSh3aW5kb3cpLndpZHRoKCkrZSh3aW5kb3cpLnNjcm9sbExlZnQoKSx1PWUod2luZG93KS5oZWlnaHQoKStlKHdpbmRvdykuc2Nyb2xsVG9wKCksdCYmKGQtPW8ub3V0ZXJXaWR0aCgpLWUocikub3V0ZXJXaWR0aCgpLGQ8ZSh3aW5kb3cpLnNjcm9sbExlZnQoKSsyMCYmKGQ9ZSh3aW5kb3cpLnNjcm9sbExlZnQoKSsyMCkpLGQrbCsyMD5fJiYoZD1fLShsKzIwKSksYytoKzIwPnUmJihjPXUtKGgrMjApKSxpLmVsZW1lbnQuY3NzKHtsZWZ0OmQsdG9wOmN9KS5zaG93KCkuZmluZChcImFcIikuZmlyc3QoKS5mb2N1cygpLnBhcmVudCgpLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksaS5pc192aXNpYmxlPSEwLGUudmFrYXRhLmNvbnRleHQuX3RyaWdnZXIoXCJzaG93XCIpKX0saGlkZTpmdW5jdGlvbigpe2kuaXNfdmlzaWJsZSYmKGkuZWxlbWVudC5oaWRlKCkuZmluZChcInVsXCIpLmhpZGUoKS5lbmQoKS5maW5kKFwiOmZvY3VzXCIpLmJsdXIoKS5lbmQoKS5kZXRhY2goKSxpLmlzX3Zpc2libGU9ITEsZS52YWthdGEuY29udGV4dC5fdHJpZ2dlcihcImhpZGVcIikpfX0sZShmdW5jdGlvbigpe3Q9XCJydGxcIj09PWUoXCJib2R5XCIpLmNzcyhcImRpcmVjdGlvblwiKTt2YXIgcj0hMTtpLmVsZW1lbnQ9ZShcIjx1bCBjbGFzcz0ndmFrYXRhLWNvbnRleHQnPjwvdWw+XCIpLGkuZWxlbWVudC5vbihcIm1vdXNlZW50ZXJcIixcImxpXCIsZnVuY3Rpb24odCl7dC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxlLmNvbnRhaW5zKHRoaXMsdC5yZWxhdGVkVGFyZ2V0KXx8KHImJmNsZWFyVGltZW91dChyKSxpLmVsZW1lbnQuZmluZChcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmVuZCgpLGUodGhpcykuc2libGluZ3MoKS5maW5kKFwidWxcIikuaGlkZSgpLmVuZCgpLmVuZCgpLnBhcmVudHNVbnRpbChcIi52YWthdGEtY29udGV4dFwiLFwibGlcIikuYWRkQmFjaygpLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksZS52YWthdGEuY29udGV4dC5fc2hvd19zdWJtZW51KHRoaXMpKX0pLm9uKFwibW91c2VsZWF2ZVwiLFwibGlcIixmdW5jdGlvbih0KXtlLmNvbnRhaW5zKHRoaXMsdC5yZWxhdGVkVGFyZ2V0KXx8ZSh0aGlzKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmFkZEJhY2soKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpfSkub24oXCJtb3VzZWxlYXZlXCIsZnVuY3Rpb24odCl7ZSh0aGlzKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksZS52YWthdGEuY29udGV4dC5zZXR0aW5ncy5oaWRlX29ubW91c2VsZWF2ZSYmKHI9c2V0VGltZW91dChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oKXtlLnZha2F0YS5jb250ZXh0LmhpZGUoKX19KHRoaXMpLGUudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaGlkZV9vbm1vdXNlbGVhdmUpKX0pLm9uKFwiY2xpY2tcIixcImFcIixmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksZSh0aGlzKS5ibHVyKCkucGFyZW50KCkuaGFzQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1kaXNhYmxlZFwiKXx8ZS52YWthdGEuY29udGV4dC5fZXhlY3V0ZShlKHRoaXMpLmF0dHIoXCJyZWxcIikpPT09ITF8fGUudmFrYXRhLmNvbnRleHQuaGlkZSgpfSkub24oXCJrZXlkb3duXCIsXCJhXCIsZnVuY3Rpb24odCl7dmFyIHI9bnVsbDtzd2l0Y2godC53aGljaCl7Y2FzZSAxMzpjYXNlIDMyOnQudHlwZT1cIm1vdXNldXBcIix0LnByZXZlbnREZWZhdWx0KCksZSh0LmN1cnJlbnRUYXJnZXQpLnRyaWdnZXIodCk7YnJlYWs7Y2FzZSAzNzppLmlzX3Zpc2libGUmJihpLmVsZW1lbnQuZmluZChcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5sYXN0KCkuY2xvc2VzdChcImxpXCIpLmZpcnN0KCkuZmluZChcInVsXCIpLmhpZGUoKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuZW5kKCkuZW5kKCkuY2hpbGRyZW4oXCJhXCIpLmZvY3VzKCksdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0LnByZXZlbnREZWZhdWx0KCkpO2JyZWFrO2Nhc2UgMzg6aS5pc192aXNpYmxlJiYocj1pLmVsZW1lbnQuZmluZChcInVsOnZpc2libGVcIikuYWRkQmFjaygpLmxhc3QoKS5jaGlsZHJlbihcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnByZXZBbGwoXCJsaTpub3QoLnZha2F0YS1jb250ZXh0LXNlcGFyYXRvcilcIikuZmlyc3QoKSxyLmxlbmd0aHx8KHI9aS5lbGVtZW50LmZpbmQoXCJ1bDp2aXNpYmxlXCIpLmFkZEJhY2soKS5sYXN0KCkuY2hpbGRyZW4oXCJsaTpub3QoLnZha2F0YS1jb250ZXh0LXNlcGFyYXRvcilcIikubGFzdCgpKSxyLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuY2hpbGRyZW4oXCJhXCIpLmZvY3VzKCksdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0LnByZXZlbnREZWZhdWx0KCkpO2JyZWFrO2Nhc2UgMzk6aS5pc192aXNpYmxlJiYoaS5lbGVtZW50LmZpbmQoXCIudmFrYXRhLWNvbnRleHQtaG92ZXJcIikubGFzdCgpLmNoaWxkcmVuKFwidWxcIikuc2hvdygpLmNoaWxkcmVuKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuZmlyc3QoKS5hZGRDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmNoaWxkcmVuKFwiYVwiKS5mb2N1cygpLHQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdC5wcmV2ZW50RGVmYXVsdCgpKTticmVhaztjYXNlIDQwOmkuaXNfdmlzaWJsZSYmKHI9aS5lbGVtZW50LmZpbmQoXCJ1bDp2aXNpYmxlXCIpLmFkZEJhY2soKS5sYXN0KCkuY2hpbGRyZW4oXCIudmFrYXRhLWNvbnRleHQtaG92ZXJcIikucmVtb3ZlQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1ob3ZlclwiKS5uZXh0QWxsKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLmZpcnN0KCksci5sZW5ndGh8fChyPWkuZWxlbWVudC5maW5kKFwidWw6dmlzaWJsZVwiKS5hZGRCYWNrKCkubGFzdCgpLmNoaWxkcmVuKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLmZpcnN0KCkpLHIuYWRkQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1ob3ZlclwiKS5jaGlsZHJlbihcImFcIikuZm9jdXMoKSx0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKSk7YnJlYWs7Y2FzZSAyNzplLnZha2F0YS5jb250ZXh0LmhpZGUoKSx0LnByZXZlbnREZWZhdWx0KCl9fSkub24oXCJrZXlkb3duXCIsZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciB0PWkuZWxlbWVudC5maW5kKFwiLnZha2F0YS1jb250ZXh0bWVudS1zaG9ydGN1dC1cIitlLndoaWNoKS5wYXJlbnQoKTt0LnBhcmVudCgpLm5vdChcIi52YWthdGEtY29udGV4dC1kaXNhYmxlZFwiKSYmdC5jbGljaygpfSksZShsKS5vbihcIm1vdXNlZG93bi52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24odCl7aS5pc192aXNpYmxlJiYhZS5jb250YWlucyhpLmVsZW1lbnRbMF0sdC50YXJnZXQpJiZlLnZha2F0YS5jb250ZXh0LmhpZGUoKX0pLm9uKFwiY29udGV4dF9zaG93LnZha2F0YS5qc3RyZWVcIixmdW5jdGlvbihlLHIpe2kuZWxlbWVudC5maW5kKFwibGk6aGFzKHVsKVwiKS5jaGlsZHJlbihcImFcIikuYWRkQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1wYXJlbnRcIiksdCYmaS5lbGVtZW50LmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtcnRsXCIpLmNzcyhcImRpcmVjdGlvblwiLFwicnRsXCIpLGkuZWxlbWVudC5maW5kKFwidWxcIikuaGlkZSgpLmVuZCgpfSl9KX0oZSksZS5qc3RyZWUuZGVmYXVsdHMuZG5kPXtjb3B5OiEwLG9wZW5fdGltZW91dDo1MDAsaXNfZHJhZ2dhYmxlOiEwLGNoZWNrX3doaWxlX2RyYWdnaW5nOiEwLGFsd2F5c19jb3B5OiExLGluc2lkZV9wb3M6MCxkcmFnX3NlbGVjdGlvbjohMCx0b3VjaDohMCxsYXJnZV9kcm9wX3RhcmdldDohMSxsYXJnZV9kcmFnX3RhcmdldDohMX0sZS5qc3RyZWUucGx1Z2lucy5kbmQ9ZnVuY3Rpb24odCxpKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtpLmJpbmQuY2FsbCh0aGlzKSx0aGlzLmVsZW1lbnQub24oXCJtb3VzZWRvd24uanN0cmVlIHRvdWNoc3RhcnQuanN0cmVlXCIsdGhpcy5zZXR0aW5ncy5kbmQubGFyZ2VfZHJhZ190YXJnZXQ/XCIuanN0cmVlLW5vZGVcIjpcIi5qc3RyZWUtYW5jaG9yXCIsZS5wcm94eShmdW5jdGlvbih0KXtcbmlmKHRoaXMuc2V0dGluZ3MuZG5kLmxhcmdlX2RyYWdfdGFyZ2V0JiZlKHQudGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpWzBdIT09dC5jdXJyZW50VGFyZ2V0KXJldHVybiEwO2lmKFwidG91Y2hzdGFydFwiPT09dC50eXBlJiYoIXRoaXMuc2V0dGluZ3MuZG5kLnRvdWNofHxcInNlbGVjdGVkXCI9PT10aGlzLnNldHRpbmdzLmRuZC50b3VjaCYmIWUodC5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuaGFzQ2xhc3MoXCJqc3RyZWUtY2xpY2tlZFwiKSkpcmV0dXJuITA7dmFyIGk9dGhpcy5nZXRfbm9kZSh0LnRhcmdldCkscj10aGlzLmlzX3NlbGVjdGVkKGkpJiZ0aGlzLnNldHRpbmdzLmRuZC5kcmFnX3NlbGVjdGlvbj90aGlzLmdldF90b3Bfc2VsZWN0ZWQoKS5sZW5ndGg6MSxzPXI+MT9yK1wiIFwiK3RoaXMuZ2V0X3N0cmluZyhcIm5vZGVzXCIpOnRoaXMuZ2V0X3RleHQodC5jdXJyZW50VGFyZ2V0KTtyZXR1cm4gdGhpcy5zZXR0aW5ncy5jb3JlLmZvcmNlX3RleHQmJihzPWUudmFrYXRhLmh0bWwuZXNjYXBlKHMpKSxpJiZpLmlkJiZpLmlkIT09ZS5qc3RyZWUucm9vdCYmKDE9PT10LndoaWNofHxcInRvdWNoc3RhcnRcIj09PXQudHlwZSkmJih0aGlzLnNldHRpbmdzLmRuZC5pc19kcmFnZ2FibGU9PT0hMHx8ZS5pc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuZG5kLmlzX2RyYWdnYWJsZSkmJnRoaXMuc2V0dGluZ3MuZG5kLmlzX2RyYWdnYWJsZS5jYWxsKHRoaXMscj4xP3RoaXMuZ2V0X3RvcF9zZWxlY3RlZCghMCk6W2ldLHQpKT8odGhpcy5lbGVtZW50LnRyaWdnZXIoXCJtb3VzZWRvd24uanN0cmVlXCIpLGUudmFrYXRhLmRuZC5zdGFydCh0LHtqc3RyZWU6ITAsb3JpZ2luOnRoaXMsb2JqOnRoaXMuZ2V0X25vZGUoaSwhMCksbm9kZXM6cj4xP3RoaXMuZ2V0X3RvcF9zZWxlY3RlZCgpOltpLmlkXX0sJzxkaXYgaWQ9XCJqc3RyZWUtZG5kXCIgY2xhc3M9XCJqc3RyZWUtJyt0aGlzLmdldF90aGVtZSgpK1wiIGpzdHJlZS1cIit0aGlzLmdldF90aGVtZSgpK1wiLVwiK3RoaXMuZ2V0X3RoZW1lX3ZhcmlhbnQoKStcIiBcIisodGhpcy5zZXR0aW5ncy5jb3JlLnRoZW1lcy5yZXNwb25zaXZlP1wiIGpzdHJlZS1kbmQtcmVzcG9uc2l2ZVwiOlwiXCIpKydcIj48aSBjbGFzcz1cImpzdHJlZS1pY29uIGpzdHJlZS1lclwiPjwvaT4nK3MrJzxpbnMgY2xhc3M9XCJqc3RyZWUtY29weVwiIHN0eWxlPVwiZGlzcGxheTpub25lO1wiPis8L2lucz48L2Rpdj4nKSk6dm9pZCAwfSx0aGlzKSl9fSxlKGZ1bmN0aW9uKCl7dmFyIHQ9ITEsaT0hMSxyPSExLHM9ITEsbj1lKCc8ZGl2IGlkPVwianN0cmVlLW1hcmtlclwiPiYjMTYwOzwvZGl2PicpLmhpZGUoKTtlKGwpLm9uKFwiZG5kX3N0YXJ0LnZha2F0YS5qc3RyZWVcIixmdW5jdGlvbihlLGkpe3Q9ITEscj0hMSxpJiZpLmRhdGEmJmkuZGF0YS5qc3RyZWUmJm4uYXBwZW5kVG8oXCJib2R5XCIpfSkub24oXCJkbmRfbW92ZS52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24oYSxvKXtpZihzJiZjbGVhclRpbWVvdXQocyksbyYmby5kYXRhJiZvLmRhdGEuanN0cmVlJiYoIW8uZXZlbnQudGFyZ2V0LmlkfHxcImpzdHJlZS1tYXJrZXJcIiE9PW8uZXZlbnQudGFyZ2V0LmlkKSl7cj1vLmV2ZW50O3ZhciBkLGMsbCxoLF8sdSxnLGYscCxtLHYsaix5LGsseD1lLmpzdHJlZS5yZWZlcmVuY2Uoby5ldmVudC50YXJnZXQpLGI9ITEsdz0hMSxDPSExO2lmKHgmJnguX2RhdGEmJnguX2RhdGEuZG5kKWlmKG4uYXR0cihcImNsYXNzXCIsXCJqc3RyZWUtXCIreC5nZXRfdGhlbWUoKSsoeC5zZXR0aW5ncy5jb3JlLnRoZW1lcy5yZXNwb25zaXZlP1wiIGpzdHJlZS1kbmQtcmVzcG9uc2l2ZVwiOlwiXCIpKSxvLmhlbHBlci5jaGlsZHJlbigpLmF0dHIoXCJjbGFzc1wiLFwianN0cmVlLVwiK3guZ2V0X3RoZW1lKCkrXCIganN0cmVlLVwiK3guZ2V0X3RoZW1lKCkrXCItXCIreC5nZXRfdGhlbWVfdmFyaWFudCgpK1wiIFwiKyh4LnNldHRpbmdzLmNvcmUudGhlbWVzLnJlc3BvbnNpdmU/XCIganN0cmVlLWRuZC1yZXNwb25zaXZlXCI6XCJcIikpLmZpbmQoXCIuanN0cmVlLWNvcHlcIikuZmlyc3QoKVtvLmRhdGEub3JpZ2luJiYoby5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuYWx3YXlzX2NvcHl8fG8uZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmNvcHkmJihvLmV2ZW50Lm1ldGFLZXl8fG8uZXZlbnQuY3RybEtleSkpP1wic2hvd1wiOlwiaGlkZVwiXSgpLG8uZXZlbnQudGFyZ2V0IT09eC5lbGVtZW50WzBdJiZvLmV2ZW50LnRhcmdldCE9PXguZ2V0X2NvbnRhaW5lcl91bCgpWzBdfHwwIT09eC5nZXRfY29udGFpbmVyX3VsKCkuY2hpbGRyZW4oKS5sZW5ndGgpe2lmKGI9eC5zZXR0aW5ncy5kbmQubGFyZ2VfZHJvcF90YXJnZXQ/ZShvLmV2ZW50LnRhcmdldCkuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpOmUoby5ldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIuanN0cmVlLWFuY2hvclwiKSxiJiZiLmxlbmd0aCYmYi5wYXJlbnQoKS5pcyhcIi5qc3RyZWUtY2xvc2VkLCAuanN0cmVlLW9wZW4sIC5qc3RyZWUtbGVhZlwiKSYmKHc9Yi5vZmZzZXQoKSxDPW8uZXZlbnQucGFnZVktdy50b3AsbD1iLm91dGVySGVpZ2h0KCksdT1sLzM+Qz9bXCJiXCIsXCJpXCIsXCJhXCJdOkM+bC1sLzM/W1wiYVwiLFwiaVwiLFwiYlwiXTpDPmwvMj9bXCJpXCIsXCJhXCIsXCJiXCJdOltcImlcIixcImJcIixcImFcIl0sZS5lYWNoKHUsZnVuY3Rpb24ocixhKXtzd2l0Y2goYSl7Y2FzZVwiYlwiOmQ9dy5sZWZ0LTYsYz13LnRvcCxoPXguZ2V0X3BhcmVudChiKSxfPWIucGFyZW50KCkuaW5kZXgoKTticmVhaztjYXNlXCJpXCI6eT14LnNldHRpbmdzLmRuZC5pbnNpZGVfcG9zLGs9eC5nZXRfbm9kZShiLnBhcmVudCgpKSxkPXcubGVmdC0yLGM9dy50b3ArbC8yKzEsaD1rLmlkLF89XCJmaXJzdFwiPT09eT8wOlwibGFzdFwiPT09eT9rLmNoaWxkcmVuLmxlbmd0aDpNYXRoLm1pbih5LGsuY2hpbGRyZW4ubGVuZ3RoKTticmVhaztjYXNlXCJhXCI6ZD13LmxlZnQtNixjPXcudG9wK2wsaD14LmdldF9wYXJlbnQoYiksXz1iLnBhcmVudCgpLmluZGV4KCkrMX1mb3IoZz0hMCxmPTAscD1vLmRhdGEubm9kZXMubGVuZ3RoO3A+ZjtmKyspaWYobT1vLmRhdGEub3JpZ2luJiYoby5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuYWx3YXlzX2NvcHl8fG8uZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmNvcHkmJihvLmV2ZW50Lm1ldGFLZXl8fG8uZXZlbnQuY3RybEtleSkpP1wiY29weV9ub2RlXCI6XCJtb3ZlX25vZGVcIix2PV8sXCJtb3ZlX25vZGVcIj09PW0mJlwiYVwiPT09YSYmby5kYXRhLm9yaWdpbiYmby5kYXRhLm9yaWdpbj09PXgmJmg9PT14LmdldF9wYXJlbnQoby5kYXRhLm5vZGVzW2ZdKSYmKGo9eC5nZXRfbm9kZShoKSx2PmUuaW5BcnJheShvLmRhdGEubm9kZXNbZl0sai5jaGlsZHJlbikmJih2LT0xKSksZz1nJiYoeCYmeC5zZXR0aW5ncyYmeC5zZXR0aW5ncy5kbmQmJnguc2V0dGluZ3MuZG5kLmNoZWNrX3doaWxlX2RyYWdnaW5nPT09ITF8fHguY2hlY2sobSxvLmRhdGEub3JpZ2luJiZvLmRhdGEub3JpZ2luIT09eD9vLmRhdGEub3JpZ2luLmdldF9ub2RlKG8uZGF0YS5ub2Rlc1tmXSk6by5kYXRhLm5vZGVzW2ZdLGgsdix7ZG5kOiEwLHJlZjp4LmdldF9ub2RlKGIucGFyZW50KCkpLHBvczphLG9yaWdpbjpvLmRhdGEub3JpZ2luLGlzX211bHRpOm8uZGF0YS5vcmlnaW4mJm8uZGF0YS5vcmlnaW4hPT14LGlzX2ZvcmVpZ246IW8uZGF0YS5vcmlnaW59KSksIWcpe3gmJngubGFzdF9lcnJvciYmKGk9eC5sYXN0X2Vycm9yKCkpO2JyZWFrfXJldHVyblwiaVwiPT09YSYmYi5wYXJlbnQoKS5pcyhcIi5qc3RyZWUtY2xvc2VkXCIpJiZ4LnNldHRpbmdzLmRuZC5vcGVuX3RpbWVvdXQmJihzPXNldFRpbWVvdXQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtlLm9wZW5fbm9kZSh0KX19KHgsYikseC5zZXR0aW5ncy5kbmQub3Blbl90aW1lb3V0KSksZz8odD17aW5zOngscGFyOmgscG9zOlwiaVwiIT09YXx8XCJsYXN0XCIhPT15fHwwIT09X3x8eC5pc19sb2FkZWQoayk/XzpcImxhc3RcIn0sbi5jc3Moe2xlZnQ6ZCtcInB4XCIsdG9wOmMrXCJweFwifSkuc2hvdygpLG8uaGVscGVyLmZpbmQoXCIuanN0cmVlLWljb25cIikuZmlyc3QoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1lclwiKS5hZGRDbGFzcyhcImpzdHJlZS1va1wiKSxpPXt9LHU9ITAsITEpOnZvaWQgMH0pLHU9PT0hMCkpcmV0dXJufWVsc2V7Zm9yKGc9ITAsZj0wLHA9by5kYXRhLm5vZGVzLmxlbmd0aDtwPmYmJihnPWcmJnguY2hlY2soby5kYXRhLm9yaWdpbiYmKG8uZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmFsd2F5c19jb3B5fHxvLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5jb3B5JiYoby5ldmVudC5tZXRhS2V5fHxvLmV2ZW50LmN0cmxLZXkpKT9cImNvcHlfbm9kZVwiOlwibW92ZV9ub2RlXCIsby5kYXRhLm9yaWdpbiYmby5kYXRhLm9yaWdpbiE9PXg/by5kYXRhLm9yaWdpbi5nZXRfbm9kZShvLmRhdGEubm9kZXNbZl0pOm8uZGF0YS5ub2Rlc1tmXSxlLmpzdHJlZS5yb290LFwibGFzdFwiLHtkbmQ6ITAscmVmOnguZ2V0X25vZGUoZS5qc3RyZWUucm9vdCkscG9zOlwiaVwiLG9yaWdpbjpvLmRhdGEub3JpZ2luLGlzX211bHRpOm8uZGF0YS5vcmlnaW4mJm8uZGF0YS5vcmlnaW4hPT14LGlzX2ZvcmVpZ246IW8uZGF0YS5vcmlnaW59KSxnKTtmKyspO2lmKGcpcmV0dXJuIHQ9e2luczp4LHBhcjplLmpzdHJlZS5yb290LHBvczpcImxhc3RcIn0sbi5oaWRlKCksdm9pZCBvLmhlbHBlci5maW5kKFwiLmpzdHJlZS1pY29uXCIpLmZpcnN0KCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtZXJcIikuYWRkQ2xhc3MoXCJqc3RyZWUtb2tcIil9dD0hMSxvLmhlbHBlci5maW5kKFwiLmpzdHJlZS1pY29uXCIpLnJlbW92ZUNsYXNzKFwianN0cmVlLW9rXCIpLmFkZENsYXNzKFwianN0cmVlLWVyXCIpLG4uaGlkZSgpfX0pLm9uKFwiZG5kX3Njcm9sbC52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24oZSxpKXtpJiZpLmRhdGEmJmkuZGF0YS5qc3RyZWUmJihuLmhpZGUoKSx0PSExLHI9ITEsaS5oZWxwZXIuZmluZChcIi5qc3RyZWUtaWNvblwiKS5maXJzdCgpLnJlbW92ZUNsYXNzKFwianN0cmVlLW9rXCIpLmFkZENsYXNzKFwianN0cmVlLWVyXCIpKX0pLm9uKFwiZG5kX3N0b3AudmFrYXRhLmpzdHJlZVwiLGZ1bmN0aW9uKGEsbyl7aWYocyYmY2xlYXJUaW1lb3V0KHMpLG8mJm8uZGF0YSYmby5kYXRhLmpzdHJlZSl7bi5oaWRlKCkuZGV0YWNoKCk7dmFyIGQsYyxsPVtdO2lmKHQpe2ZvcihkPTAsYz1vLmRhdGEubm9kZXMubGVuZ3RoO2M+ZDtkKyspbFtkXT1vLmRhdGEub3JpZ2luP28uZGF0YS5vcmlnaW4uZ2V0X25vZGUoby5kYXRhLm5vZGVzW2RdKTpvLmRhdGEubm9kZXNbZF07dC5pbnNbby5kYXRhLm9yaWdpbiYmKG8uZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmFsd2F5c19jb3B5fHxvLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5jb3B5JiYoby5ldmVudC5tZXRhS2V5fHxvLmV2ZW50LmN0cmxLZXkpKT9cImNvcHlfbm9kZVwiOlwibW92ZV9ub2RlXCJdKGwsdC5wYXIsdC5wb3MsITEsITEsITEsby5kYXRhLm9yaWdpbil9ZWxzZSBkPWUoby5ldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIuanN0cmVlXCIpLGQubGVuZ3RoJiZpJiZpLmVycm9yJiZcImNoZWNrXCI9PT1pLmVycm9yJiYoZD1kLmpzdHJlZSghMCksZCYmZC5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyxpKSk7cj0hMSx0PSExfX0pLm9uKFwia2V5dXAuanN0cmVlIGtleWRvd24uanN0cmVlXCIsZnVuY3Rpb24odCxpKXtpPWUudmFrYXRhLmRuZC5fZ2V0KCksaSYmaS5kYXRhJiZpLmRhdGEuanN0cmVlJiYoaS5oZWxwZXIuZmluZChcIi5qc3RyZWUtY29weVwiKS5maXJzdCgpW2kuZGF0YS5vcmlnaW4mJihpLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5hbHdheXNfY29weXx8aS5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuY29weSYmKHQubWV0YUtleXx8dC5jdHJsS2V5KSk/XCJzaG93XCI6XCJoaWRlXCJdKCksciYmKHIubWV0YUtleT10Lm1ldGFLZXksci5jdHJsS2V5PXQuY3RybEtleSxlLnZha2F0YS5kbmQuX3RyaWdnZXIoXCJtb3ZlXCIscikpKX0pfSksZnVuY3Rpb24oZSl7ZS52YWthdGEuaHRtbD17ZGl2OmUoXCI8ZGl2IC8+XCIpLGVzY2FwZTpmdW5jdGlvbih0KXtyZXR1cm4gZS52YWthdGEuaHRtbC5kaXYudGV4dCh0KS5odG1sKCl9LHN0cmlwOmZ1bmN0aW9uKHQpe3JldHVybiBlLnZha2F0YS5odG1sLmRpdi5lbXB0eSgpLmFwcGVuZChlLnBhcnNlSFRNTCh0KSkudGV4dCgpfX07dmFyIHQ9e2VsZW1lbnQ6ITEsdGFyZ2V0OiExLGlzX2Rvd246ITEsaXNfZHJhZzohMSxoZWxwZXI6ITEsaGVscGVyX3c6MCxkYXRhOiExLGluaXRfeDowLGluaXRfeTowLHNjcm9sbF9sOjAsc2Nyb2xsX3Q6MCxzY3JvbGxfZTohMSxzY3JvbGxfaTohMSxpc190b3VjaDohMX07ZS52YWthdGEuZG5kPXtzZXR0aW5nczp7c2Nyb2xsX3NwZWVkOjEwLHNjcm9sbF9wcm94aW1pdHk6MjAsaGVscGVyX2xlZnQ6NSxoZWxwZXJfdG9wOjEwLHRocmVzaG9sZDo1LHRocmVzaG9sZF90b3VjaDo1MH0sX3RyaWdnZXI6ZnVuY3Rpb24odCxpKXt2YXIgcj1lLnZha2F0YS5kbmQuX2dldCgpO3IuZXZlbnQ9aSxlKGwpLnRyaWdnZXJIYW5kbGVyKFwiZG5kX1wiK3QrXCIudmFrYXRhXCIscil9LF9nZXQ6ZnVuY3Rpb24oKXtyZXR1cm57ZGF0YTp0LmRhdGEsZWxlbWVudDp0LmVsZW1lbnQsaGVscGVyOnQuaGVscGVyfX0sX2NsZWFuOmZ1bmN0aW9uKCl7dC5oZWxwZXImJnQuaGVscGVyLnJlbW92ZSgpLHQuc2Nyb2xsX2kmJihjbGVhckludGVydmFsKHQuc2Nyb2xsX2kpLHQuc2Nyb2xsX2k9ITEpLHQ9e2VsZW1lbnQ6ITEsdGFyZ2V0OiExLGlzX2Rvd246ITEsaXNfZHJhZzohMSxoZWxwZXI6ITEsaGVscGVyX3c6MCxkYXRhOiExLGluaXRfeDowLGluaXRfeTowLHNjcm9sbF9sOjAsc2Nyb2xsX3Q6MCxzY3JvbGxfZTohMSxzY3JvbGxfaTohMSxpc190b3VjaDohMX0sZShsKS5vZmYoXCJtb3VzZW1vdmUudmFrYXRhLmpzdHJlZSB0b3VjaG1vdmUudmFrYXRhLmpzdHJlZVwiLGUudmFrYXRhLmRuZC5kcmFnKSxlKGwpLm9mZihcIm1vdXNldXAudmFrYXRhLmpzdHJlZSB0b3VjaGVuZC52YWthdGEuanN0cmVlXCIsZS52YWthdGEuZG5kLnN0b3ApfSxfc2Nyb2xsOmZ1bmN0aW9uKGkpe2lmKCF0LnNjcm9sbF9lfHwhdC5zY3JvbGxfbCYmIXQuc2Nyb2xsX3QpcmV0dXJuIHQuc2Nyb2xsX2kmJihjbGVhckludGVydmFsKHQuc2Nyb2xsX2kpLHQuc2Nyb2xsX2k9ITEpLCExO2lmKCF0LnNjcm9sbF9pKXJldHVybiB0LnNjcm9sbF9pPXNldEludGVydmFsKGUudmFrYXRhLmRuZC5fc2Nyb2xsLDEwMCksITE7aWYoaT09PSEwKXJldHVybiExO3ZhciByPXQuc2Nyb2xsX2Uuc2Nyb2xsVG9wKCkscz10LnNjcm9sbF9lLnNjcm9sbExlZnQoKTt0LnNjcm9sbF9lLnNjcm9sbFRvcChyK3Quc2Nyb2xsX3QqZS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9zcGVlZCksdC5zY3JvbGxfZS5zY3JvbGxMZWZ0KHMrdC5zY3JvbGxfbCplLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3NwZWVkKSwociE9PXQuc2Nyb2xsX2Uuc2Nyb2xsVG9wKCl8fHMhPT10LnNjcm9sbF9lLnNjcm9sbExlZnQoKSkmJmUudmFrYXRhLmRuZC5fdHJpZ2dlcihcInNjcm9sbFwiLHQuc2Nyb2xsX2UpfSxzdGFydDpmdW5jdGlvbihpLHIscyl7XCJ0b3VjaHN0YXJ0XCI9PT1pLnR5cGUmJmkub3JpZ2luYWxFdmVudCYmaS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzJiZpLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0mJihpLnBhZ2VYPWkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCxpLnBhZ2VZPWkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSxpLnRhcmdldD1sLmVsZW1lbnRGcm9tUG9pbnQoaS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYLXdpbmRvdy5wYWdlWE9mZnNldCxpLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVktd2luZG93LnBhZ2VZT2Zmc2V0KSksdC5pc19kcmFnJiZlLnZha2F0YS5kbmQuc3RvcCh7fSk7dHJ5e2kuY3VycmVudFRhcmdldC51bnNlbGVjdGFibGU9XCJvblwiLGkuY3VycmVudFRhcmdldC5vbnNlbGVjdHN0YXJ0PWZ1bmN0aW9uKCl7cmV0dXJuITF9LGkuY3VycmVudFRhcmdldC5zdHlsZSYmKGkuY3VycmVudFRhcmdldC5zdHlsZS5Nb3pVc2VyU2VsZWN0PVwibm9uZVwiKX1jYXRjaChuKXt9cmV0dXJuIHQuaW5pdF94PWkucGFnZVgsdC5pbml0X3k9aS5wYWdlWSx0LmRhdGE9cix0LmlzX2Rvd249ITAsdC5lbGVtZW50PWkuY3VycmVudFRhcmdldCx0LnRhcmdldD1pLnRhcmdldCx0LmlzX3RvdWNoPVwidG91Y2hzdGFydFwiPT09aS50eXBlLHMhPT0hMSYmKHQuaGVscGVyPWUoXCI8ZGl2IGlkPSd2YWthdGEtZG5kJz48L2Rpdj5cIikuaHRtbChzKS5jc3Moe2Rpc3BsYXk6XCJibG9ja1wiLG1hcmdpbjpcIjBcIixwYWRkaW5nOlwiMFwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItMjAwMHB4XCIsbGluZUhlaWdodDpcIjE2cHhcIix6SW5kZXg6XCIxMDAwMFwifSkpLGUobCkub24oXCJtb3VzZW1vdmUudmFrYXRhLmpzdHJlZSB0b3VjaG1vdmUudmFrYXRhLmpzdHJlZVwiLGUudmFrYXRhLmRuZC5kcmFnKSxlKGwpLm9uKFwibW91c2V1cC52YWthdGEuanN0cmVlIHRvdWNoZW5kLnZha2F0YS5qc3RyZWVcIixlLnZha2F0YS5kbmQuc3RvcCksITF9LGRyYWc6ZnVuY3Rpb24oaSl7aWYoXCJ0b3VjaG1vdmVcIj09PWkudHlwZSYmaS5vcmlnaW5hbEV2ZW50JiZpLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXMmJmkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXSYmKGkucGFnZVg9aS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYLGkucGFnZVk9aS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VZLGkudGFyZ2V0PWwuZWxlbWVudEZyb21Qb2ludChpLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVgtd2luZG93LnBhZ2VYT2Zmc2V0LGkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWS13aW5kb3cucGFnZVlPZmZzZXQpKSx0LmlzX2Rvd24pe2lmKCF0LmlzX2RyYWcpe2lmKCEoTWF0aC5hYnMoaS5wYWdlWC10LmluaXRfeCk+KHQuaXNfdG91Y2g/ZS52YWthdGEuZG5kLnNldHRpbmdzLnRocmVzaG9sZF90b3VjaDplLnZha2F0YS5kbmQuc2V0dGluZ3MudGhyZXNob2xkKXx8TWF0aC5hYnMoaS5wYWdlWS10LmluaXRfeSk+KHQuaXNfdG91Y2g/ZS52YWthdGEuZG5kLnNldHRpbmdzLnRocmVzaG9sZF90b3VjaDplLnZha2F0YS5kbmQuc2V0dGluZ3MudGhyZXNob2xkKSkpcmV0dXJuO3QuaGVscGVyJiYodC5oZWxwZXIuYXBwZW5kVG8oXCJib2R5XCIpLHQuaGVscGVyX3c9dC5oZWxwZXIub3V0ZXJXaWR0aCgpKSx0LmlzX2RyYWc9ITAsZS52YWthdGEuZG5kLl90cmlnZ2VyKFwic3RhcnRcIixpKX12YXIgcj0hMSxzPSExLG49ITEsYT0hMSxvPSExLGQ9ITEsYz0hMSxoPSExLF89ITEsdT0hMTtyZXR1cm4gdC5zY3JvbGxfdD0wLHQuc2Nyb2xsX2w9MCx0LnNjcm9sbF9lPSExLGUoZShpLnRhcmdldCkucGFyZW50c1VudGlsKFwiYm9keVwiKS5hZGRCYWNrKCkuZ2V0KCkucmV2ZXJzZSgpKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4vXmF1dG98c2Nyb2xsJC8udGVzdChlKHRoaXMpLmNzcyhcIm92ZXJmbG93XCIpKSYmKHRoaXMuc2Nyb2xsSGVpZ2h0PnRoaXMub2Zmc2V0SGVpZ2h0fHx0aGlzLnNjcm9sbFdpZHRoPnRoaXMub2Zmc2V0V2lkdGgpfSkuZWFjaChmdW5jdGlvbigpe3ZhciByPWUodGhpcykscz1yLm9mZnNldCgpO3JldHVybiB0aGlzLnNjcm9sbEhlaWdodD50aGlzLm9mZnNldEhlaWdodCYmKHMudG9wK3IuaGVpZ2h0KCktaS5wYWdlWTxlLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3Byb3hpbWl0eSYmKHQuc2Nyb2xsX3Q9MSksaS5wYWdlWS1zLnRvcDxlLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3Byb3hpbWl0eSYmKHQuc2Nyb2xsX3Q9LTEpKSx0aGlzLnNjcm9sbFdpZHRoPnRoaXMub2Zmc2V0V2lkdGgmJihzLmxlZnQrci53aWR0aCgpLWkucGFnZVg8ZS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9wcm94aW1pdHkmJih0LnNjcm9sbF9sPTEpLGkucGFnZVgtcy5sZWZ0PGUudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYodC5zY3JvbGxfbD0tMSkpLHQuc2Nyb2xsX3R8fHQuc2Nyb2xsX2w/KHQuc2Nyb2xsX2U9ZSh0aGlzKSwhMSk6dm9pZCAwfSksdC5zY3JvbGxfZXx8KHI9ZShsKSxzPWUod2luZG93KSxuPXIuaGVpZ2h0KCksYT1zLmhlaWdodCgpLG89ci53aWR0aCgpLGQ9cy53aWR0aCgpLGM9ci5zY3JvbGxUb3AoKSxoPXIuc2Nyb2xsTGVmdCgpLG4+YSYmaS5wYWdlWS1jPGUudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYodC5zY3JvbGxfdD0tMSksbj5hJiZhLShpLnBhZ2VZLWMpPGUudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYodC5zY3JvbGxfdD0xKSxvPmQmJmkucGFnZVgtaDxlLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3Byb3hpbWl0eSYmKHQuc2Nyb2xsX2w9LTEpLG8+ZCYmZC0oaS5wYWdlWC1oKTxlLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3Byb3hpbWl0eSYmKHQuc2Nyb2xsX2w9MSksKHQuc2Nyb2xsX3R8fHQuc2Nyb2xsX2wpJiYodC5zY3JvbGxfZT1yKSksdC5zY3JvbGxfZSYmZS52YWthdGEuZG5kLl9zY3JvbGwoITApLHQuaGVscGVyJiYoXz1wYXJzZUludChpLnBhZ2VZK2UudmFrYXRhLmRuZC5zZXR0aW5ncy5oZWxwZXJfdG9wLDEwKSx1PXBhcnNlSW50KGkucGFnZVgrZS52YWthdGEuZG5kLnNldHRpbmdzLmhlbHBlcl9sZWZ0LDEwKSxuJiZfKzI1Pm4mJihfPW4tNTApLG8mJnUrdC5oZWxwZXJfdz5vJiYodT1vLSh0LmhlbHBlcl93KzIpKSx0LmhlbHBlci5jc3Moe2xlZnQ6dStcInB4XCIsdG9wOl8rXCJweFwifSkpLGUudmFrYXRhLmRuZC5fdHJpZ2dlcihcIm1vdmVcIixpKSwhMX19LHN0b3A6ZnVuY3Rpb24oaSl7aWYoXCJ0b3VjaGVuZFwiPT09aS50eXBlJiZpLm9yaWdpbmFsRXZlbnQmJmkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmaS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoaS5wYWdlWD1pLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVgsaS5wYWdlWT1pLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVksaS50YXJnZXQ9bC5lbGVtZW50RnJvbVBvaW50KGkub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWC13aW5kb3cucGFnZVhPZmZzZXQsaS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VZLXdpbmRvdy5wYWdlWU9mZnNldCkpLHQuaXNfZHJhZyllLnZha2F0YS5kbmQuX3RyaWdnZXIoXCJzdG9wXCIsaSk7ZWxzZSBpZihcInRvdWNoZW5kXCI9PT1pLnR5cGUmJmkudGFyZ2V0PT09dC50YXJnZXQpe3ZhciByPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlKGkudGFyZ2V0KS5jbGljaygpfSwxMDApO2UoaS50YXJnZXQpLm9uZShcImNsaWNrXCIsZnVuY3Rpb24oKXtyJiZjbGVhclRpbWVvdXQocil9KX1yZXR1cm4gZS52YWthdGEuZG5kLl9jbGVhbigpLCExfX19KGUpLGUuanN0cmVlLmRlZmF1bHRzLm1hc3Nsb2FkPW51bGwsZS5qc3RyZWUucGx1Z2lucy5tYXNzbG9hZD1mdW5jdGlvbih0LGkpe3RoaXMuaW5pdD1mdW5jdGlvbihlLHQpe2kuaW5pdC5jYWxsKHRoaXMsZSx0KSx0aGlzLl9kYXRhLm1hc3Nsb2FkPXt9fSx0aGlzLl9sb2FkX25vZGVzPWZ1bmN0aW9uKHQscixzKXt2YXIgbj10aGlzLnNldHRpbmdzLm1hc3Nsb2FkO3JldHVybiBzJiYhZS5pc0VtcHR5T2JqZWN0KHRoaXMuX2RhdGEubWFzc2xvYWQpP2kuX2xvYWRfbm9kZXMuY2FsbCh0aGlzLHQscixzKTplLmlzRnVuY3Rpb24obik/bi5jYWxsKHRoaXMsdCxlLnByb3h5KGZ1bmN0aW9uKGUpe2lmKGUpZm9yKHZhciBuIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShuKSYmKHRoaXMuX2RhdGEubWFzc2xvYWRbbl09ZVtuXSk7aS5fbG9hZF9ub2Rlcy5jYWxsKHRoaXMsdCxyLHMpfSx0aGlzKSk6XCJvYmplY3RcIj09dHlwZW9mIG4mJm4mJm4udXJsPyhuPWUuZXh0ZW5kKCEwLHt9LG4pLGUuaXNGdW5jdGlvbihuLnVybCkmJihuLnVybD1uLnVybC5jYWxsKHRoaXMsdCkpLGUuaXNGdW5jdGlvbihuLmRhdGEpJiYobi5kYXRhPW4uZGF0YS5jYWxsKHRoaXMsdCkpLGUuYWpheChuKS5kb25lKGUucHJveHkoZnVuY3Rpb24oZSxuLGEpe2lmKGUpZm9yKHZhciBvIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShvKSYmKHRoaXMuX2RhdGEubWFzc2xvYWRbb109ZVtvXSk7aS5fbG9hZF9ub2Rlcy5jYWxsKHRoaXMsdCxyLHMpfSx0aGlzKSkuZmFpbChlLnByb3h5KGZ1bmN0aW9uKGUpe2kuX2xvYWRfbm9kZXMuY2FsbCh0aGlzLHQscixzKX0sdGhpcykpKTppLl9sb2FkX25vZGVzLmNhbGwodGhpcyx0LHIscyl9LHRoaXMuX2xvYWRfbm9kZT1mdW5jdGlvbih0LHIpe3ZhciBzPXRoaXMuX2RhdGEubWFzc2xvYWRbdC5pZF07cmV0dXJuIHM/dGhpc1tcInN0cmluZ1wiPT10eXBlb2Ygcz9cIl9hcHBlbmRfaHRtbF9kYXRhXCI6XCJfYXBwZW5kX2pzb25fZGF0YVwiXSh0LFwic3RyaW5nXCI9PXR5cGVvZiBzP2UoZS5wYXJzZUhUTUwocykpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAzIT09dGhpcy5ub2RlVHlwZX0pOnMsZnVuY3Rpb24oZSl7ci5jYWxsKHRoaXMsZSksZGVsZXRlIHRoaXMuX2RhdGEubWFzc2xvYWRbdC5pZF19KTppLl9sb2FkX25vZGUuY2FsbCh0aGlzLHQscil9fSxlLmpzdHJlZS5kZWZhdWx0cy5zZWFyY2g9e2FqYXg6ITEsZnV6enk6ITEsY2FzZV9zZW5zaXRpdmU6ITEsc2hvd19vbmx5X21hdGNoZXM6ITEsc2hvd19vbmx5X21hdGNoZXNfY2hpbGRyZW46ITEsY2xvc2Vfb3BlbmVkX29uY2xlYXI6ITAsc2VhcmNoX2xlYXZlc19vbmx5OiExLHNlYXJjaF9jYWxsYmFjazohMX0sZS5qc3RyZWUucGx1Z2lucy5zZWFyY2g9ZnVuY3Rpb24oaSxyKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtyLmJpbmQuY2FsbCh0aGlzKSx0aGlzLl9kYXRhLnNlYXJjaC5zdHI9XCJcIix0aGlzLl9kYXRhLnNlYXJjaC5kb209ZSgpLHRoaXMuX2RhdGEuc2VhcmNoLnJlcz1bXSx0aGlzLl9kYXRhLnNlYXJjaC5vcG49W10sdGhpcy5fZGF0YS5zZWFyY2guc29tPSExLHRoaXMuX2RhdGEuc2VhcmNoLnNtYz0hMSx0aGlzLl9kYXRhLnNlYXJjaC5oZG49W10sdGhpcy5lbGVtZW50Lm9uKFwic2VhcmNoLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24odCxpKXtpZih0aGlzLl9kYXRhLnNlYXJjaC5zb20mJmkucmVzLmxlbmd0aCl7dmFyIHIscyxuPXRoaXMuX21vZGVsLmRhdGEsYT1bXTtmb3Iocj0wLHM9aS5yZXMubGVuZ3RoO3M+cjtyKyspbltpLnJlc1tyXV0mJiFuW2kucmVzW3JdXS5zdGF0ZS5oaWRkZW4mJihhLnB1c2goaS5yZXNbcl0pLGE9YS5jb25jYXQobltpLnJlc1tyXV0ucGFyZW50cyksdGhpcy5fZGF0YS5zZWFyY2guc21jJiYoYT1hLmNvbmNhdChuW2kucmVzW3JdXS5jaGlsZHJlbl9kKSkpO2E9ZS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW0oZS52YWthdGEuYXJyYXlfdW5pcXVlKGEpLGUuanN0cmVlLnJvb3QpLHRoaXMuX2RhdGEuc2VhcmNoLmhkbj10aGlzLmhpZGVfYWxsKCEwKSx0aGlzLnNob3dfbm9kZShhKX19LHRoaXMpKS5vbihcImNsZWFyX3NlYXJjaC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dGhpcy5fZGF0YS5zZWFyY2guc29tJiZ0LnJlcy5sZW5ndGgmJnRoaXMuc2hvd19ub2RlKHRoaXMuX2RhdGEuc2VhcmNoLmhkbil9LHRoaXMpKX0sdGhpcy5zZWFyY2g9ZnVuY3Rpb24oaSxyLHMsbixhLG8pe2lmKGk9PT0hMXx8XCJcIj09PWUudHJpbShpLnRvU3RyaW5nKCkpKXJldHVybiB0aGlzLmNsZWFyX3NlYXJjaCgpO249dGhpcy5nZXRfbm9kZShuKSxuPW4mJm4uaWQ/bi5pZDpudWxsLGk9aS50b1N0cmluZygpO3ZhciBkLGMsbD10aGlzLnNldHRpbmdzLnNlYXJjaCxoPWwuYWpheD9sLmFqYXg6ITEsXz10aGlzLl9tb2RlbC5kYXRhLHU9bnVsbCxnPVtdLGY9W107aWYodGhpcy5fZGF0YS5zZWFyY2gucmVzLmxlbmd0aCYmIWEmJnRoaXMuY2xlYXJfc2VhcmNoKCkscz09PXQmJihzPWwuc2hvd19vbmx5X21hdGNoZXMpLG89PT10JiYobz1sLnNob3dfb25seV9tYXRjaGVzX2NoaWxkcmVuKSwhciYmaCE9PSExKXJldHVybiBlLmlzRnVuY3Rpb24oaCk/aC5jYWxsKHRoaXMsaSxlLnByb3h5KGZ1bmN0aW9uKHQpe3QmJnQuZCYmKHQ9dC5kKSx0aGlzLl9sb2FkX25vZGVzKGUuaXNBcnJheSh0KT9lLnZha2F0YS5hcnJheV91bmlxdWUodCk6W10sZnVuY3Rpb24oKXt0aGlzLnNlYXJjaChpLCEwLHMsbixhKX0sITApfSx0aGlzKSxuKTooaD1lLmV4dGVuZCh7fSxoKSxoLmRhdGF8fChoLmRhdGE9e30pLGguZGF0YS5zdHI9aSxuJiYoaC5kYXRhLmluc2lkZT1uKSxlLmFqYXgoaCkuZmFpbChlLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiYWpheFwiLHBsdWdpbjpcInNlYXJjaFwiLGlkOlwic2VhcmNoXzAxXCIscmVhc29uOlwiQ291bGQgbm90IGxvYWQgc2VhcmNoIHBhcmVudHNcIixkYXRhOkpTT04uc3RyaW5naWZ5KGgpfSx0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKX0sdGhpcykpLmRvbmUoZS5wcm94eShmdW5jdGlvbih0KXt0JiZ0LmQmJih0PXQuZCksdGhpcy5fbG9hZF9ub2RlcyhlLmlzQXJyYXkodCk/ZS52YWthdGEuYXJyYXlfdW5pcXVlKHQpOltdLGZ1bmN0aW9uKCl7dGhpcy5zZWFyY2goaSwhMCxzLG4sYSl9LCEwKX0sdGhpcykpKTtpZihhfHwodGhpcy5fZGF0YS5zZWFyY2guc3RyPWksdGhpcy5fZGF0YS5zZWFyY2guZG9tPWUoKSx0aGlzLl9kYXRhLnNlYXJjaC5yZXM9W10sdGhpcy5fZGF0YS5zZWFyY2gub3BuPVtdLHRoaXMuX2RhdGEuc2VhcmNoLnNvbT1zLHRoaXMuX2RhdGEuc2VhcmNoLnNtYz1vKSx1PW5ldyBlLnZha2F0YS5zZWFyY2goaSwhMCx7Y2FzZVNlbnNpdGl2ZTpsLmNhc2Vfc2Vuc2l0aXZlLGZ1enp5OmwuZnV6enl9KSxlLmVhY2goX1tuP246ZS5qc3RyZWUucm9vdF0uY2hpbGRyZW5fZCxmdW5jdGlvbihlLHQpe3ZhciByPV9bdF07ci50ZXh0JiYoIWwuc2VhcmNoX2xlYXZlc19vbmx5fHxyLnN0YXRlLmxvYWRlZCYmMD09PXIuY2hpbGRyZW4ubGVuZ3RoKSYmKGwuc2VhcmNoX2NhbGxiYWNrJiZsLnNlYXJjaF9jYWxsYmFjay5jYWxsKHRoaXMsaSxyKXx8IWwuc2VhcmNoX2NhbGxiYWNrJiZ1LnNlYXJjaChyLnRleHQpLmlzTWF0Y2gpJiYoZy5wdXNoKHQpLGY9Zi5jb25jYXQoci5wYXJlbnRzKSl9KSxnLmxlbmd0aCl7Zm9yKGY9ZS52YWthdGEuYXJyYXlfdW5pcXVlKGYpLGQ9MCxjPWYubGVuZ3RoO2M+ZDtkKyspZltkXSE9PWUuanN0cmVlLnJvb3QmJl9bZltkXV0mJnRoaXMub3Blbl9ub2RlKGZbZF0sbnVsbCwwKT09PSEwJiZ0aGlzLl9kYXRhLnNlYXJjaC5vcG4ucHVzaChmW2RdKTthPyh0aGlzLl9kYXRhLnNlYXJjaC5kb209dGhpcy5fZGF0YS5zZWFyY2guZG9tLmFkZChlKHRoaXMuZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiI1wiK2UubWFwKGcsZnVuY3Rpb24odCl7cmV0dXJuLTEhPT1cIjAxMjM0NTY3ODlcIi5pbmRleE9mKHRbMF0pP1wiXFxcXDNcIit0WzBdK1wiIFwiK3Quc3Vic3RyKDEpLnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKTp0LnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKX0pLmpvaW4oXCIsICNcIikpKSksdGhpcy5fZGF0YS5zZWFyY2gucmVzPWUudmFrYXRhLmFycmF5X3VuaXF1ZSh0aGlzLl9kYXRhLnNlYXJjaC5yZXMuY29uY2F0KGcpKSk6KHRoaXMuX2RhdGEuc2VhcmNoLmRvbT1lKHRoaXMuZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiI1wiK2UubWFwKGcsZnVuY3Rpb24odCl7cmV0dXJuLTEhPT1cIjAxMjM0NTY3ODlcIi5pbmRleE9mKHRbMF0pP1wiXFxcXDNcIit0WzBdK1wiIFwiK3Quc3Vic3RyKDEpLnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKTp0LnJlcGxhY2UoZS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKX0pLmpvaW4oXCIsICNcIikpKSx0aGlzLl9kYXRhLnNlYXJjaC5yZXM9ZyksdGhpcy5fZGF0YS5zZWFyY2guZG9tLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MoXCJqc3RyZWUtc2VhcmNoXCIpfXRoaXMudHJpZ2dlcihcInNlYXJjaFwiLHtub2Rlczp0aGlzLl9kYXRhLnNlYXJjaC5kb20sc3RyOmkscmVzOnRoaXMuX2RhdGEuc2VhcmNoLnJlcyxzaG93X29ubHlfbWF0Y2hlczpzfSl9LHRoaXMuY2xlYXJfc2VhcmNoPWZ1bmN0aW9uKCl7dGhpcy5zZXR0aW5ncy5zZWFyY2guY2xvc2Vfb3BlbmVkX29uY2xlYXImJnRoaXMuY2xvc2Vfbm9kZSh0aGlzLl9kYXRhLnNlYXJjaC5vcG4sMCksdGhpcy50cmlnZ2VyKFwiY2xlYXJfc2VhcmNoXCIse25vZGVzOnRoaXMuX2RhdGEuc2VhcmNoLmRvbSxzdHI6dGhpcy5fZGF0YS5zZWFyY2guc3RyLHJlczp0aGlzLl9kYXRhLnNlYXJjaC5yZXN9KSx0aGlzLl9kYXRhLnNlYXJjaC5yZXMubGVuZ3RoJiYodGhpcy5fZGF0YS5zZWFyY2guZG9tPWUodGhpcy5lbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCIjXCIrZS5tYXAodGhpcy5fZGF0YS5zZWFyY2gucmVzLGZ1bmN0aW9uKHQpe3JldHVybi0xIT09XCIwMTIzNDU2Nzg5XCIuaW5kZXhPZih0WzBdKT9cIlxcXFwzXCIrdFswXStcIiBcIit0LnN1YnN0cigxKS5yZXBsYWNlKGUuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIik6dC5yZXBsYWNlKGUuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIil9KS5qb2luKFwiLCAjXCIpKSksdGhpcy5fZGF0YS5zZWFyY2guZG9tLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtc2VhcmNoXCIpKSx0aGlzLl9kYXRhLnNlYXJjaC5zdHI9XCJcIix0aGlzLl9kYXRhLnNlYXJjaC5yZXM9W10sdGhpcy5fZGF0YS5zZWFyY2gub3BuPVtdLHRoaXMuX2RhdGEuc2VhcmNoLmRvbT1lKCl9LHRoaXMucmVkcmF3X25vZGU9ZnVuY3Rpb24odCxpLHMsbil7aWYodD1yLnJlZHJhd19ub2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0JiYtMSE9PWUuaW5BcnJheSh0LmlkLHRoaXMuX2RhdGEuc2VhcmNoLnJlcykpe3ZhciBhLG8sZD1udWxsO2ZvcihhPTAsbz10LmNoaWxkTm9kZXMubGVuZ3RoO28+YTthKyspaWYodC5jaGlsZE5vZGVzW2FdJiZ0LmNoaWxkTm9kZXNbYV0uY2xhc3NOYW1lJiYtMSE9PXQuY2hpbGROb2Rlc1thXS5jbGFzc05hbWUuaW5kZXhPZihcImpzdHJlZS1hbmNob3JcIikpe2Q9dC5jaGlsZE5vZGVzW2FdO2JyZWFrfWQmJihkLmNsYXNzTmFtZSs9XCIganN0cmVlLXNlYXJjaFwiKX1yZXR1cm4gdH19LGZ1bmN0aW9uKGUpe2UudmFrYXRhLnNlYXJjaD1mdW5jdGlvbih0LGkscil7cj1yfHx7fSxyPWUuZXh0ZW5kKHt9LGUudmFrYXRhLnNlYXJjaC5kZWZhdWx0cyxyKSxyLmZ1enp5IT09ITEmJihyLmZ1enp5PSEwKSx0PXIuY2FzZVNlbnNpdGl2ZT90OnQudG9Mb3dlckNhc2UoKTt2YXIgcyxuLGEsbyxkPXIubG9jYXRpb24sYz1yLmRpc3RhbmNlLGw9ci50aHJlc2hvbGQsaD10Lmxlbmd0aDtyZXR1cm4gaD4zMiYmKHIuZnV6enk9ITEpLHIuZnV6enkmJihzPTE8PGgtMSxuPWZ1bmN0aW9uKCl7dmFyIGU9e30saT0wO2ZvcihpPTA7aD5pO2krKyllW3QuY2hhckF0KGkpXT0wO2ZvcihpPTA7aD5pO2krKyllW3QuY2hhckF0KGkpXXw9MTw8aC1pLTE7cmV0dXJuIGV9KCksYT1mdW5jdGlvbihlLHQpe3ZhciBpPWUvaCxyPU1hdGguYWJzKGQtdCk7cmV0dXJuIGM/aStyL2M6cj8xOml9KSxvPWZ1bmN0aW9uKGUpe2lmKGU9ci5jYXNlU2Vuc2l0aXZlP2U6ZS50b0xvd2VyQ2FzZSgpLHQ9PT1lfHwtMSE9PWUuaW5kZXhPZih0KSlyZXR1cm57aXNNYXRjaDohMCxzY29yZTowfTtpZighci5mdXp6eSlyZXR1cm57aXNNYXRjaDohMSxzY29yZToxfTt2YXIgaSxvLGMsXyx1LGcsZixwLG0sdj1lLmxlbmd0aCxqPWwseT1lLmluZGV4T2YodCxkKSxrPWgrdix4PTEsYj1bXTtmb3IoLTEhPT15JiYoaj1NYXRoLm1pbihhKDAseSksaikseT1lLmxhc3RJbmRleE9mKHQsZCtoKSwtMSE9PXkmJihqPU1hdGgubWluKGEoMCx5KSxqKSkpLHk9LTEsaT0wO2g+aTtpKyspe2ZvcihjPTAsXz1rO18+YzspYShpLGQrXyk8PWo/Yz1fOms9XyxfPU1hdGguZmxvb3IoKGstYykvMitjKTtmb3Ioaz1fLGc9TWF0aC5tYXgoMSxkLV8rMSksZj1NYXRoLm1pbihkK18sdikraCxwPW5ldyBBcnJheShmKzIpLHBbZisxXT0oMTw8aSktMSxvPWY7bz49ZztvLS0paWYobT1uW2UuY2hhckF0KG8tMSldLDA9PT1pP3Bbb109KHBbbysxXTw8MXwxKSZtOnBbb109KHBbbysxXTw8MXwxKSZtfCgodVtvKzFdfHVbb10pPDwxfDEpfHVbbysxXSxwW29dJnMmJih4PWEoaSxvLTEpLGo+PXgpKXtpZihqPXgseT1vLTEsYi5wdXNoKHkpLCEoeT5kKSlicmVhaztnPU1hdGgubWF4KDEsMipkLXkpfWlmKGEoaSsxLGQpPmopYnJlYWs7dT1wfXJldHVybntpc01hdGNoOnk+PTAsc2NvcmU6eH19LGk9PT0hMD97c2VhcmNoOm99Om8oaSl9LGUudmFrYXRhLnNlYXJjaC5kZWZhdWx0cz17bG9jYXRpb246MCxkaXN0YW5jZToxMDAsdGhyZXNob2xkOi42LGZ1enp5OiExLGNhc2VTZW5zaXRpdmU6ITF9fShlKSxlLmpzdHJlZS5kZWZhdWx0cy5zb3J0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZ2V0X3RleHQoZSk+dGhpcy5nZXRfdGV4dCh0KT8xOi0xfSxlLmpzdHJlZS5wbHVnaW5zLnNvcnQ9ZnVuY3Rpb24odCxpKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtpLmJpbmQuY2FsbCh0aGlzKSx0aGlzLmVsZW1lbnQub24oXCJtb2RlbC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dGhpcy5zb3J0KHQucGFyZW50LCEwKX0sdGhpcykpLm9uKFwicmVuYW1lX25vZGUuanN0cmVlIGNyZWF0ZV9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0KXt0aGlzLnNvcnQodC5wYXJlbnR8fHQubm9kZS5wYXJlbnQsITEpLHRoaXMucmVkcmF3X25vZGUodC5wYXJlbnR8fHQubm9kZS5wYXJlbnQsITApfSx0aGlzKSkub24oXCJtb3ZlX25vZGUuanN0cmVlIGNvcHlfbm9kZS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dGhpcy5zb3J0KHQucGFyZW50LCExKSx0aGlzLnJlZHJhd19ub2RlKHQucGFyZW50LCEwKX0sdGhpcykpfSx0aGlzLnNvcnQ9ZnVuY3Rpb24odCxpKXt2YXIgcixzO2lmKHQ9dGhpcy5nZXRfbm9kZSh0KSx0JiZ0LmNoaWxkcmVuJiZ0LmNoaWxkcmVuLmxlbmd0aCYmKHQuY2hpbGRyZW4uc29ydChlLnByb3h5KHRoaXMuc2V0dGluZ3Muc29ydCx0aGlzKSksaSkpZm9yKHI9MCxzPXQuY2hpbGRyZW5fZC5sZW5ndGg7cz5yO3IrKyl0aGlzLnNvcnQodC5jaGlsZHJlbl9kW3JdLCExKX19O3ZhciB1PSExO2UuanN0cmVlLmRlZmF1bHRzLnN0YXRlPXtrZXk6XCJqc3RyZWVcIixldmVudHM6XCJjaGFuZ2VkLmpzdHJlZSBvcGVuX25vZGUuanN0cmVlIGNsb3NlX25vZGUuanN0cmVlIGNoZWNrX25vZGUuanN0cmVlIHVuY2hlY2tfbm9kZS5qc3RyZWVcIix0dGw6ITEsZmlsdGVyOiExfSxlLmpzdHJlZS5wbHVnaW5zLnN0YXRlPWZ1bmN0aW9uKHQsaSl7dGhpcy5iaW5kPWZ1bmN0aW9uKCl7aS5iaW5kLmNhbGwodGhpcyk7dmFyIHQ9ZS5wcm94eShmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5vbih0aGlzLnNldHRpbmdzLnN0YXRlLmV2ZW50cyxlLnByb3h5KGZ1bmN0aW9uKCl7dSYmY2xlYXJUaW1lb3V0KHUpLHU9c2V0VGltZW91dChlLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5zYXZlX3N0YXRlKCl9LHRoaXMpLDEwMCl9LHRoaXMpKSx0aGlzLnRyaWdnZXIoXCJzdGF0ZV9yZWFkeVwiKX0sdGhpcyk7dGhpcy5lbGVtZW50Lm9uKFwicmVhZHkuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLGkpe3RoaXMuZWxlbWVudC5vbmUoXCJyZXN0b3JlX3N0YXRlLmpzdHJlZVwiLHQpLHRoaXMucmVzdG9yZV9zdGF0ZSgpfHx0KCl9LHRoaXMpKX0sdGhpcy5zYXZlX3N0YXRlPWZ1bmN0aW9uKCl7dmFyIHQ9e3N0YXRlOnRoaXMuZ2V0X3N0YXRlKCksdHRsOnRoaXMuc2V0dGluZ3Muc3RhdGUudHRsLHNlYzorbmV3IERhdGV9O2UudmFrYXRhLnN0b3JhZ2Uuc2V0KHRoaXMuc2V0dGluZ3Muc3RhdGUua2V5LEpTT04uc3RyaW5naWZ5KHQpKX0sdGhpcy5yZXN0b3JlX3N0YXRlPWZ1bmN0aW9uKCl7dmFyIHQ9ZS52YWthdGEuc3RvcmFnZS5nZXQodGhpcy5zZXR0aW5ncy5zdGF0ZS5rZXkpO2lmKHQpdHJ5e3Q9SlNPTi5wYXJzZSh0KX1jYXRjaChpKXtyZXR1cm4hMX1yZXR1cm4gdCYmdC50dGwmJnQuc2VjJiYrbmV3IERhdGUtdC5zZWM+dC50dGw/ITE6KHQmJnQuc3RhdGUmJih0PXQuc3RhdGUpLHQmJmUuaXNGdW5jdGlvbih0aGlzLnNldHRpbmdzLnN0YXRlLmZpbHRlcikmJih0PXRoaXMuc2V0dGluZ3Muc3RhdGUuZmlsdGVyLmNhbGwodGhpcyx0KSksdD8odGhpcy5lbGVtZW50Lm9uZShcInNldF9zdGF0ZS5qc3RyZWVcIixmdW5jdGlvbihpLHIpe3IuaW5zdGFuY2UudHJpZ2dlcihcInJlc3RvcmVfc3RhdGVcIix7c3RhdGU6ZS5leHRlbmQoITAse30sdCl9KX0pLHRoaXMuc2V0X3N0YXRlKHQpLCEwKTohMSl9LHRoaXMuY2xlYXJfc3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gZS52YWthdGEuc3RvcmFnZS5kZWwodGhpcy5zZXR0aW5ncy5zdGF0ZS5rZXkpfX0sZnVuY3Rpb24oZSx0KXtlLnZha2F0YS5zdG9yYWdlPXtzZXQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGUsdCl9LGdldDpmdW5jdGlvbihlKXtyZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpfSxkZWw6ZnVuY3Rpb24oZSl7cmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShlKX19fShlKSxlLmpzdHJlZS5kZWZhdWx0cy50eXBlcz17XCJkZWZhdWx0XCI6e319LGUuanN0cmVlLmRlZmF1bHRzLnR5cGVzW2UuanN0cmVlLnJvb3RdPXt9LGUuanN0cmVlLnBsdWdpbnMudHlwZXM9ZnVuY3Rpb24oaSxyKXt0aGlzLmluaXQ9ZnVuY3Rpb24oaSxzKXt2YXIgbixhO2lmKHMmJnMudHlwZXMmJnMudHlwZXNbXCJkZWZhdWx0XCJdKWZvcihuIGluIHMudHlwZXMpaWYoXCJkZWZhdWx0XCIhPT1uJiZuIT09ZS5qc3RyZWUucm9vdCYmcy50eXBlcy5oYXNPd25Qcm9wZXJ0eShuKSlmb3IoYSBpbiBzLnR5cGVzW1wiZGVmYXVsdFwiXSlzLnR5cGVzW1wiZGVmYXVsdFwiXS5oYXNPd25Qcm9wZXJ0eShhKSYmcy50eXBlc1tuXVthXT09PXQmJihzLnR5cGVzW25dW2FdPXMudHlwZXNbXCJkZWZhdWx0XCJdW2FdKTtyLmluaXQuY2FsbCh0aGlzLGkscyksdGhpcy5fbW9kZWwuZGF0YVtlLmpzdHJlZS5yb290XS50eXBlPWUuanN0cmVlLnJvb3R9LHRoaXMucmVmcmVzaD1mdW5jdGlvbih0LGkpe3IucmVmcmVzaC5jYWxsKHRoaXMsdCxpKSx0aGlzLl9tb2RlbC5kYXRhW2UuanN0cmVlLnJvb3RdLnR5cGU9ZS5qc3RyZWUucm9vdH0sdGhpcy5iaW5kPWZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50Lm9uKFwibW9kZWwuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihpLHIpe3ZhciBzLG4sYT10aGlzLl9tb2RlbC5kYXRhLG89ci5ub2RlcyxkPXRoaXMuc2V0dGluZ3MudHlwZXMsYz1cImRlZmF1bHRcIjtmb3Iocz0wLG49by5sZW5ndGg7bj5zO3MrKyljPVwiZGVmYXVsdFwiLGFbb1tzXV0ub3JpZ2luYWwmJmFbb1tzXV0ub3JpZ2luYWwudHlwZSYmZFthW29bc11dLm9yaWdpbmFsLnR5cGVdJiYoYz1hW29bc11dLm9yaWdpbmFsLnR5cGUpLGFbb1tzXV0uZGF0YSYmYVtvW3NdXS5kYXRhLmpzdHJlZSYmYVtvW3NdXS5kYXRhLmpzdHJlZS50eXBlJiZkW2Fbb1tzXV0uZGF0YS5qc3RyZWUudHlwZV0mJihjPWFbb1tzXV0uZGF0YS5qc3RyZWUudHlwZSksYVtvW3NdXS50eXBlPWMsYVtvW3NdXS5pY29uPT09ITAmJmRbY10uaWNvbiE9PXQmJihhW29bc11dLmljb249ZFtjXS5pY29uKTthW2UuanN0cmVlLnJvb3RdLnR5cGU9ZS5qc3RyZWUucm9vdH0sdGhpcykpLHIuYmluZC5jYWxsKHRoaXMpfSx0aGlzLmdldF9qc29uPWZ1bmN0aW9uKHQsaSxzKXt2YXIgbixhLG89dGhpcy5fbW9kZWwuZGF0YSxkPWk/ZS5leHRlbmQoITAse30saSx7bm9faWQ6ITF9KTp7fSxjPXIuZ2V0X2pzb24uY2FsbCh0aGlzLHQsZCxzKTtpZihjPT09ITEpcmV0dXJuITE7aWYoZS5pc0FycmF5KGMpKWZvcihuPTAsYT1jLmxlbmd0aDthPm47bisrKWNbbl0udHlwZT1jW25dLmlkJiZvW2Nbbl0uaWRdJiZvW2Nbbl0uaWRdLnR5cGU/b1tjW25dLmlkXS50eXBlOlwiZGVmYXVsdFwiLGkmJmkubm9faWQmJihkZWxldGUgY1tuXS5pZCxjW25dLmxpX2F0dHImJmNbbl0ubGlfYXR0ci5pZCYmZGVsZXRlIGNbbl0ubGlfYXR0ci5pZCxjW25dLmFfYXR0ciYmY1tuXS5hX2F0dHIuaWQmJmRlbGV0ZSBjW25dLmFfYXR0ci5pZCk7ZWxzZSBjLnR5cGU9Yy5pZCYmb1tjLmlkXSYmb1tjLmlkXS50eXBlP29bYy5pZF0udHlwZTpcImRlZmF1bHRcIixpJiZpLm5vX2lkJiYoYz10aGlzLl9kZWxldGVfaWRzKGMpKTtyZXR1cm4gY30sdGhpcy5fZGVsZXRlX2lkcz1mdW5jdGlvbih0KXtpZihlLmlzQXJyYXkodCkpe2Zvcih2YXIgaT0wLHI9dC5sZW5ndGg7cj5pO2krKyl0W2ldPXRoaXMuX2RlbGV0ZV9pZHModFtpXSk7cmV0dXJuIHR9cmV0dXJuIGRlbGV0ZSB0LmlkLHQubGlfYXR0ciYmdC5saV9hdHRyLmlkJiZkZWxldGUgdC5saV9hdHRyLmlkLHQuYV9hdHRyJiZ0LmFfYXR0ci5pZCYmZGVsZXRlIHQuYV9hdHRyLmlkLHQuY2hpbGRyZW4mJmUuaXNBcnJheSh0LmNoaWxkcmVuKSYmKHQuY2hpbGRyZW49dGhpcy5fZGVsZXRlX2lkcyh0LmNoaWxkcmVuKSksdH0sdGhpcy5jaGVjaz1mdW5jdGlvbihpLHMsbixhLG8pe2lmKHIuY2hlY2suY2FsbCh0aGlzLGkscyxuLGEsbyk9PT0hMSlyZXR1cm4hMTtzPXMmJnMuaWQ/czp0aGlzLmdldF9ub2RlKHMpLG49biYmbi5pZD9uOnRoaXMuZ2V0X25vZGUobik7dmFyIGQsYyxsLGgsXz1zJiZzLmlkP28mJm8ub3JpZ2luP28ub3JpZ2luOmUuanN0cmVlLnJlZmVyZW5jZShzLmlkKTpudWxsO3N3aXRjaChfPV8mJl8uX21vZGVsJiZfLl9tb2RlbC5kYXRhP18uX21vZGVsLmRhdGE6bnVsbCxpKXtjYXNlXCJjcmVhdGVfbm9kZVwiOmNhc2VcIm1vdmVfbm9kZVwiOmNhc2VcImNvcHlfbm9kZVwiOmlmKFwibW92ZV9ub2RlXCIhPT1pfHwtMT09PWUuaW5BcnJheShzLmlkLG4uY2hpbGRyZW4pKXtpZihkPXRoaXMuZ2V0X3J1bGVzKG4pLGQubWF4X2NoaWxkcmVuIT09dCYmLTEhPT1kLm1heF9jaGlsZHJlbiYmZC5tYXhfY2hpbGRyZW49PT1uLmNoaWxkcmVuLmxlbmd0aClyZXR1cm4gdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ0eXBlc1wiLGlkOlwidHlwZXNfMDFcIixyZWFzb246XCJtYXhfY2hpbGRyZW4gcHJldmVudHMgZnVuY3Rpb246IFwiK2ksZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOmkscG9zOmEsb2JqOnMmJnMuaWQ/cy5pZDohMSxwYXI6biYmbi5pZD9uLmlkOiExfSl9LCExO2lmKGQudmFsaWRfY2hpbGRyZW4hPT10JiYtMSE9PWQudmFsaWRfY2hpbGRyZW4mJi0xPT09ZS5pbkFycmF5KHMudHlwZXx8XCJkZWZhdWx0XCIsZC52YWxpZF9jaGlsZHJlbikpcmV0dXJuIHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwidHlwZXNcIixpZDpcInR5cGVzXzAyXCIscmVhc29uOlwidmFsaWRfY2hpbGRyZW4gcHJldmVudHMgZnVuY3Rpb246IFwiK2ksZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOmkscG9zOmEsb2JqOnMmJnMuaWQ/cy5pZDohMSxwYXI6biYmbi5pZD9uLmlkOiExfSl9LCExO2lmKF8mJnMuY2hpbGRyZW5fZCYmcy5wYXJlbnRzKXtmb3IoYz0wLGw9MCxoPXMuY2hpbGRyZW5fZC5sZW5ndGg7aD5sO2wrKyljPU1hdGgubWF4KGMsX1tzLmNoaWxkcmVuX2RbbF1dLnBhcmVudHMubGVuZ3RoKTtjPWMtcy5wYXJlbnRzLmxlbmd0aCsxfSgwPj1jfHxjPT09dCkmJihjPTEpO2Rve2lmKGQubWF4X2RlcHRoIT09dCYmLTEhPT1kLm1heF9kZXB0aCYmZC5tYXhfZGVwdGg8YylyZXR1cm4gdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ0eXBlc1wiLGlkOlwidHlwZXNfMDNcIixyZWFzb246XCJtYXhfZGVwdGggcHJldmVudHMgZnVuY3Rpb246IFwiK2ksZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOmkscG9zOmEsb2JqOnMmJnMuaWQ/cy5pZDohMSxwYXI6biYmbi5pZD9uLmlkOiExfSl9LCExO249dGhpcy5nZXRfbm9kZShuLnBhcmVudCksZD10aGlzLmdldF9ydWxlcyhuKSxjKyt9d2hpbGUobil9fXJldHVybiEwfSx0aGlzLmdldF9ydWxlcz1mdW5jdGlvbihlKXtpZihlPXRoaXMuZ2V0X25vZGUoZSksIWUpcmV0dXJuITE7dmFyIGk9dGhpcy5nZXRfdHlwZShlLCEwKTtyZXR1cm4gaS5tYXhfZGVwdGg9PT10JiYoaS5tYXhfZGVwdGg9LTEpLGkubWF4X2NoaWxkcmVuPT09dCYmKGkubWF4X2NoaWxkcmVuPS0xKSxpLnZhbGlkX2NoaWxkcmVuPT09dCYmKGkudmFsaWRfY2hpbGRyZW49LTEpLGl9LHRoaXMuZ2V0X3R5cGU9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdD10aGlzLmdldF9ub2RlKHQpLHQ/aT9lLmV4dGVuZCh7dHlwZTp0LnR5cGV9LHRoaXMuc2V0dGluZ3MudHlwZXNbdC50eXBlXSk6dC50eXBlOiExfSx0aGlzLnNldF90eXBlPWZ1bmN0aW9uKGkscil7dmFyIHMsbixhLG8sZDtpZihlLmlzQXJyYXkoaSkpe2ZvcihpPWkuc2xpY2UoKSxuPTAsYT1pLmxlbmd0aDthPm47bisrKXRoaXMuc2V0X3R5cGUoaVtuXSxyKTtyZXR1cm4hMH1yZXR1cm4gcz10aGlzLnNldHRpbmdzLnR5cGVzLGk9dGhpcy5nZXRfbm9kZShpKSxzW3JdJiZpPyhvPWkudHlwZSxkPXRoaXMuZ2V0X2ljb24oaSksaS50eXBlPXIsKGQ9PT0hMHx8c1tvXSYmc1tvXS5pY29uIT09dCYmZD09PXNbb10uaWNvbikmJnRoaXMuc2V0X2ljb24oaSxzW3JdLmljb24hPT10P3Nbcl0uaWNvbjohMCksITApOiExfX0sZS5qc3RyZWUuZGVmYXVsdHMudW5pcXVlPXtjYXNlX3NlbnNpdGl2ZTohMSxkdXBsaWNhdGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZStcIiAoXCIrdCtcIilcIn19LGUuanN0cmVlLnBsdWdpbnMudW5pcXVlPWZ1bmN0aW9uKGkscil7dGhpcy5jaGVjaz1mdW5jdGlvbih0LGkscyxuLGEpe2lmKHIuY2hlY2suY2FsbCh0aGlzLHQsaSxzLG4sYSk9PT0hMSlyZXR1cm4hMTtpZihpPWkmJmkuaWQ/aTp0aGlzLmdldF9ub2RlKGkpLHM9cyYmcy5pZD9zOnRoaXMuZ2V0X25vZGUocyksIXN8fCFzLmNoaWxkcmVuKXJldHVybiEwO3ZhciBvLGQsYz1cInJlbmFtZV9ub2RlXCI9PT10P246aS50ZXh0LGw9W10saD10aGlzLnNldHRpbmdzLnVuaXF1ZS5jYXNlX3NlbnNpdGl2ZSxfPXRoaXMuX21vZGVsLmRhdGE7Zm9yKG89MCxkPXMuY2hpbGRyZW4ubGVuZ3RoO2Q+bztvKyspbC5wdXNoKGg/X1tzLmNoaWxkcmVuW29dXS50ZXh0Ol9bcy5jaGlsZHJlbltvXV0udGV4dC50b0xvd2VyQ2FzZSgpKTtzd2l0Y2goaHx8KGM9Yy50b0xvd2VyQ2FzZSgpKSx0KXtjYXNlXCJkZWxldGVfbm9kZVwiOnJldHVybiEwO2Nhc2VcInJlbmFtZV9ub2RlXCI6cmV0dXJuIG89LTE9PT1lLmluQXJyYXkoYyxsKXx8aS50ZXh0JiZpLnRleHRbaD9cInRvU3RyaW5nXCI6XCJ0b0xvd2VyQ2FzZVwiXSgpPT09YyxvfHwodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ1bmlxdWVcIixpZDpcInVuaXF1ZV8wMVwiLHJlYXNvbjpcIkNoaWxkIHdpdGggbmFtZSBcIitjK1wiIGFscmVhZHkgZXhpc3RzLiBQcmV2ZW50aW5nOiBcIit0LGRhdGE6SlNPTi5zdHJpbmdpZnkoe2Noazp0LHBvczpuLG9iajppJiZpLmlkP2kuaWQ6ITEscGFyOnMmJnMuaWQ/cy5pZDohMX0pfSksbztjYXNlXCJjcmVhdGVfbm9kZVwiOnJldHVybiBvPS0xPT09ZS5pbkFycmF5KGMsbCksb3x8KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwidW5pcXVlXCIsaWQ6XCJ1bmlxdWVfMDRcIixyZWFzb246XCJDaGlsZCB3aXRoIG5hbWUgXCIrYytcIiBhbHJlYWR5IGV4aXN0cy4gUHJldmVudGluZzogXCIrdCxkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6dCxwb3M6bixvYmo6aSYmaS5pZD9pLmlkOiExLHBhcjpzJiZzLmlkP3MuaWQ6ITF9KX0pLG87Y2FzZVwiY29weV9ub2RlXCI6cmV0dXJuIG89LTE9PT1lLmluQXJyYXkoYyxsKSxvfHwodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ1bmlxdWVcIixpZDpcInVuaXF1ZV8wMlwiLHJlYXNvbjpcIkNoaWxkIHdpdGggbmFtZSBcIitjK1wiIGFscmVhZHkgZXhpc3RzLiBQcmV2ZW50aW5nOiBcIit0LGRhdGE6SlNPTi5zdHJpbmdpZnkoe2Noazp0LHBvczpuLG9iajppJiZpLmlkP2kuaWQ6ITEscGFyOnMmJnMuaWQ/cy5pZDohMX0pfSksbztjYXNlXCJtb3ZlX25vZGVcIjpyZXR1cm4gbz1pLnBhcmVudD09PXMuaWQmJighYXx8IWEuaXNfbXVsdGkpfHwtMT09PWUuaW5BcnJheShjLGwpLG98fCh0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcInVuaXF1ZVwiLGlkOlwidW5pcXVlXzAzXCIscmVhc29uOlwiQ2hpbGQgd2l0aCBuYW1lIFwiK2MrXCIgYWxyZWFkeSBleGlzdHMuIFByZXZlbnRpbmc6IFwiK3QsZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOnQscG9zOm4sb2JqOmkmJmkuaWQ/aS5pZDohMSxwYXI6cyYmcy5pZD9zLmlkOiExfSl9KSxvfXJldHVybiEwfSx0aGlzLmNyZWF0ZV9ub2RlPWZ1bmN0aW9uKGkscyxuLGEsbyl7aWYoIXN8fHMudGV4dD09PXQpe2lmKG51bGw9PT1pJiYoaT1lLmpzdHJlZS5yb290KSxpPXRoaXMuZ2V0X25vZGUoaSksIWkpcmV0dXJuIHIuY3JlYXRlX25vZGUuY2FsbCh0aGlzLGkscyxuLGEsbyk7aWYobj1uPT09dD9cImxhc3RcIjpuLCFuLnRvU3RyaW5nKCkubWF0Y2goL14oYmVmb3JlfGFmdGVyKSQvKSYmIW8mJiF0aGlzLmlzX2xvYWRlZChpKSlyZXR1cm4gci5jcmVhdGVfbm9kZS5jYWxsKHRoaXMsaSxzLG4sYSxvKTtzfHwocz17fSk7dmFyIGQsYyxsLGgsXyx1PXRoaXMuX21vZGVsLmRhdGEsZz10aGlzLnNldHRpbmdzLnVuaXF1ZS5jYXNlX3NlbnNpdGl2ZSxmPXRoaXMuc2V0dGluZ3MudW5pcXVlLmR1cGxpY2F0ZTtmb3IoYz1kPXRoaXMuZ2V0X3N0cmluZyhcIk5ldyBub2RlXCIpLGw9W10saD0wLF89aS5jaGlsZHJlbi5sZW5ndGg7Xz5oO2grKylsLnB1c2goZz91W2kuY2hpbGRyZW5baF1dLnRleHQ6dVtpLmNoaWxkcmVuW2hdXS50ZXh0LnRvTG93ZXJDYXNlKCkpO2ZvcihoPTE7LTEhPT1lLmluQXJyYXkoZz9jOmMudG9Mb3dlckNhc2UoKSxsKTspYz1mLmNhbGwodGhpcyxkLCsraCkudG9TdHJpbmcoKTtzLnRleHQ9Y31yZXR1cm4gci5jcmVhdGVfbm9kZS5jYWxsKHRoaXMsaSxzLG4sYSxvKX19O3ZhciBnPWwuY3JlYXRlRWxlbWVudChcIkRJVlwiKTtpZihnLnNldEF0dHJpYnV0ZShcInVuc2VsZWN0YWJsZVwiLFwib25cIiksZy5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJwcmVzZW50YXRpb25cIiksZy5jbGFzc05hbWU9XCJqc3RyZWUtd2hvbGVyb3dcIixnLmlubmVySFRNTD1cIiYjMTYwO1wiLGUuanN0cmVlLnBsdWdpbnMud2hvbGVyb3c9ZnVuY3Rpb24odCxpKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtpLmJpbmQuY2FsbCh0aGlzKSx0aGlzLmVsZW1lbnQub24oXCJyZWFkeS5qc3RyZWUgc2V0X3N0YXRlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oKXt0aGlzLmhpZGVfZG90cygpfSx0aGlzKSkub24oXCJpbml0LmpzdHJlZSBsb2FkaW5nLmpzdHJlZSByZWFkeS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5nZXRfY29udGFpbmVyX3VsKCkuYWRkQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctdWxcIil9LHRoaXMpKS5vbihcImRlc2VsZWN0X2FsbC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLXdob2xlcm93LWNsaWNrZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctY2xpY2tlZFwiKX0sdGhpcykpLm9uKFwiY2hhbmdlZC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLXdob2xlcm93LWNsaWNrZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctY2xpY2tlZFwiKTt2YXIgaSxyLHM9ITE7Zm9yKGk9MCxyPXQuc2VsZWN0ZWQubGVuZ3RoO3I+aTtpKyspcz10aGlzLmdldF9ub2RlKHQuc2VsZWN0ZWRbaV0sITApLHMmJnMubGVuZ3RoJiZzLmNoaWxkcmVuKFwiLmpzdHJlZS13aG9sZXJvd1wiKS5hZGRDbGFzcyhcImpzdHJlZS13aG9sZXJvdy1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJvcGVuX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3RoaXMuZ2V0X25vZGUodC5ub2RlLCEwKS5maW5kKFwiLmpzdHJlZS1jbGlja2VkXCIpLnBhcmVudCgpLmNoaWxkcmVuKFwiLmpzdHJlZS13aG9sZXJvd1wiKS5hZGRDbGFzcyhcImpzdHJlZS13aG9sZXJvdy1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJob3Zlcl9ub2RlLmpzdHJlZSBkZWhvdmVyX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe1wiaG92ZXJfbm9kZVwiPT09ZS50eXBlJiZ0aGlzLmlzX2Rpc2FibGVkKHQubm9kZSl8fHRoaXMuZ2V0X25vZGUodC5ub2RlLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtd2hvbGVyb3dcIilbXCJob3Zlcl9ub2RlXCI9PT1lLnR5cGU/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJqc3RyZWUtd2hvbGVyb3ctaG92ZXJlZFwiKX0sdGhpcykpLm9uKFwiY29udGV4dG1lbnUuanN0cmVlXCIsXCIuanN0cmVlLXdob2xlcm93XCIsZS5wcm94eShmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGk9ZS5FdmVudChcImNvbnRleHRtZW51XCIse21ldGFLZXk6dC5tZXRhS2V5LGN0cmxLZXk6dC5jdHJsS2V5LGFsdEtleTp0LmFsdEtleSxzaGlmdEtleTp0LnNoaWZ0S2V5LHBhZ2VYOnQucGFnZVgscGFnZVk6dC5wYWdlWX0pO2UodC5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZmlyc3QoKS50cmlnZ2VyKGkpfSx0aGlzKSkub24oXCJjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtd2hvbGVyb3dcIixmdW5jdGlvbih0KXt0LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO3ZhciBpPWUuRXZlbnQoXCJjbGlja1wiLHttZXRhS2V5OnQubWV0YUtleSxjdHJsS2V5OnQuY3RybEtleSxhbHRLZXk6dC5hbHRLZXksc2hpZnRLZXk6dC5zaGlmdEtleX0pO2UodC5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZmlyc3QoKS50cmlnZ2VyKGkpLmZvY3VzKCl9KS5vbihcImNsaWNrLmpzdHJlZVwiLFwiLmpzdHJlZS1sZWFmID4gLmpzdHJlZS1vY2xcIixlLnByb3h5KGZ1bmN0aW9uKHQpe3Quc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7dmFyIGk9ZS5FdmVudChcImNsaWNrXCIse21ldGFLZXk6dC5tZXRhS2V5LGN0cmxLZXk6dC5jdHJsS2V5LGFsdEtleTp0LmFsdEtleSxzaGlmdEtleTp0LnNoaWZ0S2V5fSk7ZSh0LmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5maXJzdCgpLnRyaWdnZXIoaSkuZm9jdXMoKX0sdGhpcykpLm9uKFwibW91c2VvdmVyLmpzdHJlZVwiLFwiLmpzdHJlZS13aG9sZXJvdywgLmpzdHJlZS1pY29uXCIsZS5wcm94eShmdW5jdGlvbihlKXtyZXR1cm4gZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0aGlzLmlzX2Rpc2FibGVkKGUuY3VycmVudFRhcmdldCl8fHRoaXMuaG92ZXJfbm9kZShlLmN1cnJlbnRUYXJnZXQpLCExfSx0aGlzKSkub24oXCJtb3VzZWxlYXZlLmpzdHJlZVwiLFwiLmpzdHJlZS1ub2RlXCIsZS5wcm94eShmdW5jdGlvbihlKXt0aGlzLmRlaG92ZXJfbm9kZShlLmN1cnJlbnRUYXJnZXQpfSx0aGlzKSl9LHRoaXMudGVhcmRvd249ZnVuY3Rpb24oKXt0aGlzLnNldHRpbmdzLndob2xlcm93JiZ0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtd2hvbGVyb3dcIikucmVtb3ZlKCksaS50ZWFyZG93bi5jYWxsKHRoaXMpfSx0aGlzLnJlZHJhd19ub2RlPWZ1bmN0aW9uKHQscixzLG4pe2lmKHQ9aS5yZWRyYXdfbm9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpe3ZhciBhPWcuY2xvbmVOb2RlKCEwKTstMSE9PWUuaW5BcnJheSh0LmlkLHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCkmJihhLmNsYXNzTmFtZSs9XCIganN0cmVlLXdob2xlcm93LWNsaWNrZWRcIiksdGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQmJnRoaXMuX2RhdGEuY29yZS5mb2N1c2VkPT09dC5pZCYmKGEuY2xhc3NOYW1lKz1cIiBqc3RyZWUtd2hvbGVyb3ctaG92ZXJlZFwiKSx0Lmluc2VydEJlZm9yZShhLHQuY2hpbGROb2Rlc1swXSl9cmV0dXJuIHR9fSxsLnJlZ2lzdGVyRWxlbWVudCYmT2JqZWN0JiZPYmplY3QuY3JlYXRlKXt2YXIgZj1PYmplY3QuY3JlYXRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSk7Zi5jcmVhdGVkQ2FsbGJhY2s9ZnVuY3Rpb24oKXt2YXIgdCxpPXtjb3JlOnt9LHBsdWdpbnM6W119O2Zvcih0IGluIGUuanN0cmVlLnBsdWdpbnMpZS5qc3RyZWUucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5hdHRyaWJ1dGVzW3RdJiYoaS5wbHVnaW5zLnB1c2godCksdGhpcy5nZXRBdHRyaWJ1dGUodCkmJkpTT04ucGFyc2UodGhpcy5nZXRBdHRyaWJ1dGUodCkpJiYoaVt0XT1KU09OLnBhcnNlKHRoaXMuZ2V0QXR0cmlidXRlKHQpKSkpO2Zvcih0IGluIGUuanN0cmVlLmRlZmF1bHRzLmNvcmUpZS5qc3RyZWUuZGVmYXVsdHMuY29yZS5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5hdHRyaWJ1dGVzW3RdJiYoaS5jb3JlW3RdPUpTT04ucGFyc2UodGhpcy5nZXRBdHRyaWJ1dGUodCkpfHx0aGlzLmdldEF0dHJpYnV0ZSh0KSk7ZSh0aGlzKS5qc3RyZWUoaSl9O3RyeXtsLnJlZ2lzdGVyRWxlbWVudChcInZha2F0YS1qc3RyZWVcIix7cHJvdG90eXBlOmZ9KX1jYXRjaChwKXt9fX19KTsiLCIvKlxuICogaHR0cDovL2dpdGh1Yi5jb20vZGVpdGNoL2pzdHJlZS1ncmlkXG4gKlxuICogVGhpcyBwbHVnaW4gaGFuZGxlcyBhZGRpbmcgYSBncmlkIHRvIGEgdHJlZSB0byBkaXNwbGF5IGFkZGl0aW9uYWwgZGF0YVxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZTpcbiAqICAgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcbiAqXG4gKiBXb3JrcyBvbmx5IHdpdGgganN0cmVlIHZlcnNpb24gPj0gMy4wLjBcbiAqXG4gKiAkRGF0ZTogMjAxNS0xMS0yOSAkXG4gKiAkUmV2aXNpb246ICAzLjQuMiAkXG4gKi9cbiFmdW5jdGlvbihlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImpxdWVyeVwiLFwianN0cmVlXCJdLGUpOmUoalF1ZXJ5KX0oZnVuY3Rpb24oZSl7dmFyIHQsaSxyLHMsZCxuPS9eXFxzKiQvZyxhPS9bXFxcXDomIV58KClcXFtcXF08PkAqJyt+I1wiOyw9IFxcLyR7fSVdL2csbz1mdW5jdGlvbihlKXtyZXR1cm4oZXx8XCJcIikucmVwbGFjZShhLFwiXFxcXCQmXCIpfSxsPVwiZGF0YS1qc3RyZWVncmlkXCIsaD1cIl9EQVRBX1wiLGM9MjQscD0hMSxnPVwianNncmlkX1wiLHU9XCJfY29sXCIsZj0xMCx2PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuZmluZChcImRpdltcIitsK1wiPSdcIit0K1wiJ11cIil9LG09ITEsaj1udWxsLF89MCx3PTA7cz0vPFxcLz9bXj5dKz4vZ2kscj1mdW5jdGlvbih0LGkpe3ZhciByLHMsZCxuO3JldHVybiBpLl9ncmlkU2V0dGluZ3M9aS5fZ3JpZFNldHRpbmdzfHx7fSxpLl9ncmlkU2V0dGluZ3MuaW5kZW50PjA/bj1pLl9ncmlkU2V0dGluZ3MuaW5kZW50OihyPWUoXCI8ZGl2PjwvZGl2PlwiKSxzPXQucHJldihcImlcIiksZD1zLnBhcmVudCgpLHIuYWRkQ2xhc3MoaS5nZXRfbm9kZShcIiNcIiwhMCkuYXR0cihcImNsYXNzXCIpKSxkLmFwcGVuZFRvKHIpLHIuYXBwZW5kVG8oZShcImJvZHlcIikpLG49cy53aWR0aCgpfHxjLGQuZGV0YWNoKCksci5yZW1vdmUoKSxpLl9ncmlkU2V0dGluZ3MuaW5kZW50PW4pLG59LGQ9ZnVuY3Rpb24oZSx0KXt2YXIgaSxyPWUuZ2V0X25vZGUodCkscz1yLmNoaWxkcmVuO3JldHVybiBpPSFzfHxzLmxlbmd0aDw9MHx8IXIuc3RhdGUub3BlbmVkP3Q6ZChlLHNbcy5sZW5ndGgtMV0pfSx0PWZ1bmN0aW9uKGUsdCl7dmFyIGkscyxkPXBhcnNlSW50KHQuc2V0dGluZ3MuZ3JpZC5jb2x1bW5zWzBdLndpZHRoLDEwKStwYXJzZUludCh0Ll9ncmlkU2V0dGluZ3MudHJlZVdpZHRoRGlmZiwxMCk7cmV0dXJuIGk9dC5nZXRfbm9kZShlKS5wYXJlbnRzLmxlbmd0aCxzPWQtaSpyKGUsdCksZH0saT1mdW5jdGlvbihlLHQsaSl7dmFyIHIsZD1cImFcIj09PWUuZ2V0KDApLnRhZ05hbWUudG9Mb3dlckNhc2UoKT9lOmUuY2hpbGRyZW4oXCJhXCIpLG49aS5zZXR0aW5ncy5ncmlkLmNvbHVtbnNbMF07cj1cIlwiLG4udGl0bGUmJihuLnRpdGxlPT09aD9yPWkuZ2V0X3RleHQodCk6dC5hdHRyKG4udGl0bGUpJiYocj10LmF0dHIobi50aXRsZSkpKSxyPXIucmVwbGFjZShzLFwiXCIpLHImJmQuYXR0cihcInRpdGxlXCIscil9LGUuanN0cmVlLmRlZmF1bHRzLmdyaWQ9e3dpZHRoOlwiYXV0b1wifSxlLmpzdHJlZS5wbHVnaW5zLmdyaWQ9ZnVuY3Rpb24odCxyKXt0aGlzLl9pbml0aWFsaXplPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2luaXRpYWxpemVkKXt2YXIgdCxpLHI9dGhpcy5zZXR0aW5ncy5ncmlkfHx7fSxzPXRoaXMuZWxlbWVudCxkPXMucGFyZW50KCksbj10aGlzLl9ncmlkU2V0dGluZ3M9e2NvbHVtbnM6ci5jb2x1bW5zfHxbXSx0cmVlQ2xhc3M6XCJqc3RyZWUtZ3JpZC1jb2wtMFwiLGNvbnRleHQ6ci5jb250ZXh0bWVudXx8ITEsY29sdW1uV2lkdGg6ci5jb2x1bW5XaWR0aCxkZWZhdWx0Q29uZjp7XCIqZGlzcGxheVwiOlwiaW5saW5lXCIsXCIqK2Rpc3BsYXlcIjpcImlubGluZVwifSxpc1RoZW1lcm9sbGVyOiEhdGhpcy5fZGF0YS50aGVtZXJvbGxlcix0cmVlV2lkdGhEaWZmOjAscmVzaXphYmxlOnIucmVzaXphYmxlLHN0YXRlZnVsOnIuc3RhdGVmdWwsaW5kZW50OjB9LGE9bi5jb2x1bW5zLG89MDtmb3IoaT0wO2k8ci5jb2x1bW5zLmxlbmd0aDtpKyspaWYoci5jb2x1bW5zW2ldLnRyZWUpe289aTticmVha310aGlzLnVuaXE9TWF0aC5jZWlsKDFlMypNYXRoLnJhbmRvbSgpKSx0aGlzLnRyZWVjb2w9byx0aGlzLnJvb3RpZD1zLmF0dHIoXCJpZFwiKTt2YXIgbD0vbXNpZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO2lmKGwpe3ZhciBoPXBhcnNlRmxvYXQobmF2aWdhdG9yLmFwcFZlcnNpb24uc3BsaXQoXCJNU0lFXCIpWzFdKTs4PmgmJihuLmRlZmF1bHRDb25mLmRpc3BsYXk9XCJpbmxpbmVcIixuLmRlZmF1bHRDb25mLnpvb209XCIxXCIpfWZvcihwfHwocD0hMCx0PVtcIi5qc3RyZWUtZ3JpZC1jZWxsIHt2ZXJ0aWNhbC1hbGlnbjogdG9wOyBvdmVyZmxvdzpoaWRkZW47bWFyZ2luLWxlZnQ6MDtwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDogMTAwJTtwYWRkaW5nLWxlZnQ6N3B4O3doaXRlLXNwYWNlOiBub3dyYXA7fVwiLFwiLmpzdHJlZS1ncmlkLWNlbGwgc3BhbiB7bWFyZ2luLXJpZ2h0OjBweDttYXJnaW4tcmlnaHQ6MHB4OypkaXNwbGF5OmlubGluZTsqK2Rpc3BsYXk6aW5saW5lO3doaXRlLXNwYWNlOiBub3dyYXA7fVwiLFwiLmpzdHJlZS1ncmlkLXNlcGFyYXRvciB7cG9zaXRpb246YWJzb2x1dGU7IHRvcDowOyByaWdodDowOyBoZWlnaHQ6MjRweDsgbWFyZ2luLWxlZnQ6IC0ycHg7IGJvcmRlci13aWR0aDogMCAycHggMCAwOyAqZGlzcGxheTppbmxpbmU7ICorZGlzcGxheTppbmxpbmU7IG1hcmdpbi1yaWdodDowcHg7d2lkdGg6MHB4O31cIixcIi5qc3RyZWUtZ3JpZC1oZWFkZXItY2VsbCB7b3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDtwYWRkaW5nOiAxcHggM3B4IDJweCA1cHg7fVwiLFwiLmpzdHJlZS1ncmlkLWhlYWRlci10aGVtZXJvbGxlciB7Ym9yZGVyOiAwOyBwYWRkaW5nOiAxcHggM3B4O31cIixcIi5qc3RyZWUtZ3JpZC1oZWFkZXItcmVndWxhciB7cG9zaXRpb246cmVsYXRpdmU7IGJhY2tncm91bmQtY29sb3I6ICNFQkYzRkQ7fVwiLFwiLmpzdHJlZS1ncmlkLXJlc2l6YWJsZS1zZXBhcmF0b3Ige2N1cnNvcjogY29sLXJlc2l6ZTsgd2lkdGg6IDJweDt9XCIsXCIuanN0cmVlLWdyaWQtc2VwYXJhdG9yLXJlZ3VsYXIge2JvcmRlci1jb2xvcjogI2QwZDBkMDsgYm9yZGVyLXN0eWxlOiBzb2xpZDt9XCIsXCIuanN0cmVlLWdyaWQtY2VsbC10aGVtZXJvbGxlciB7Ym9yZGVyOiBub25lICFpbXBvcnRhbnQ7IGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7fVwiLFwiLmpzdHJlZS1ncmlkLXdyYXBwZXIge3dpZHRoOiAxMDAlOyBvdmVyZmxvdy14OiBhdXRvO31cIixcIi5qc3RyZWUtZ3JpZC1taWR3cmFwcGVyIHtkaXNwbGF5OiB0YWJsZS1yb3c7IG92ZXJmbG93OiB2aXNpYmxlO31cIixcIi5qc3RyZWUtZ3JpZC13aWR0aC1hdXRvIHt3aWR0aDphdXRvO2Rpc3BsYXk6YmxvY2s7fVwiLFwiLmpzdHJlZS1ncmlkLWNvbHVtbiB7ZGlzcGxheTogdGFibGUtY2VsbDsgb3ZlcmZsb3c6IGhpZGRlbjt9XCIsXCIuanN0cmVlLWdyaWQtY29sLTAge3dpZHRoOiAxMDAlO31cIl0sZSgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPicrdC5qb2luKFwiXFxuXCIpK1wiPC9zdHlsZT5cIikuYXBwZW5kVG8oXCJoZWFkXCIpKSx0aGlzLmdyaWRXcmFwcGVyPWUoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLXdyYXBwZXJcIikuYXBwZW5kVG8oZCksdGhpcy5taWRXcmFwcGVyPWUoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLW1pZHdyYXBwZXJcIikuYXBwZW5kVG8odGhpcy5ncmlkV3JhcHBlciksci53aWR0aCYmdGhpcy5ncmlkV3JhcHBlci53aWR0aChyLndpZHRoKSxpPTA7aTxhLmxlbmd0aDtpKyspZShcIjxkaXY+PC9kaXY+XCIpLmFkZENsYXNzKFwianN0cmVlLWdyaWQtY29sdW1uIGpzdHJlZS1ncmlkLWNvbHVtbi1cIitpK1wiIGpzdHJlZS1ncmlkLWNvbHVtbi1yb290LVwiK3RoaXMucm9vdGlkKS5hcHBlbmRUbyh0aGlzLm1pZFdyYXBwZXIpO3RoaXMubWlkV3JhcHBlci5jaGlsZHJlbihcImRpdjplcShcIitvK1wiKVwiKS5hcHBlbmQocykscy5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLWNlbGxcIiksdGhpcy5faW5pdGlhbGl6ZWQ9ITB9fSx0aGlzLmluaXQ9ZnVuY3Rpb24oZSx0KXtyLmluaXQuY2FsbCh0aGlzLGUsdCksdGhpcy5faW5pdGlhbGl6ZSgpfSx0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtyLmJpbmQuY2FsbCh0aGlzKSx0aGlzLl9pbml0aWFsaXplKCksdGhpcy5lbGVtZW50Lm9uKFwibW92ZV9ub2RlLmpzdHJlZSBjcmVhdGVfbm9kZS5qc3RyZWUgY2xlYW5fbm9kZS5qc3RyZWUgY2hhbmdlX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3RoaXMuZ2V0X25vZGUodHx8XCIjXCIsITApO3JldHVybiAnJywhMX0sdGhpcykpLm9uKFwiZGVsZXRlX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe2lmKHZvaWQgMCE9PXQubm9kZS5pZCl7dmFyIGkscj10aGlzLmdyaWRXcmFwcGVyLHM9W3Qubm9kZS5pZF07Zm9yKHQubm9kZSYmdC5ub2RlLmNoaWxkcmVuX2QmJihzPXMuY29uY2F0KHQubm9kZS5jaGlsZHJlbl9kKSksaT0wO2k8cy5sZW5ndGg7aSsrKXYocixzW2ldKS5yZW1vdmUoKX19LHRoaXMpKS5vbihcImNsb3NlX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3RoaXMuX2hpZGVfZ3JpZCh0Lm5vZGUpfSx0aGlzKSkub24oXCJvcGVuX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe30sdGhpcykpLm9uKFwibG9hZF9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0KXt9LHRoaXMpKS5vbihcImxvYWRlZC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUpe3RoaXMuX3ByZXBhcmVfaGVhZGVycygpLHRoaXMuZWxlbWVudC50cmlnZ2VyKFwibG9hZGVkX2dyaWQuanN0cmVlXCIpfSx0aGlzKSkub24oXCJyZWFkeS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKHQsaSl7dmFyIHI9dGhpcy5lbGVtZW50LmZpbmQoXCJsaSBhOmZpcnN0XCIpLm91dGVySGVpZ2h0KCk7ZSgnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPmRpdi5qc3RyZWUtZ3JpZC1jZWxsLXJvb3QtJyt0aGlzLnJvb3RpZCtcIiB7bGluZS1oZWlnaHQ6IFwiK3IrXCJweH08L3N0eWxlPlwiKS5hcHBlbmRUbyhcImhlYWRcIiksdGhpcy5ncmlkV3JhcHBlci5hZGRDbGFzcyh0aGlzLmVsZW1lbnQuYXR0cihcImNsYXNzXCIpKX0sdGhpcykpLm9uKFwibW92ZV9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24odCxpKXt2YXIgcj1pLm5ld19pbnN0YW5jZS5lbGVtZW50O3IuZmluZChcImxpID4gYVwiKS5lYWNoKGUucHJveHkoZnVuY3Rpb24oZSx0KXt9LHRoaXMpKX0sdGhpcykpLm9uKFwiaG92ZXJfbm9kZS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCxpKXt2YXIgcj10Lm5vZGUuaWQ7bnVsbCE9PXRoaXMuX2hvdmVyX25vZGUmJnZvaWQgMCE9PXRoaXMuX2hvdmVyX25vZGUmJnYodGhpcy5ncmlkV3JhcHBlcix0aGlzLl9ob3Zlcl9ub2RlKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1ob3ZlcmVkXCIpLHRoaXMuX2hvdmVyX25vZGU9cix2KHRoaXMuZ3JpZFdyYXBwZXIscikuYWRkQ2xhc3MoXCJqc3RyZWUtaG92ZXJlZFwiKX0sdGhpcykpLm9uKFwiZGVob3Zlcl9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0LGkpe3ZhciByPXQubm9kZS5pZDt0aGlzLl9ob3Zlcl9ub2RlPW51bGwsdih0aGlzLmdyaWRXcmFwcGVyLHIpLnJlbW92ZUNsYXNzKFwianN0cmVlLWhvdmVyZWRcIil9LHRoaXMpKS5vbihcInNlbGVjdF9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0LGkpe3ZhciByPXQubm9kZS5pZDt2KHRoaXMuZ3JpZFdyYXBwZXIscikuYWRkQ2xhc3MoXCJqc3RyZWUtY2xpY2tlZFwiKSx0aGlzLmdldF9ub2RlKHQubm9kZS5pZCwhMCkuY2hpbGRyZW4oXCJkaXYuanN0cmVlLWdyaWQtY2VsbFwiKS5hZGRDbGFzcyhcImpzdHJlZS1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJkZXNlbGVjdF9ub2RlLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0LGkpe3ZhciByPXQubm9kZS5pZDt2KHRoaXMuZ3JpZFdyYXBwZXIscikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtY2xpY2tlZFwiKX0sdGhpcykpLm9uKFwiZGVzZWxlY3RfYWxsLmpzdHJlZVwiLGUucHJveHkoZnVuY3Rpb24oZSx0LGkpe3ZhciByLHM9dC5ub2RlfHxbXTtmb3Iocj0wO3I8cy5sZW5ndGg7cisrKXYodGhpcy5ncmlkV3JhcHBlcixzW3JdKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJzZWFyY2guanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3ZhciBpPXRoaXMuZ3JpZFdyYXBwZXI7cmV0dXJuIHRoaXMuX2RhdGEuc2VhcmNoLnNvbSYmdC5ub2Rlcy5sZW5ndGgmJihpLmZpbmQoXCJkaXYuanN0cmVlLWdyaWQtY2VsbC1yZWd1bGFyXCIpLmhpZGUoKSx0Lm5vZGVzLmFkZCh0Lm5vZGVzLnBhcmVudHNVbnRpbChcIi5qc3RyZWVcIikpLmZpbHRlcihcIi5qc3RyZWUtbm9kZVwiKS5lYWNoKGZ1bmN0aW9uKGUsdCl7dmFyIHI9dC5pZDtyJiZ2KGkscikuc2hvdygpfSkpLCEwfSx0aGlzKSkub24oXCJjbGVhcl9zZWFyY2guanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmdyaWRXcmFwcGVyLmZpbmQoXCJkaXYuanN0cmVlLWdyaWQtY2VsbFwiKS5zaG93KCksITB9LHRoaXMpKSx0aGlzLl9ncmlkU2V0dGluZ3MuaXNUaGVtZXJvbGxlciYmdGhpcy5lbGVtZW50Lm9uKFwic2VsZWN0X25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3QucnNsdC5vYmouY2hpbGRyZW4oXCJhXCIpLm5leHRBbGwoXCJkaXZcIikuYWRkQ2xhc3MoXCJ1aS1zdGF0ZS1hY3RpdmVcIil9LHRoaXMpKS5vbihcImRlc2VsZWN0X25vZGUuanN0cmVlIGRlc2VsZWN0X2FsbC5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dC5yc2x0Lm9iai5jaGlsZHJlbihcImFcIikubmV4dEFsbChcImRpdlwiKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKX0sdGhpcykpLm9uKFwiaG92ZXJfbm9kZS5qc3RyZWVcIixlLnByb3h5KGZ1bmN0aW9uKGUsdCl7dC5yc2x0Lm9iai5jaGlsZHJlbihcImFcIikubmV4dEFsbChcImRpdlwiKS5hZGRDbGFzcyhcInVpLXN0YXRlLWhvdmVyXCIpfSx0aGlzKSkub24oXCJkZWhvdmVyX25vZGUuanN0cmVlXCIsZS5wcm94eShmdW5jdGlvbihlLHQpe3QucnNsdC5vYmouY2hpbGRyZW4oXCJhXCIpLm5leHRBbGwoXCJkaXZcIikucmVtb3ZlQ2xhc3MoXCJ1aS1zdGF0ZS1ob3ZlclwiKX0sdGhpcykpLHRoaXMuX2dyaWRTZXR0aW5ncy5zdGF0ZWZ1bCYmdGhpcy5lbGVtZW50Lm9uKFwicmVzaXplX2NvbHVtbi5qc3RyZWUtZ3JpZFwiLGUucHJveHkoZnVuY3Rpb24oZSx0LGkpe2xvY2FsU3RvcmFnZVtcImpzdHJlZS1yb290LVwiK3RoaXMucm9vdGlkK1wiLWNvbHVtbi1cIit0XT1pfSx0aGlzKSl9LHRoaXMudGVhcmRvd249ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdyaWRXcmFwcGVyLHQ9dGhpcy5lbGVtZW50LGk9ZS5wYXJlbnQoKTt0LmRldGFjaCgpLGUucmVtb3ZlKCksaS5hcHBlbmQodCksci50ZWFyZG93bi5jYWxsKHRoaXMpfSx0aGlzLl9jbGVhbl9ncmlkPWZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5ncmlkV3JhcHBlcjtlP3YoaSx0KS5yZW1vdmUoKTppLmZpbmQoXCJkaXYuanN0cmVlLWdyaWQtY2VsbC1yZWd1bGFyXCIpLnJlbW92ZSgpfSx0aGlzLl9wcmVwYXJlX2hlYWRlcnM9ZnVuY3Rpb24oKXt2YXIgdCxpLHIscyxkLG4sYSxvLGwsaCxjPXRoaXMuX2dyaWRTZXR0aW5ncyxwPWMuY29sdW1uc3x8W10sZz1jLmNvbHVtbldpZHRoLHU9Yy5yZXNpemFibGV8fCExLHY9Yy5pc1RoZW1lcm9sbGVyLHg9dj9cInRoZW1lcm9sbGVyXCI6XCJyZWd1bGFyXCIseT0hMSxDPXRoaXMuZ3JpZHBhcmVudCxiPXRoaXMucm9vdGlkLFc9Yy5kZWZhdWx0Q29uZixTPTAsej0wO2Zvcih0aGlzLnBhcmVudD1DLGk9MDtpPHAubGVuZ3RoO2krKylkPXBbaV0uaGVhZGVyQ2xhc3N8fFwiXCIsbj1wW2ldLmNvbHVtbkNsYXNzfHxcIlwiLGE9cFtpXS5oZWFkZXJ8fFwiXCIsYSYmKHk9ITApLHM9Yy5zdGF0ZWZ1bCYmbG9jYWxTdG9yYWdlW1wianN0cmVlLXJvb3QtXCIrYitcIi1jb2x1bW4tXCIraV0/bG9jYWxTdG9yYWdlW1wianN0cmVlLXJvb3QtXCIrYitcIi1jb2x1bW4tXCIraV06cFtpXS53aWR0aHx8ZyxTPXY/NzoxMCxcImF1dG9cIiE9PXMmJlwic3RyaW5nXCIhPXR5cGVvZiBzJiYocy09Uyksbz0wPT09aT8zOjAscj10aGlzLm1pZFdyYXBwZXIuY2hpbGRyZW4oXCJkaXYuanN0cmVlLWdyaWQtY29sdW1uLVwiK2kpLGw9ZShcIjxkaXY+PC9kaXY+XCIpLmNzcyhXKS5jc3Moe1wibWFyZ2luLWxlZnRcIjpvfSkuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1kaXYtXCIrdGhpcy51bmlxK1wiLVwiK2krXCIgXCIrKHY/XCJ1aS13aWRnZXQtaGVhZGVyIFwiOlwiXCIpK1wiIGpzdHJlZS1ncmlkLWhlYWRlciBqc3RyZWUtZ3JpZC1oZWFkZXItY2VsbCBqc3RyZWUtZ3JpZC1oZWFkZXItXCIreCtcIiBcIitkK1wiIFwiK24pLmh0bWwoYSksbC5hZGRDbGFzcygodj9cInVpLXdpZGdldC1oZWFkZXIgXCI6XCJcIikrXCJqc3RyZWUtZ3JpZC1oZWFkZXIganN0cmVlLWdyaWQtaGVhZGVyLVwiK3gpLGwucHJlcGVuZFRvKHIpLHorPWwub3V0ZXJXaWR0aCgpLGg9ZShcIjxkaXYgY2xhc3M9J2pzdHJlZS1ncmlkLXNlcGFyYXRvciBqc3RyZWUtZ3JpZC1zZXBhcmF0b3ItXCIreCsodj9cIiB1aS13aWRnZXQtaGVhZGVyXCI6XCJcIikrKHU/XCIganN0cmVlLWdyaWQtcmVzaXphYmxlLXNlcGFyYXRvclwiOlwiXCIpK1wiJz4mbmJzcDs8L2Rpdj5cIikuYXBwZW5kVG8obCksci53aWR0aChzKSxyLmNzcyhcIm1pbi13aWR0aFwiLHMpLHIuY3NzKFwibWF4LXdpZHRoXCIscyk7bC5hZGRDbGFzcygodj9cInVpLXdpZGdldC1oZWFkZXIgXCI6XCJcIikrXCJqc3RyZWUtZ3JpZC1oZWFkZXIganN0cmVlLWdyaWQtaGVhZGVyLWxhc3QganN0cmVlLWdyaWQtaGVhZGVyLVwiK3gpLHZvaWQgMD09PXBbcC5sZW5ndGgtMV0ud2lkdGgmJih6LT1zLHIuY3NzKHt3aWR0aDpcImF1dG9cIn0pLGwuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC13aWR0aC1hdXRvXCIpLm5leHQoXCIuanN0cmVlLWdyaWQtc2VwYXJhdG9yXCIpLnJlbW92ZSgpKSx5P2MuaGVhZGVyPXQ6ZShcImRpdi5qc3RyZWUtZ3JpZC1oZWFkZXJcIikuaGlkZSgpLCF0aGlzLmJvdW5kJiZ1JiYodGhpcy5ib3VuZD0hMCxlKGRvY3VtZW50KS5tb3VzZXVwKGZ1bmN0aW9uKCl7dmFyIHQsaSxyLHMsZCxuO20mJihuPWoucHJldkFsbChcIi5qc3RyZWUtZ3JpZC1jb2x1bW5cIikubGVuZ3RoLGQ9ai5jbG9zZXN0KFwiLmpzdHJlZS1ncmlkLXdyYXBwZXJcIikuZmluZChcIi5qc3RyZWVcIiksdD1lLmpzdHJlZS5yZWZlcmVuY2UoZCksaT10LnNldHRpbmdzLmdyaWQuY29sdW1ucyxzPWoucGFyZW50KCkuY2hpbGRyZW4oXCJkaXYuanN0cmVlLWdyaWQtY29sdW1uXCIpLChpc05hTihuKXx8MD5uKSYmKHQuX2dyaWRTZXR0aW5ncy50cmVlV2lkdGhEaWZmPWQuZmluZChcImluczplcSgwKVwiKS53aWR0aCgpK2QuZmluZChcImE6ZXEoMClcIikud2lkdGgoKS10Ll9ncmlkU2V0dGluZ3MuY29sdW1uc1swXS53aWR0aCkscj10Ll9ncmlkU2V0dGluZ3MuY29sdW1uc1tuXS53aWR0aD1wYXJzZUZsb2F0KGouY3NzKFwid2lkdGhcIikpLG09ITEsaj1udWxsLGQudHJpZ2dlcihcInJlc2l6ZV9jb2x1bW4uanN0cmVlLWdyaWRcIixbbixyXSkpfSkubW91c2Vtb3ZlKGZ1bmN0aW9uKGUpe2lmKG0pe3c9ZS5wYWdlWDt2YXIgdCxpLHIscz13LV87MCE9PXMmJih0PWoud2lkdGgoKSxpPXBhcnNlRmxvYXQoai5jc3MoXCJ3aWR0aFwiKSksaXx8KGk9ai5pbm5lcldpZHRoKCkpLHM9MD5zP01hdGgubWF4KHMsLXQpOnMscj1pK3MsKHM+MHx8dD4wKSYmcj5mJiYoai53aWR0aChyK1wicHhcIiksai5jc3MoXCJtaW4td2lkdGhcIixyK1wicHhcIiksai5jc3MoXCJtYXgtd2lkdGhcIixyK1wicHhcIiksXz13KSl9fSksdGhpcy5ncmlkV3JhcHBlci5vbihcInNlbGVjdHN0YXJ0XCIsXCIuanN0cmVlLWdyaWQtcmVzaXphYmxlLXNlcGFyYXRvclwiLGZ1bmN0aW9uKCl7cmV0dXJuITF9KS5vbihcIm1vdXNlZG93blwiLFwiLmpzdHJlZS1ncmlkLXJlc2l6YWJsZS1zZXBhcmF0b3JcIixmdW5jdGlvbih0KXtyZXR1cm4gbT0hMCxfPXQucGFnZVgsaj1lKHRoaXMpLmNsb3Nlc3QoXCJkaXYuanN0cmVlLWdyaWQtY29sdW1uXCIpLCExfSkub24oXCJkYmxjbGlja1wiLFwiLmpzdHJlZS1ncmlkLXJlc2l6YWJsZS1zZXBhcmF0b3JcIixmdW5jdGlvbih0KXt2YXIgaSxyLHM9ZSh0aGlzKSxkPXMuY2xvc2VzdChcImRpdi5qc3RyZWUtZ3JpZC1jb2x1bW5cIiksbj1wYXJzZUZsb2F0KGQuY3NzKFwid2lkdGhcIikpLGE9MCxvPWQucHJldkFsbChcIi5qc3RyZWUtZ3JpZC1jb2x1bW5cIikubGVuZ3RoLGw9ZC53aWR0aCgpO2QuZmluZChcIi5qc3RyZWUtZ3JpZC1jZWxsXCIpLmVhY2goZnVuY3Rpb24oKXt2YXIgdCxpPWUodGhpcyk7aS5jc3MoXCJwb3NpdGlvblwiLFwiYWJzb2x1dGVcIiksaS5jc3MoXCJ3aWR0aFwiLFwiYXV0b1wiKSx0PWkub3V0ZXJXaWR0aCgpLGkuY3NzKFwicG9zaXRpb25cIixcInJlbGF0aXZlXCIpLHQ+YSYmKGE9dCl9KSxpPWEtbixpPTA+aT9NYXRoLm1heChpLC1sKTppLHI9bitpK1wicHhcIixkLndpZHRoKHIpLGQuY3NzKFwibWluLXdpZHRoXCIsciksZC5jc3MoXCJtYXgtd2lkdGhcIixyKSxlKHRoaXMpLmNsb3Nlc3QoXCIuanN0cmVlLWdyaWQtd3JhcHBlclwiKS5maW5kKFwiLmpzdHJlZVwiKS50cmlnZ2VyKFwicmVzaXplX2NvbHVtbi5qc3RyZWUtZ3JpZFwiLFtvLHJdKX0pKX0sdGhpcy5yZWRyYXdfbm9kZT1mdW5jdGlvbihlLHQsaSxzKXtyZXR1cm4gZT1yLnJlZHJhd19ub2RlLmNhbGwodGhpcyxlLHQsaSxzKSxlJiZ0aGlzLl9wcmVwYXJlX2dyaWQoZSksZX0sdGhpcy5yZWZyZXNoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NsZWFuX2dyaWQoKSxyLnJlZnJlc2guYXBwbHkodGhpcyxhcmd1bWVudHMpfSx0aGlzLnNldF9pZD1mdW5jdGlvbihlLHQpe3ZhciBpO2UmJihpPWUuaWQpO3ZhciBzPXIuc2V0X2lkLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihzJiZ2b2lkIDAhPT1pKXt2YXIgZCxuPXRoaXMuZ3JpZFdyYXBwZXIsYT1baV07Zm9yKGUmJmUuY2hpbGRyZW5fZCYmKGE9YS5jb25jYXQoZS5jaGlsZHJlbl9kKSksZD0wO2Q8YS5sZW5ndGg7ZCsrKXYobixhW2RdKS5hdHRyKGwsZS5pZCkuYXR0cihcImlkXCIsZytlLmlkK3UrKGQrMSkpLnJlbW92ZUNsYXNzKGcraSt1KS5hZGRDbGFzcyhnK2UuaWQrdSl9cmV0dXJuIHN9LHRoaXMuX2hpZGVfZ3JpZD1mdW5jdGlvbihlKXt2YXIgdCxpPWUmJmUuY2hpbGRyZW5fZD9lLmNoaWxkcmVuX2Q6W107Zm9yKHQ9MDt0PGkubGVuZ3RoO3QrKyl2KHRoaXMuZ3JpZFdyYXBwZXIsaVt0XSkucmVtb3ZlKCl9LHRoaXMuaG9sZGluZ0NlbGxzPXt9LHRoaXMuZ2V0SG9sZGluZ0NlbGxzPWZ1bmN0aW9uKHQsaSxyKXt2YXIgcyxkLG49ZSgpLGE9dC5jaGlsZHJlbnx8W107Zm9yKGQ9MDtkPGEubGVuZ3RoO2QrKylzPWcrbyhhW2RdKSt1K2kscltzXSYmdC5zdGF0ZS5vcGVuZWQmJihuPW4uYWRkKHJbc10pLmFkZCh0aGlzLmdldEhvbGRpbmdDZWxscyh0aGlzLmdldF9ub2RlKGFbZF0pLGkscikpKTtyZXR1cm4gbn0sdGhpcy5fZWRpdD1mdW5jdGlvbih0LGkscil7aWYoIXQpcmV0dXJuITE7aWYoIXIpcmV0dXJuITE7cj1lKHIpLFwiZGl2XCI9PT1yLnByb3AoXCJ0YWdOYW1lXCIpLnRvTG93ZXJDYXNlKCkmJihyPXIuY2hpbGRyZW4oXCJzcGFuOmZpcnN0XCIpKTt2YXIgcz10aGlzLl9kYXRhLmNvcmUucnRsLGQ9dGhpcy5lbGVtZW50LndpZHRoKCksbj10LmRhdGFbaS52YWx1ZV0sYT1lKFwiPGRpdiAvPlwiLHtjc3M6e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCItMjAwcHhcIixsZWZ0OnM/XCIwcHhcIjpcIi0xMDAwcHhcIix2aXNpYmlsaXR5OlwiaGlkZGVuXCJ9fSkuYXBwZW5kVG8oXCJib2R5XCIpLG89ZShcIjxpbnB1dCAvPlwiLHt2YWx1ZTpuLFwiY2xhc3NcIjpcImpzdHJlZS1yZW5hbWUtaW5wdXRcIixjc3M6e3BhZGRpbmc6XCIwXCIsYm9yZGVyOlwiMXB4IHNvbGlkIHNpbHZlclwiLFwiYm94LXNpemluZ1wiOlwiYm9yZGVyLWJveFwiLGRpc3BsYXk6XCJpbmxpbmUtYmxvY2tcIixoZWlnaHQ6dGhpcy5fZGF0YS5jb3JlLmxpX2hlaWdodCtcInB4XCIsbGluZUhlaWdodDp0aGlzLl9kYXRhLmNvcmUubGlfaGVpZ2h0K1wicHhcIix3aWR0aDpcIjE1MHB4XCJ9LGJsdXI6ZS5wcm94eShmdW5jdGlvbigpe3ZhciBlPW8udmFsKCk7XCJcIj09PWV8fGU9PT1uP2U9bjoodC5kYXRhW2kudmFsdWVdPWUsdGhpcy5lbGVtZW50LnRyaWdnZXIoXCJ1cGRhdGVfY2VsbC5qc3RyZWUtZ3JpZFwiLHtub2RlOnQsY29sOmkudmFsdWUsdmFsdWU6ZSxvbGQ6bn0pLHRoaXMuX3ByZXBhcmVfZ3JpZCh0aGlzLmdldF9ub2RlKHQsITApKSksby5yZW1vdmUoKSxyLnNob3coKX0sdGhpcyksa2V5ZG93bjpmdW5jdGlvbihlKXt2YXIgdD1lLndoaWNoOzI3PT09dCYmKHRoaXMudmFsdWU9biksKDI3PT09dHx8MTM9PT10fHwzNz09PXR8fDM4PT09dHx8Mzk9PT10fHw0MD09PXR8fDMyPT09dCkmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksKDI3PT09dHx8MTM9PT10KSYmKGUucHJldmVudERlZmF1bHQoKSx0aGlzLmJsdXIoKSl9LGNsaWNrOmZ1bmN0aW9uKGUpe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCl9LG1vdXNlZG93bjpmdW5jdGlvbihlKXtlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpfSxrZXl1cDpmdW5jdGlvbihlKXtvLndpZHRoKE1hdGgubWluKGEudGV4dChcInBXXCIrdGhpcy52YWx1ZSkud2lkdGgoKSxkKSl9LGtleXByZXNzOmZ1bmN0aW9uKGUpe3JldHVybiAxMz09PWUud2hpY2g/ITE6dm9pZCAwfX0pLGw9e2ZvbnRGYW1pbHk6ci5jc3MoXCJmb250RmFtaWx5XCIpfHxcIlwiLGZvbnRTaXplOnIuY3NzKFwiZm9udFNpemVcIil8fFwiXCIsZm9udFdlaWdodDpyLmNzcyhcImZvbnRXZWlnaHRcIil8fFwiXCIsZm9udFN0eWxlOnIuY3NzKFwiZm9udFN0eWxlXCIpfHxcIlwiLGZvbnRTdHJldGNoOnIuY3NzKFwiZm9udFN0cmV0Y2hcIil8fFwiXCIsZm9udFZhcmlhbnQ6ci5jc3MoXCJmb250VmFyaWFudFwiKXx8XCJcIixsZXR0ZXJTcGFjaW5nOnIuY3NzKFwibGV0dGVyU3BhY2luZ1wiKXx8XCJcIix3b3JkU3BhY2luZzpyLmNzcyhcIndvcmRTcGFjaW5nXCIpfHxcIlwifTtyLmhpZGUoKSxyLnBhcmVudCgpLmFwcGVuZChvKSxvLmNzcyhsKS53aWR0aChNYXRoLm1pbihhLnRleHQoXCJwV1wiK29bMF0udmFsdWUpLndpZHRoKCksZCkpWzBdLnNlbGVjdCgpfSx0aGlzLl9wcmVwYXJlX2dyaWQ9ZnVuY3Rpb24odCl7dmFyIHIsYSxoLGMscCxmLG0saixfLHcseCx5LEMsYixXLFMseixrLFQsQSxQLEYsVixxLEQsTCxNLE4sSSxCPXRoaXMuX2dyaWRTZXR0aW5ncyxIPUIudHJlZUNsYXNzLEU9dGhpcyxVPUIuY29sdW1uc3x8W10sWD1CLmlzVGhlbWVyb2xsZXIsJD10aGlzLmVsZW1lbnQsUT10aGlzLnJvb3RpZCxZPVg/XCJ0aGVtZXJvbGxlclwiOlwicmVndWxhclwiLEc9dGhpcy5nZXRfbm9kZSh0KSxKPUIuY29sdW1uV2lkdGgsSz1CLmRlZmF1bHRDb25mLE89ZnVuY3Rpb24odCxpLHIscyxkKXtyZXR1cm4gZnVuY3Rpb24oZCl7aS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLnRyaWdnZXIoXCJjbGljay5qc3RyZWVcIixkKSx0LnRyaWdnZXIoXCJzZWxlY3RfY2VsbC5qc3RyZWUtZ3JpZFwiLFt7dmFsdWU6cixjb2x1bW46cy5oZWFkZXIsbm9kZTppLGdyaWQ6ZSh0aGlzKSxzb3VyY2VOYW1lOnMudmFsdWV9XSl9fSxSPWZ1bmN0aW9uKHQsaSxyLHMsZCl7cmV0dXJuIGZ1bmN0aW9uKHQpe0IuY29udGV4dCYmKHQucHJldmVudERlZmF1bHQoKSxlLnZha2F0YS5jb250ZXh0LnNob3codGhpcyx7eDp0LnBhZ2VYLHk6dC5wYWdlWX0se2VkaXQ6e2xhYmVsOlwiRWRpdFwiLGFjdGlvbjpmdW5jdGlvbihlKXt2YXIgcj1kLmdldF9ub2RlKGkpO0UuX2VkaXQocixzLHQudGFyZ2V0KX19fSkpfX0sWj1mdW5jdGlvbihlLHQpe3JldHVybiBmdW5jdGlvbigpe3QuaG92ZXJfbm9kZShlKX19LGVlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7dC5kZWhvdmVyX25vZGUoZSl9fSx0ZT10aGlzLm1pZFdyYXBwZXIsaWU9Ry5pZCxyZT10aGlzLmdldF9ub2RlKEcucGFyZW50KS5jaGlsZHJlbixzZT1qUXVlcnkuaW5BcnJheShpZSxyZSksZGU9dGhpcy5ob2xkaW5nQ2VsbHMsbmU9ITE7aWYocj1lKHQpLF89ci5jaGlsZHJlbihcImFcIiksMT09PV8ubGVuZ3RoKXtmb3IoST0hRy5zdGF0ZS5vcGVuZWQsUz1nK28oaWUpK3Usej1cIiNcIj09PUcucGFyZW50P251bGw6Ry5wYXJlbnQsXy5hZGRDbGFzcyhIKSxpKF8scixFKSx3PV8sYz0wO2M8VS5sZW5ndGg7YysrKXRoaXMudHJlZWNvbCE9PWMmJihEPVVbY10sTj10ZS5jaGlsZHJlbihcImRpdjplcShcIitjK1wiKVwiKSxmPUQuY2VsbENsYXNzfHxcIlwiLG09RC53aWRlQ2VsbENsYXNzfHxcIlwiLGo9RC5jb2x1bW5DbGFzc3x8XCJcIixOLmFkZENsYXNzKGopLHA9dm9pZCAwIT09RC52YWx1ZSYmbnVsbCE9PUQudmFsdWU/XCJmdW5jdGlvblwiPT10eXBlb2YgRC52YWx1ZT9ELnZhbHVlKEcpOm51bGwhPT1HLmRhdGEmJnZvaWQgMCE9PUcuZGF0YSYmdm9pZCAwIT09Ry5kYXRhW0QudmFsdWVdP0cuZGF0YVtELnZhbHVlXTpcIlwiOlwiXCIsXCJmdW5jdGlvblwiPT10eXBlb2YgRC5mb3JtYXQmJihwPUQuZm9ybWF0KHApKSxELmltYWdlcz8oaD1ELmltYWdlc1twXXx8RC5pbWFnZXNbXCJkZWZhdWx0XCJdLGgmJihMPVwiKlwiPT09aFswXT8nPHNwYW4gY2xhc3M9XCInK2guc3Vic3RyKDEpKydcIj48L3NwYW4+JzonPGltZyBzcmM9XCInK2grJ1wiPicpKTpMPXAsKHZvaWQgMD09PUx8fG51bGw9PT1MfHxuLnRlc3QoTCkpJiYoTD1cIiZuYnNwO1wiKSx4PUQudmFsdWVDbGFzcyYmbnVsbCE9PUcuZGF0YSYmdm9pZCAwIT09Ry5kYXRhP0cuZGF0YVtELnZhbHVlQ2xhc3NdfHxcIlwiOlwiXCIseCYmRC52YWx1ZUNsYXNzUHJlZml4JiZcIlwiIT09RC52YWx1ZUNsYXNzUHJlZml4JiYoeD1ELnZhbHVlQ2xhc3NQcmVmaXgreCkseT1ELndpZGVWYWx1ZUNsYXNzJiZudWxsIT09Ry5kYXRhJiZ2b2lkIDAhPT1HLmRhdGE/Ry5kYXRhW0Qud2lkZVZhbHVlQ2xhc3NdfHxcIlwiOlwiXCIseSYmRC53aWRlVmFsdWVDbGFzc1ByZWZpeCYmXCJcIiE9PUQud2lkZVZhbHVlQ2xhc3NQcmVmaXgmJih5PUQud2lkZVZhbHVlQ2xhc3NQcmVmaXgreSksVz1ELnRpdGxlJiZudWxsIT09Ry5kYXRhJiZ2b2lkIDAhPT1HLmRhdGE/Ry5kYXRhW0QudGl0bGVdfHxcIlwiOlwiXCIsVz1XLnJlcGxhY2UocyxcIlwiKSxiPTcsYT1ELndpZHRofHxKLFwiYXV0b1wiIT09YSYmKGE9TXx8YS1iKSx3PXYoTixpZSksKCF3fHx3Lmxlbmd0aDwxKSYmKHc9ZShcIjxkaXY+PC9kaXY+XCIpLGUoXCI8c3Bhbj48L3NwYW4+XCIpLmFwcGVuZFRvKHcpLHcuYXR0cihcImlkXCIsUytjKSx3LmFkZENsYXNzKFMpLHcuYXR0cihsLGllKSksQT0wPj1zZT9HLnBhcmVudDpkKHRoaXMscmVbc2UtMV0pLFQ9dihOLEEpLEY9c2U+PXJlLmxlbmd0aC0xP1wiTlVMTFwiOnJlW3NlKzFdLFA9dihOLEYpLHE9Ry5jaGlsZHJlbiYmRy5jaGlsZHJlbi5sZW5ndGg+MD9HLmNoaWxkcmVuWzBdOlwiTlVMTFwiLFY9dihOLHEpLGs9dihOLHopLHo/KGsmJmsubGVuZ3RoPjA/KFQmJlQubGVuZ3RoPjA/dy5pbnNlcnRBZnRlcihUKTpWJiZWLmxlbmd0aD4wP3cuaW5zZXJ0QmVmb3JlKFYpOlAmJlAubGVuZ3RoPjA/dy5pbnNlcnRCZWZvcmUoUCk6dy5pbnNlcnRBZnRlcihrKSxuZT0hMCk6bmU9ITEsZGVbUytjXT13KTooVCYmVC5sZW5ndGg+MD93Lmluc2VydEFmdGVyKFQpOlYmJlYubGVuZ3RoPjA/dy5pbnNlcnRCZWZvcmUoVik6UCYmUC5sZW5ndGg+MD93Lmluc2VydEJlZm9yZShQKTp3LmFwcGVuZFRvKE4pLG5lPSEwKSxuZSYmdy5hZnRlcih0aGlzLmdldEhvbGRpbmdDZWxscyhHLGMsZGUpKSxDPXcuY2hpbGRyZW4oXCJzcGFuXCIpLEMuYWRkQ2xhc3MoZitcIiBcIit4KS5odG1sKEwpLHc9dy5jc3MoSykuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jZWxsIGpzdHJlZS1ncmlkLWNlbGwtcmVndWxhciBqc3RyZWUtZ3JpZC1jZWxsLXJvb3QtXCIrUStcIiBqc3RyZWUtZ3JpZC1jZWxsLVwiK1krXCIgXCIrbStcIiBcIit5KyhYP1wiIHVpLXN0YXRlLWRlZmF1bHRcIjpcIlwiKSkuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jb2wtXCIrYyksdy5jbGljayhPKCQscixwLEQsdGhpcykpLHcub24oXCJjb250ZXh0bWVudVwiLFIoJCxyLHAsRCx0aGlzKSksdy5ob3ZlcihaKHIsdGhpcyksZWUocix0aGlzKSksVyYmQy5hdHRyKFwidGl0bGVcIixXKSk7dy5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLWNlbGwtbGFzdFwiKyhYP1wiIHVpLXN0YXRlLWRlZmF1bHRcIjpcIlwiKSksdm9pZCAwPT09VVtVLmxlbmd0aC0xXS53aWR0aCYmdy5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLXdpZHRoLWF1dG9cIikubmV4dChcIi5qc3RyZWUtZ3JpZC1zZXBhcmF0b3JcIikucmVtb3ZlKCl9dGhpcy5lbGVtZW50LmNzcyh7XCJvdmVyZmxvdy15XCI6XCJhdXRvICFpbXBvcnRhbnRcIn0pfSx0aGlzLmhvbGRpbmdDZWxscz17fX19KTsiLCIvKlxuICogQ29weXJpZ2h0IGh0dHBzOi8vZ2l0aHViLmNvbS9kaXZpby9kamFuZ28tY21zXG4gKi9cblxuLy8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcbi8vIE5BTUVTUEFDRVNcbi8qKlxuICogQG1vZHVsZSBDTVNcbiAqL1xudmFyIENNUyA9IHdpbmRvdy5DTVMgfHwge307XG5cbi8vICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG4vLyBNT0RBTFxuKGZ1bmN0aW9uICgkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHBhZ2V0cmVlIGlzIGxvYWRlZCB2aWEgYC9hZG1pbi9jbXMvcGFnZWAgYW5kIGhhcyBhIGN1c3RvbSBhZG1pblxuICAgICAqIHRlbXBsYXRlcyBzdG9yZWQgd2l0aGluIGB0ZW1wbGF0ZXMvYWRtaW4vY21zL3BhZ2UvdHJlZWAuXG4gICAgICpcbiAgICAgKiBAY2xhc3MgUGFnZVRyZWVcbiAgICAgKiBAbmFtZXNwYWNlIENNU1xuICAgICAqIEB1c2VzIENNUy5BUEkuSGVscGVyc1xuICAgICAqL1xuICAgIENNUy5QYWdlVHJlZSA9IG5ldyBDTVMuQ2xhc3Moe1xuICAgICAgICAvLyBUT0RPIGFkZCBtZWNoYW5pY3MgdG8gc2V0IHRoZSBob21lIHBhZ2VcbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShvcHRpb25zKSB7XG4gICAgICAgICAgICAvLyBvcHRpb25zIGFyZSBsb2FkZWQgZnJvbSB0aGUgcGFnZXRyZWUgaHRtbCBub2RlXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSAkKCcuanMtY21zLXBhZ2V0cmVlJykuZGF0YSgnanNvbicpO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sIHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgIC8vIHN0YXRlcyBhbmQgZXZlbnRzXG4gICAgICAgICAgICB0aGlzLmNsaWNrID0gJ2NsaWNrLmNtcy5wYWdldHJlZSc7XG4gICAgICAgICAgICB0aGlzLmNhY2hlID0ge1xuICAgICAgICAgICAgICAgIGlkOiBudWxsLFxuICAgICAgICAgICAgICAgIHRhcmdldDogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc3VjY2Vzc1RpbWVyID0gMTAwMDtcblxuICAgICAgICAgICAgLy8gZWxlbWVudHNcbiAgICAgICAgICAgIHRoaXMuX3NldHVwVUkoKTtcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50cygpO1xuXG4gICAgICAgICAgICAvLyBjYW5jZWwgaWYgcGFndHJlZSBpcyBub3QgYXZhaWxhYmxlXG4gICAgICAgICAgICBpZiAoISQuaXNFbXB0eU9iamVjdCh0aGlzLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0dXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcmVzIGFsbCBqUXVlcnkgcmVmZXJlbmNlcyB3aXRoaW4gYHRoaXMudWlgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIF9zZXR1cFVJXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfc2V0dXBVSTogZnVuY3Rpb24gX3NldHVwVUkoKSB7XG4gICAgICAgICAgICB2YXIgcGFnZXRyZWUgPSAkKCcuY21zLXBhZ2V0cmVlJyk7XG4gICAgICAgICAgICB0aGlzLnVpID0ge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogcGFnZXRyZWUsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6ICQoZG9jdW1lbnQpLFxuICAgICAgICAgICAgICAgIHRyZWU6IHBhZ2V0cmVlLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUnKSxcbiAgICAgICAgICAgICAgICBkaWFsb2c6ICQoJy5qcy1jbXMtdHJlZS1kaWFsb2cnKSxcbiAgICAgICAgICAgICAgICBzaXRlRm9ybTogJCgnLmpzLWNtcy1wYWdldHJlZS1zaXRlLWZvcm0nKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0dGluZyB1cCB0aGUganN0cmVlIGFuZCB0aGUgcmVsYXRlZCBjb2x1bW5zLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIF9zZXR1cFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3NldHVwOiBmdW5jdGlvbiBfc2V0dXAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgY29sdW1ucyA9IFtdO1xuICAgICAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogdGhpcy5vcHRpb25zLmxhbmcuY29kZSxcbiAgICAgICAgICAgICAgICBvcGVuTm9kZXM6IFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgYWpheCByZXF1ZXN0IHNlbmQgdGhlIGNzcmYgdG9rZW5cbiAgICAgICAgICAgIENNUy5BUEkuSGVscGVycy5jc3JmKHRoaXMub3B0aW9ucy5jc3JmKTtcblxuICAgICAgICAgICAgLy8gc2V0dXAgY29sdW1uIGhlYWRpbmdzXG4gICAgICAgICAgICAkLmVhY2godGhpcy5vcHRpb25zLmNvbHVtbnMsIGZ1bmN0aW9uIChpbmRleCwgb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9iai5rZXkgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCByb3cgaXMgYWxyZWFkeSBwb3B1bGF0ZWQsIHRvIGF2b2lkIG92ZXJ3cml0ZXNcbiAgICAgICAgICAgICAgICAgICAgLy8ganVzdCBsZWF2ZSB0aGUgXCJrZXlcIiBwYXJhbSBlbXB0eVxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBvYmoudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogb2JqLndpZHRoIHx8ICcxJScsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWRlQ2VsbENsYXNzOiBvYmouY2xzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IG9iai50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0IG5lZWRzIHRvIGhhdmUgdGhlIFwiY29sZGVcIiBmb3JtYXQgYW5kIG5vdCBcImNvbC1kZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXMganN0cmVlIHdpbGwgY29udmVydCBcImNvbC1kZVwiIHRvIFwiY29sZGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsc28gd2Ugc3RyaXAgZGFzaGVzLCBpbiBjYXNlIGxhbmd1YWdlIGNvZGUgY29udGFpbnMgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlLmcuIHpoLWhhbnMsIHpoLWNuIGV0Y1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuZGF0YVsnY29sJyArIG9iai5rZXkucmVwbGFjZSgnLScsICcnKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogb2JqLndpZHRoIHx8ICcxJScsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWRlQ2VsbENsYXNzOiBvYmouY2xzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBwcmVwYXJlIGRhdGFcbiAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmZpbHRlcmVkKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLm9wdGlvbnMudXJscy50cmVlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJyMnIGlzIHJlbmRlcmVkIGlmIGl0cyB0aGUgcm9vdCBub2RlLCB0aGVyZSB3ZSBvbmx5XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYXJlIGFib3V0IGBvYmoub3Blbk5vZGVzYCwgaW4gdGhlIGZvbGxvd2luZyBjYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBhcmUgcmVxdWVzdGluZyBhIHNwZWNpZmljIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmlkICE9PSAnIycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoucGFnZUlkID0gdGhhdC5fc3RvcmVOb2RlSWQobm9kZS5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnBhZ2VJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gc3RvcmUgdGhlIG9wZW5lZCBpdGVtcyBpbnNpZGUgdGhlIGxvY2Fsc3RvcmFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXMgd2UgaGF2ZSB0byBsb2FkIHRoZSBwYWdldHJlZSB3aXRoIHRoZSBwcmV2aW91cyBvcGVuZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoub3Blbk5vZGVzID0gdGhhdC5fZ2V0U3RvcmVkTm9kZUlkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHNldCB0aGUgc2l0ZSBpZCB0byBnZXQgdGhlIGNvcnJlY3QgdHJlZVxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnNpdGUgPSB0aGF0Lm9wdGlvbnMuc2l0ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJpbmQgb3B0aW9ucyB0byB0aGUganN0cmVlIGluc3RhbmNlXG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKHtcbiAgICAgICAgICAgICAgICBjb3JlOiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgb3Blbi9jbG9zZSBhbmltYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogMCxcbiAgICAgICAgICAgICAgICAgICAgLy8gY29yZSBzZXR0aW5nIHRvIGFsbG93IGFjdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tfY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbmNlbCBkcmFnZ2luZyB3aGVuIGZpbHRlcmluZyBpcyBhY3RpdmUgYnkgc2V0dGluZyBgZmFsc2VgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoYXQub3B0aW9ucy5maWx0ZXJlZCkgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LmpzdHJlZS5jb20vYXBpLyMvP2Y9JC5qc3RyZWUuZGVmYXVsdHMuY29yZS5kYXRhXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0cmluZ3MgdXNlZCB3aXRoaW4ganN0cmVlIHRoYXQgYXJlIGNhbGxlZCB1c2luZyBgZ2V0X3N0cmluZ2BcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0xvYWRpbmcgLi4uJzogdGhpcy5vcHRpb25zLmxhbmcubG9hZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdOZXcgbm9kZSc6IHRoaXMub3B0aW9ucy5sYW5nLm5ld05vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbm9kZXMnOiB0aGlzLm9wdGlvbnMubGFuZy5ub2Rlc1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNob3dFcnJvcihlcnJvci5yZWFzb24pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aGVtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdkamFuZ28tY21zJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRoZSBtdWx0aSBzZWxlY3Rpb24gb2Ygbm9kZXMgZm9yIG5vd1xuICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIGFjdGl2YXRlIGRyYWcgYW5kIGRyb3AgcGx1Z2luXG4gICAgICAgICAgICAgICAgcGx1Z2lucyA6IFsnZG5kJywgJ3NlYXJjaCcsICdncmlkJ10sXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly93d3cuanN0cmVlLmNvbS9hcGkvIy8/Zj0kLmpzdHJlZS5kZWZhdWx0cy5kbmRcbiAgICAgICAgICAgICAgICBkbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5zaWRlX3BvczogJ2xhc3QnLFxuICAgICAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRoZSBtdWx0aSBzZWxlY3Rpb24gb2Ygbm9kZXMgZm9yIG5vd1xuICAgICAgICAgICAgICAgICAgICBkcmFnX3NlbGVjdGlvbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgZHJhZ2dpbmcgaWYgZmlsdGVyZWRcbiAgICAgICAgICAgICAgICAgICAgaXNfZHJhZ2dhYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoYXQub3B0aW9ucy5maWx0ZXJlZCkgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgQ01EL0NUUkwgY29weVxuICAgICAgICAgICAgICAgICAgICBjb3B5OiBmYWxzZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2RlaXRjaC9qc3RyZWUtZ3JpZFxuICAgICAgICAgICAgICAgIGdyaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29sdW1ucyBhcmUgcHJvdmlkZWQgZnJvbSBiYXNlLmh0bWwgb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiBjb2x1bW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgdXAgYWxsIHRoZSBldmVudCBoYW5kbGVycywgc3VjaCBhcyBvcGVuaW5nIGFuZCBtb3ZpbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX2V2ZW50c1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX2V2ZW50czogZnVuY3Rpb24gX2V2ZW50cygpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgLy8gc2V0IGV2ZW50cyBmb3IgdGhlIG5vZGVJZCB1cGRhdGVzXG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUub24oJ2FmdGVyX2Nsb3NlLmpzdHJlZScsIGZ1bmN0aW9uIChlLCBlbCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX3JlbW92ZU5vZGVJZChlbC5ub2RlLmRhdGEuaWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUub24oJ2FmdGVyX29wZW4uanN0cmVlJywgZnVuY3Rpb24gKGUsIGVsKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fc3RvcmVOb2RlSWQoZWwubm9kZS5kYXRhLmlkKTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jaGVja0hlbHBlcnMoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzdG9yZSBtb3ZlZCBwb3NpdGlvbiBub2RlXG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUub24oJ21vdmVfbm9kZS5qc3RyZWUgY29weV9ub2RlLmpzdHJlZScsIGZ1bmN0aW9uIChlLCBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoYXQuY2FjaGUudHlwZSB8fCB0aGF0LmNhY2hlLnR5cGUgPT09ICdjdXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX21vdmVOb2RlKHRoYXQuX2dldE5vZGVQb3NpdGlvbihvYmopKS5kb25lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoYXQudWkudHJlZS5qc3RyZWUodHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLl9oaWRlX2dyaWQoaW5zdGFuY2UuZ2V0X25vZGUob2JqLnBhcmVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5wYXJlbnQgPT09ICcjJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSB0byByZWZyZXNoIHBhcmVudCwgYmVjYXVzZSByZWZyZXNoIG9ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWZyZXNoZXMgY2hpbGRyZW4gb2YgdGhlIG5vZGUsIG5ldmVyIHRoZSBub2RlIGl0c2VsZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnJlZnJlc2hfbm9kZShvYmoucGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5fY29weU5vZGUob2JqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBvcGVuIHRoZSBwYXJlbnQgbm9kZSBpZiB3ZSB0cmlnZ2VyIGFuIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAvLyBpZiBub3QgYWxyZWFkeSBvcGVuZWRcbiAgICAgICAgICAgICAgICB0aGF0LnVpLnRyZWUuanN0cmVlKCdvcGVuX25vZGUnLCBvYmoucGFyZW50KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzZXQgZXZlbnQgZm9yIGN1dCBhbmQgcGFzdGVcbiAgICAgICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssICcuanMtY21zLXRyZWUtaXRlbS1jdXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jdXRPckNvcHkoeyB0eXBlOiAnY3V0JywgZWxlbWVudDogJCh0aGlzKSB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzZXQgZXZlbnQgZm9yIGN1dCBhbmQgcGFzdGVcbiAgICAgICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssICcuanMtY21zLXRyZWUtaXRlbS1jb3B5JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhhdC5fY3V0T3JDb3B5KHsgdHlwZTogJ2NvcHknLCBlbGVtZW50OiAkKHRoaXMpIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGF0dGFjaCBldmVudHMgdG8gcGFzdGVcbiAgICAgICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssICcuY21zLXRyZWUtaXRlbS1oZWxwZXJzIGEnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9wYXN0ZShlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBhZHZhbmNlZCBzZXR0aW5ncyBsaW5rIGhhbmRsaW5nXG4gICAgICAgICAgICB0aGlzLnVpLmNvbnRhaW5lci5vbih0aGlzLmNsaWNrLCAnLmpzLWNtcy10cmVlLWFkdmFuY2VkLXNldHRpbmdzJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJCh0aGlzKS5kYXRhKCd1cmwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gYWRkIGV2ZW50cyBmb3IgZXJyb3IgcmVsb2FkIChtZXNzYWdlbGlzdClcbiAgICAgICAgICAgIHRoaXMudWkuZG9jdW1lbnQub24odGhpcy5jbGljaywgJy5tZXNzYWdlbGlzdCAuY21zLXRyZWUtcmVsb2FkJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhhdC5fcmVsb2FkSGVscGVyKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gcHJvcGFnbmF0ZSB0aGUgc2l0ZXMgZHJvcGRvd24gdG8gdGhlIGhpZGRlbiBzaXRlcyBmb3JtXG4gICAgICAgICAgICB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLXNpdGUtdHJpZ2dlcicpLm9uKHRoaXMuY2xpY2ssIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vIHByZXZlbnQgaWYgcGFyZW50IGlzIGFjdGl2ZVxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnBhcmVudCgpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoYXQudWkuc2l0ZUZvcm0uZmluZCgnc2VsZWN0JylcbiAgICAgICAgICAgICAgICAgICAgLnZhbCgkKHRoaXMpLmRhdGEoKS5pZCkuZW5kKCkuc3VibWl0KCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gYWRkaXRpb25hbCBldmVudCBoYW5kbGVyc1xuICAgICAgICAgICAgdGhpcy5fc2V0VG9vbHRpcHMoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldFNlYXJjaCgpO1xuXG4gICAgICAgICAgICAvLyBtYWtlIHN1cmUgYWpheCBwb3N0IHJlcXVlc3RzIGFyZSB3b3JraW5nXG4gICAgICAgICAgICB0aGlzLl9zZXRBamF4UG9zdCgnLmpzLWNtcy10cmVlLWl0ZW0tbWVudSBhJyk7XG4gICAgICAgICAgICB0aGlzLl9zZXRBamF4UG9zdCgnLmpzLWNtcy10cmVlLWxhbmctdHJpZ2dlcicpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIZWxwZXIgdG8gcHJvY2VzcyB0aGUgY3V0IGFuZCBjb3B5IGV2ZW50cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBfY3V0T3JDb3B5XG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0c11cbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRzLnR5cGVdIGVpdGhlciAnY3V0JyBvciAnY29weSdcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRzLmVsZW1lbnRdIG9yaWdpbmF0ZWQgdHJpZ2dlciBlbGVtZW50XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfY3V0T3JDb3B5OiBmdW5jdGlvbiBfY3V0T3JDb3B5KG9iaikge1xuICAgICAgICAgICAgLy8gcHJldmVudCBhY3Rpb25zIGlmIHlvdSB0cnkgdG8gY29weSBhIHBhZ2Ugd2l0aCBhbiBhcHBob29rXG4gICAgICAgICAgICBpZiAob2JqLnR5cGUgPT09ICdjb3B5JyAmJiBvYmouZWxlbWVudC5kYXRhKCkuYXBwaG9vaykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKHRoaXMub3B0aW9ucy5sYW5nLmFwcGhvb2spO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGpzVHJlZUlkID0gdGhpcy5fZ2V0Tm9kZUlkKG9iai5lbGVtZW50LmNsb3Nlc3QoJy5qc3RyZWUtZ3JpZC1jZWxsJykpO1xuICAgICAgICAgICAgLy8gcmVzZXRzIGlmIHdlIGNsaWNrIGFnYWluXG4gICAgICAgICAgICBpZiAodGhpcy5jYWNoZS50eXBlID09PSBvYmoudHlwZSAmJiBqc1RyZWVJZCA9PT0gdGhpcy5jYWNoZS5pZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUudHlwZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlkZUhlbHBlcnMoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBjYWNoZSB0aGUgbm9kZSBhbmQgdHlwZSBzbyBgX3Nob3dIZWxwZXJzYFxuICAgICAgICAgICAgICAgIC8vIHdpbGwgdHJpZ2dlciB0aGUgY29ycmVjdCBiZWhhdmlvdXJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlLnRhcmdldCA9IG9iai5lbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUudHlwZSA9IG9iai50eXBlO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUuaWQgPSBqc1RyZWVJZDtcbiAgICAgICAgICAgICAgICB0aGlzLl9zaG93SGVscGVycygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSGVscGVycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIZWxwZXIgdG8gcHJvY2VzcyB0aGUgcGFzdGUgZXZlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3Bhc3RlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEByZXR1cm4ge09iamVjdH0gZXZlbnQgb3JpZ2luYXRlZCBldmVudCBoYW5kbGVyXG4gICAgICAgICAqL1xuICAgICAgICBfcGFzdGU6IGZ1bmN0aW9uIF9wYXN0ZShldmVudCkge1xuICAgICAgICAgICAgLy8gaGlkZSBoZWxwZXJzIGFmdGVyIHdlIHBpY2tlZCBvbmVcbiAgICAgICAgICAgIHRoaXMuX2hpZGVIZWxwZXJzKCk7XG5cbiAgICAgICAgICAgIHZhciBjb3B5RnJvbUlkID0gdGhpcy5fZ2V0Tm9kZUlkKHRoaXMuY2FjaGUudGFyZ2V0KTtcbiAgICAgICAgICAgIHZhciBjb3B5VG9JZCA9IHRoaXMuX2dldE5vZGVJZCgkKGV2ZW50LmN1cnJlbnRUYXJnZXQpKTtcblxuICAgICAgICAgICAgLy8gY29weVRvSWQgY29udGFpbnMgYGpzdHJlZS0xYCwgYXNzaWduIHRvIHJvb3RcbiAgICAgICAgICAgIGlmIChjb3B5VG9JZC5pbmRleE9mKCdqc3RyZWUtMScpID4gLTEpIHtcbiAgICAgICAgICAgICAgICBjb3B5VG9JZCA9ICcjJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuY2FjaGUudHlwZSA9PT0gJ2N1dCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKCdjdXQnLCBjb3B5RnJvbUlkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy51aS50cmVlLmpzdHJlZSgnY29weScsIGNvcHlGcm9tSWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKCdwYXN0ZScsIGNvcHlUb0lkLCAnbGFzdCcpO1xuICAgICAgICAgICAgdGhpcy5jYWNoZS50eXBlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUudGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0cmVpdmVzIGEgbGlzdCBvZiBub2RlcyBmcm9tIGxvY2FsIHN0b3JhZ2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX2dldFN0b3JlZE5vZGVJZHNcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogQHJldHVybiB7QXJyYXl9IGxpc3Qgb2YgaWRzXG4gICAgICAgICAqL1xuICAgICAgICBfZ2V0U3RvcmVkTm9kZUlkczogZnVuY3Rpb24gX2dldFN0b3JlZE5vZGVJZHMoKSB7XG4gICAgICAgICAgICByZXR1cm4gQ01TLnNldHRpbmdzLnBhZ2V0cmVlIHx8IFtdO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdG9yZXMgYSBub2RlIGluIGxvY2FsIHN0b3JhZ2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3N0b3JlTm9kZUlkXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZCB0byBiZSBzdG9yZWRcbiAgICAgICAgICogQHJldHVybiB7U3RyaW5nfSBpZCB0aGF0IGhhcyBiZWVuIHN0b3JlZFxuICAgICAgICAgKi9cbiAgICAgICAgX3N0b3JlTm9kZUlkOiBmdW5jdGlvbiBfc3RvcmVOb2RlSWQoaWQpIHtcbiAgICAgICAgICAgIHZhciBudW1iZXIgPSBpZDtcbiAgICAgICAgICAgIHZhciBzdG9yYWdlID0gdGhpcy5fZ2V0U3RvcmVkTm9kZUlkcygpO1xuXG4gICAgICAgICAgICAvLyBzdG9yZSB2YWx1ZSBvbmx5IGlmIGl0IGlzbid0IHRoZXJlIHlldFxuICAgICAgICAgICAgaWYgKHN0b3JhZ2UuaW5kZXhPZihudW1iZXIpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0b3JhZ2UucHVzaChudW1iZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDTVMuc2V0dGluZ3MucGFnZXRyZWUgPSBzdG9yYWdlO1xuICAgICAgICAgICAgQ01TLkFQSS5IZWxwZXJzLnNldFNldHRpbmdzKENNUy5zZXR0aW5ncyk7XG5cbiAgICAgICAgICAgIHJldHVybiBudW1iZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZXMgYSBub2RlIGluIGxvY2FsIHN0b3JhZ2UuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3JlbW92ZU5vZGVJZFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWQgdG8gYmUgc3RvcmVkXG4gICAgICAgICAqIEByZXR1cm4ge1N0cmluZ30gaWQgdGhhdCBoYXMgYmVlbiByZW1vdmVkXG4gICAgICAgICAqL1xuICAgICAgICBfcmVtb3ZlTm9kZUlkOiBmdW5jdGlvbiBfcmVtb3ZlTm9kZUlkKGlkKSB7XG4gICAgICAgICAgICB2YXIgbnVtYmVyID0gaWQ7XG4gICAgICAgICAgICB2YXIgc3RvcmFnZSA9IHRoaXMuX2dldFN0b3JlZE5vZGVJZHMoKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHN0b3JhZ2UuaW5kZXhPZihudW1iZXIpO1xuXG4gICAgICAgICAgICAvLyByZW1vdmUgZ2l2ZW4gaWQgZnJvbSBzdG9yYWdlXG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RvcmFnZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBDTVMuc2V0dGluZ3MucGFnZXRyZWUgPSBzdG9yYWdlO1xuICAgICAgICAgICAgQ01TLkFQSS5IZWxwZXJzLnNldFNldHRpbmdzKENNUy5zZXR0aW5ncyk7XG5cbiAgICAgICAgICAgIHJldHVybiBudW1iZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1vdmVzIGEgbm9kZSBhZnRlciBkcmFnICYgZHJvcC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBfbW92ZU5vZGVcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRzXVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW29wdHMuaWRdIGN1cnJlbnQgZWxlbWVudCBpZCBmb3IgdXJsIG1hdGNoaW5nXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0cy50YXJnZXRdIHRhcmdldCBzaWJsaW5nIG9yIHBhcmVudFxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW29wdHMucG9zaXRpb25dIGVpdGhlciBgbGVmdGAsIGByaWdodGAgb3IgYGxhc3QtY2hpbGRgXG4gICAgICAgICAqIEByZXR1cm5zIHskLkRlZmVycmVkfSBhamF4IHJlcXVlc3Qgb2JqZWN0XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfbW92ZU5vZGU6IGZ1bmN0aW9uIF9tb3ZlTm9kZShvYmopIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIG9iai5zaXRlID0gdGhhdC5vcHRpb25zLnNpdGU7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgIHVybDogdGhhdC5vcHRpb25zLnVybHMubW92ZS5yZXBsYWNlKCd7aWR9Jywgb2JqLmlkKSxcbiAgICAgICAgICAgICAgICBkYXRhOiBvYmpcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX3Nob3dTdWNjZXNzKG9iai5pZCk7XG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvcGllcyBhIG5vZGUgaW50byB0aGUgc2VsZWN0ZWQgbm9kZS5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBfY29weU5vZGVcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGNvcHlGcm9tSWQgZWxlbWVudCB0byBiZSBjdXRcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGNvcHlUb0lkIGRlc3RpbmF0aW9uIHRvIGluamVjdFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX2NvcHlOb2RlOiBmdW5jdGlvbiBfY29weU5vZGUob2JqKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoYXQuX2dldE5vZGVQb3NpdGlvbihvYmopO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgc2l0ZTogdGhpcy5vcHRpb25zLnNpdGUsXG4gICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byByZWZlciB0byB0aGUgb3JpZ2luYWwgaXRlbSBoZXJlLCBhcyB0aGUgY29waWVkXG4gICAgICAgICAgICAgICAgLy8gbm9kZSB3aWxsIGhhdmUgbm8gZGF0YSBhdHRyaWJ1dGVzIHN0b3JlZCBhdCBpdCAobm90IGEgY2xvbmUpXG4gICAgICAgICAgICAgICAgaWQ6IG9iai5vcmlnaW5hbC5kYXRhLmlkLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBub2RlLnBvc2l0aW9uXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyB0YXJnZXQgcHJvdmlkZWQsIHRoZSBub2RlIGxhbmRzIGluIHJvb3RcbiAgICAgICAgICAgIGlmIChub2RlLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIGRhdGEudGFyZ2V0ID0gbm9kZS50YXJnZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gbG9hZCBhIGRpYWxvZyBmaXJzdCwgdG8gY2hlY2sgaWYgcGVybWlzc2lvbnMgc2hvdWxkXG4gICAgICAgICAgICAvLyBiZSBjb3BpZWQgb3Igbm90XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgIHVybDogdGhhdC5vcHRpb25zLnVybHMuY29weVBlcm1pc3Npb24ucmVwbGFjZSgne2lkfScsIGRhdGEuaWQpLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICAgIC8vIHRoZSBkaWFsb2cgaXMgbG9hZGVkIHZpYSB0aGUgYWpheCByZXNwb25zIG9yaWdpbmF0aW5nIGZyb21cbiAgICAgICAgICAgIC8vIGB0ZW1wbGF0ZXMvYWRtaW4vY21zL3BhZ2UvdHJlZS9jb3B5X3ByZW1pc3Npb25zLmh0bWxgXG4gICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uIChkaWFsb2cpIHtcbiAgICAgICAgICAgICAgICB0aGF0LnVpLmRpYWxvZy5hcHBlbmQoZGlhbG9nKTtcbiAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5zaG93RXJyb3IoZXJyb3Iuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gYXR0YWNoIGV2ZW50cyB0byB0aGUgcGVybWlzc2lvbiBkaWFsb2dcbiAgICAgICAgICAgIHRoaXMudWkuZGlhbG9nLm9mZih0aGlzLmNsaWNrLCAnLmNhbmNlbCcpLm9uKHRoaXMuY2xpY2ssICcuY2FuY2VsJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGp1c3QgY29waWVkIG5vZGVcbiAgICAgICAgICAgICAgICB0aGF0LnVpLnRyZWUuanN0cmVlKCdkZWxldGVfbm9kZScsIG9iai5ub2RlLmlkKTtcbiAgICAgICAgICAgICAgICAkKCcuanMtY21zLWRpYWxvZycpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICQoJy5qcy1jbXMtZGlhbG9nLWRpbW1lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfSkub2ZmKHRoaXMuY2xpY2ssICcuc3VibWl0Jykub24odGhpcy5jbGljaywgJy5zdWJtaXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSAkKHRoaXMpLmNsb3Nlc3QoJ2Zvcm0nKS5zZXJpYWxpemUoKS5zcGxpdCgnJicpO1xuICAgICAgICAgICAgICAgIC8vIGxvb3AgdGhyb3VnaCBmb3JtIGRhdGEgYW5kIGF0dGFjaCB0byBvYmpcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvcm1EYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbZm9ybURhdGFbaV0uc3BsaXQoJz0nKVswXV0gPSBmb3JtRGF0YVtpXS5zcGxpdCgnPScpWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBzZW5kIHRoZSByZWFsIGFqYXggcmVxdWVzdCBmb3IgY29weWluZyB0aGUgcGx1Z2luXG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogdGhhdC5vcHRpb25zLnVybHMuY29weS5yZXBsYWNlKCd7aWR9JywgZGF0YS5pZCksXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5fcmVsb2FkSGVscGVyKCk7XG4gICAgICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5zaG93RXJyb3IoZXJyb3Iuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0dXJucyBlbGVtZW50IGZyb20gYW55IHN1YiBub2Rlcy5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBfZ2V0RWxlbWVudFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gZWwgalF1ZXJ5IG5vZGUgZm9ybSB3aGVyZSB0byBzZWFyY2hcbiAgICAgICAgICogQHJldHVybiB7U3RyaW5nfEJvb2xlYW59IGpzVHJlZSBub2RlIGVsZW1lbnQgaWRcbiAgICAgICAgICovXG4gICAgICAgIF9nZXROb2RlSWQ6IGZ1bmN0aW9uIF9nZXRFbGVtZW50KGVsKSB7XG4gICAgICAgICAgICB2YXIgY2xzID0gZWwuY2xvc2VzdCgnLmpzdHJlZS1ncmlkLWNlbGwnKS5hdHRyKCdjbGFzcycpO1xuXG4gICAgICAgICAgICByZXR1cm4gKGNscykgPyBjbHMucmVwbGFjZSgvLipqc2dyaWRfKC4rPylfY29sLiovLCAnJDEnKSA6IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXRzIHRoZSBuZXcgbm9kZSBwb3NpdGlvbiBhZnRlciBtb3ZpbmcuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX2dldE5vZGVQb3NpdGlvblxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIGpzdHJlZSBtb3ZlIG9iamVjdFxuICAgICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGV2YWx1YXRlZCBvYmplY3Qgd2l0aCBwYXJhbXNcbiAgICAgICAgICovXG4gICAgICAgIF9nZXROb2RlUG9zaXRpb246IGZ1bmN0aW9uIF9nZXROb2RlUG9zaXRpb24ob2JqKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnVpLnRyZWUuanN0cmVlKCdnZXRfbm9kZScsIG9iai5ub2RlLnBhcmVudCk7XG5cbiAgICAgICAgICAgIGRhdGEucG9zaXRpb24gPSBvYmoucG9zaXRpb247XG5cbiAgICAgICAgICAgIC8vIGpzdHJlZSBpbmRpY2F0ZXMgbm8gcGFyZW50IHdpdGggYCNgLCBpbiB0aGlzIGNhc2Ugd2UgZG8gbm90XG4gICAgICAgICAgICAvLyBuZWVkIHRvIHNldCB0aGUgdGFyZ2V0IGF0dHJpYnV0ZSBhdCBhbGxcbiAgICAgICAgICAgIGlmIChvYmoucGFyZW50ICE9PSAnIycpIHtcbiAgICAgICAgICAgICAgICBkYXRhLnRhcmdldCA9IG5vZGUuZGF0YS5pZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gc29tZSBmdW5jdGlvbnMgbGlrZSBjb3B5IGNyZWF0ZSBhIG5ldyBlbGVtZW50IHdpdGggYSBuZXcgaWQsXG4gICAgICAgICAgICAvLyBpbiB0aGlzIGNhc2Ugd2UgbmVlZCB0byBzZXQgYGRhdGEuaWRgIG1hbnVhbGx5XG4gICAgICAgICAgICBpZiAob2JqLm5vZGUgJiYgb2JqLm5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIGRhdGEuaWQgPSBvYmoubm9kZS5kYXRhLmlkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0cyB1cCBnZW5lcmFsIHRvb2x0aXBzIHRoYXQgY2FuIGhhdmUgYSBsaXN0IG9mIGxpbmtzIG9yIGNvbnRlbnQuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3NldFRvb2x0aXBzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfc2V0VG9vbHRpcHM6IGZ1bmN0aW9uIF9zZXRUb29sdGlwcygpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHZhciB0cmlnZ2VyQ2xzID0gJy5qcy1jbXMtdHJlZS10b29sdGlwLXRyaWdnZXInO1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lckNscyA9ICcuanMtY21zLXRyZWUtdG9vbHRpcC1jb250YWluZXInO1xuICAgICAgICAgICAgdmFyIHRyaWdnZXJzO1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lcnM7XG4gICAgICAgICAgICB2YXIgaW5kZXg7XG5cbiAgICAgICAgICAgIC8vIGF0dGFjaCBldmVudCB0byB0aGUgdHJpZ2dlclxuICAgICAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgdHJpZ2dlckNscywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgICAgIHRyaWdnZXJzID0gJCh0cmlnZ2VyQ2xzKTtcbiAgICAgICAgICAgICAgICBjb250YWluZXJzID0gJChjb250YWluZXJDbHMpO1xuICAgICAgICAgICAgICAgIGluZGV4ID0gdHJpZ2dlcnMuaW5kZXgodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAvLyBjYW5jZWwgaWYgb3BlbmVkIHRvb2x0aXAgaXMgdHJpZ2dlcmVkIGFnYWluXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRhaW5lcnMuZXEoaW5kZXgpLmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcnMucmVtb3ZlQ2xhc3MoJ2Ntcy10cmVlLXRvb2x0aXAtY29udGFpbmVyLW9wZW4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBzaG93IHRoZSBkcm9wZG93blxuICAgICAgICAgICAgICAgIGNvbnRhaW5lcnNcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdjbXMtdHJlZS10b29sdGlwLWNvbnRhaW5lci1vcGVuJylcbiAgICAgICAgICAgICAgICAgICAgLmVxKGluZGV4KVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2Ntcy10cmVlLXRvb2x0aXAtY29udGFpbmVyLW9wZW4nKTtcblxuICAgICAgICAgICAgICAgIHRoYXQudWkuZG9jdW1lbnQub25lKHRoYXQuY2xpY2ssIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVycy5yZW1vdmVDbGFzcygnY21zLXRyZWUtdG9vbHRpcC1jb250YWluZXItb3BlbicpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIHN0b3AgcHJvcGFnbmF0aW9uIG9uIHRoZSBlbGVtZW50XG4gICAgICAgICAgICB0aGlzLnVpLmNvbnRhaW5lci5vbih0aGlzLmNsaWNrLCBjb250YWluZXJDbHMsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmlnZ2VycyB0aGUgbGlua3MgYGhyZWZgIGFzIGFqYXggcG9zdCByZXF1ZXN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIF9zZXRBamF4UG9zdFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gdHJpZ2dlciBqUXVlcnkgbGluayB0YXJnZXRcbiAgICAgICAgICovXG4gICAgICAgIF9zZXRBamF4UG9zdDogZnVuY3Rpb24gX3NldEFqYXhQb3N0KHRyaWdnZXIpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgdHJpZ2dlciwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJCh0aGlzKS5hdHRyKCdocmVmJylcbiAgICAgICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5zZWxmICE9PSB3aW5kb3cudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSdyZSBpbiB0aGUgc2lkZWZyYW1lIHdlIGhhdmUgdG8gYWN0dWFsbHlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGFyZSBwdWJsaXNoaW5nIGEgcGFnZSB3ZSdyZSBjdXJyZW50bHkgaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJlY2F1c2UgaWYgdGhlIHNsdWcgZGlkIGNoYW5nZSB3ZSB3b3VsZCBuZWVkIHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZWRpcmVjdCB0byB0aGF0IG5ldyBzbHVnXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9ibGVtIGhlcmUgaXMgdGhhdCBpbiBjYXNlIG9mIHRoZSBhcHBob29rZWQgcGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG1vZGVsIGFuZCBwayBhcmUgZW1wdHkgYW5kIHJlbG9hZEJyb3dzZXIgZG9lc24ndCByZWFsbHlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRvIGFueXRoaW5nIC0gc28gaGVyZSB3ZSBzcGVjaWZpY2FsbHkgZm9yY2UgdGhlIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIGJlIHRoZSBkYXRhIGFib3V0IHRoZSBwYWdlIGFuZCBub3QgdGhlIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gKHdpbmRvdy5wYXJlbnQgPyB3aW5kb3cucGFyZW50IDogd2luZG93KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZJWE1FIHNob3VsZG4ndCBiZSBoYXJkY29kZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogJ2Ntcy5wYWdlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwazogcGFyZW50LkNNUy5jb25maWcucmVxdWVzdC5wYWdlX2lkXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgQ01TLkFQSS5IZWxwZXJzLnJlbG9hZEJyb3dzZXIoZmFsc2UsIGZhbHNlLCB0cnVlLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSBzaW1wbHkgcmVsb2FkIHRoZSBwYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0Ll9yZWxvYWRIZWxwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldHMgZXZlbnRzIGZvciB0aGUgc2VhcmNoIG9uIHRoZSBoZWFkZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3NldFNlYXJjaFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3NldFNlYXJjaDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRyaWdnZXIgPSB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLWhlYWRlci1maWx0ZXItdHJpZ2dlcicpO1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMudWkuY29udGFpbmVyLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUtaGVhZGVyLWZpbHRlci1jb250YWluZXInKTtcbiAgICAgICAgICAgIHZhciBjbG9zZSA9IGNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLWhlYWRlci1zZWFyY2gtY2xvc2UnKTtcbiAgICAgICAgICAgIHZhciB2aXNpYmxlRm9ybSA9IHRoaXMudWkuY29udGFpbmVyLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUtaGVhZGVyLXNlYXJjaCcpO1xuICAgICAgICAgICAgdmFyIGhpZGRlbkZvcm0gPSB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLWhlYWRlci1zZWFyY2gtY29weSBmb3JtJyk7XG5cbiAgICAgICAgICAgIHRyaWdnZXIuYWRkKGNsb3NlKS5vbih0aGlzLmNsaWNrLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBjb250YWluZXIudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgICAgIC50b2dnbGVDbGFzcygnY21zLXBhZ2V0cmVlLWhlYWRlci1zZWFyY2gtZmllbGQtYWN0aXZlJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gYWRkIGhpZGRlbiBmaWVsZHNcbiAgICAgICAgICAgIHZpc2libGVGb3JtLmFwcGVuZChoaWRkZW5Gb3JtLmZpbmQoJ2lucHV0W3R5cGU9XCJoaWRkZW5cIl0nKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNob3dzIHBhc3RlIGhlbHBlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX3Nob3dIZWxwZXJzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfc2hvd0hlbHBlcnM6IGZ1bmN0aW9uIF9zaG93SGVscGVycygpIHtcbiAgICAgICAgICAgIC8vIGhlbHBlcnMgYXJlIGdlbmVyYXRlZCBvbiB0aGUgZmx5LCBzbyB3ZSBuZWVkIHRvIHJlZmVyZW5jZVxuICAgICAgICAgICAgLy8gdGhlbSBldmVyeSBzaW5nbGUgdGltZVxuICAgICAgICAgICAgJCgnLmNtcy10cmVlLWl0ZW0taGVscGVycycpLnJlbW92ZUNsYXNzKCdjbXMtaGlkZGVuJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhpZGVzIHBhc3RlIGhlbHBlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZXRob2QgX2hpZGVIZWxwZXJzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfaGlkZUhlbHBlcnM6IGZ1bmN0aW9uIF9oaWRlSGVscGVycygpIHtcbiAgICAgICAgICAgIC8vIGhlbHBlcnMgYXJlIGdlbmVyYXRlZCBvbiB0aGUgZmx5LCBzbyB3ZSBuZWVkIHRvIHJlZmVyZW5jZVxuICAgICAgICAgICAgLy8gdGhlbSBldmVyeSBzaW5nbGUgdGltZVxuICAgICAgICAgICAgJCgnLmNtcy10cmVlLWl0ZW0taGVscGVycycpLmFkZENsYXNzKCdjbXMtaGlkZGVuJyk7XG4gICAgICAgICAgICB0aGlzLmNhY2hlLmlkID0gbnVsbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2tzIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBoZWxwZXJzIGFmdGVyIGBhZnRlcl9vcGVuLmpzdHJlZWBcbiAgICAgICAgICogb3IgYF9jdXRPckNvcHlgIGlzIHRyaWdnZXJlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1ldGhvZCBfY2hlY2tIZWxwZXJzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfY2hlY2tIZWxwZXJzOiBmdW5jdGlvbiBfY2hlY2tIZWxwZXJzKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FjaGUudHlwZSAmJiB0aGlzLmNhY2hlLmlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0hlbHBlcnModGhpcy5jYWNoZS50eXBlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaGlkZSBjdXQgZWxlbWVudCBhbmQgaXQncyBkZXNjZW5kYW50cycgcGFzdGUgaGVscGVycyBpZiBpdCBpcyB2aXNpYmxlXG4gICAgICAgICAgICBpZiAodGhpcy5jYWNoZS50eXBlID09PSAnY3V0JyAmJiB0aGlzLmNhY2hlLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIHZhciBkZXNjZW5kYW50SWRzID0gdGhpcy51aS50cmVlLmpzdHJlZSh0cnVlKS5nZXRfbm9kZSh0aGlzLmNhY2hlLmlkKS5jaGlsZHJlbl9kO1xuXG4gICAgICAgICAgICAgICAgW3RoaXMuY2FjaGUuaWRdLmNvbmNhdChkZXNjZW5kYW50SWRzKS5mb3JFYWNoKGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgICAgICAgICAkKCcuanNncmlkXycgKyBpZCArICdfY29sIC5jbXMtdHJlZS1pdGVtLWhlbHBlcnMnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdjbXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNob3dzIHN1Y2Nlc3MgbWVzc2FnZSBvbiBub2RlIGFmdGVyIHN1Y2Nlc3NmdWwgYWN0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIF9zaG93U3VjY2Vzc1xuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gaWQgaWQgb2YgdGhlIGVsZW1lbnQgdG8gYWRkIHRoZSBzdWNjZXNzIGNsYXNzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfc2hvd1N1Y2Nlc3M6IGZ1bmN0aW9uIF9zaG93U3VjY2VzcyhpZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnVpLnRyZWUuZmluZCgnbGlbZGF0YS1pZD1cIicgKyBpZCArICdcIl0nKTtcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2Ntcy10cmVlLW5vZGUtc3VjY2VzcycpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnY21zLXRyZWUtbm9kZS1zdWNjZXNzJyk7XG4gICAgICAgICAgICB9LCB0aGlzLnN1Y2Nlc3NUaW1lcik7XG4gICAgICAgICAgICAvLyBoaWRlIGVsZW1lbnRzXG4gICAgICAgICAgICB0aGlzLl9oaWRlSGVscGVycygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGVja3MgaWYgd2Ugc2hvdWxkIHJlbG9hZCB0aGUgaWZyYW1lIG9yIGVudGlyZSB3aW5kb3cuIEZvciB0aGlzIHdlXG4gICAgICAgICAqIG5lZWQgdG8gc2tpcCBgQ01TLkFQSS5IZWxwZXJzLnJlbG9hZEJyb3dzZXIoKTtgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIF9yZWxvYWRIZWxwZXJcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF9yZWxvYWRIZWxwZXI6IGZ1bmN0aW9uIF9yZWxvYWRIZWxwZXIoKSB7XG4gICAgICAgICAgICBpZiAod2luZG93LnNlbGYgIT09IHdpbmRvdy50b3ApIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIENNUy5BUEkuSGVscGVycy5yZWxvYWRCcm93c2VyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXlzIGFuIGVycm9yIHdpdGhpbiB0aGUgZGphbmdvIFVJLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAbWV0aG9kIHNob3dFcnJvclxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBzdHJpbmcgbWVzc2FnZSB0byBkaXNwbGF5XG4gICAgICAgICAqL1xuICAgICAgICBzaG93RXJyb3I6IGZ1bmN0aW9uIHNob3dFcnJvcihtZXNzYWdlKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSAkKCcubWVzc2FnZWxpc3QnKTtcbiAgICAgICAgICAgIHZhciBicmVhZGNydW1iID0gJCgnLmJyZWFkY3J1bWJzJyk7XG4gICAgICAgICAgICB2YXIgcmVsb2FkID0gdGhpcy5vcHRpb25zLmxhbmcucmVsb2FkO1xuICAgICAgICAgICAgdmFyIHRwbCA9ICcnICtcbiAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwibWVzc2FnZWxpc3RcIj4nICtcbiAgICAgICAgICAgICAgICAnICAgPGxpIGNsYXNzPVwiZXJyb3JcIj4nICtcbiAgICAgICAgICAgICAgICAnICAgICAgIHttc2d9ICcgK1xuICAgICAgICAgICAgICAgICcgICAgICAgPGEgaHJlZj1cIiNyZWxvYWRcIiBjbGFzcz1cImNtcy10cmVlLXJlbG9hZFwiPiAnICsgcmVsb2FkICsgJyA8L2E+JyArXG4gICAgICAgICAgICAgICAgJyAgIDwvbGk+JyArXG4gICAgICAgICAgICAgICAgJzwvdWw+JztcbiAgICAgICAgICAgIHZhciBtc2cgPSB0cGwucmVwbGFjZSgne21zZ30nLCAnPHN0cm9uZz4nICsgdGhpcy5vcHRpb25zLmxhbmcuZXJyb3IgKyAnPC9zdHJvbmc+ICcgKyBtZXNzYWdlKTtcblxuICAgICAgICAgICAgbWVzc2FnZXMubGVuZ3RoID8gbWVzc2FnZXMucmVwbGFjZVdpdGgobXNnKSA6IGJyZWFkY3J1bWIuYWZ0ZXIobXNnKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICAvLyBzaG9ydGhhbmQgZm9yIGpRdWVyeShkb2N1bWVudCkucmVhZHkoKTtcbiAgICAkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gbG9hZCBjbXMgc2V0dGluZ3MgYmVmb3JlaGFuZFxuICAgICAgICAvLyBoYXZlIHRvIHNldCB0b29sYmFyIHRvIFwiZXhwYW5kZWRcIiBieSBkZWZhdWx0XG4gICAgICAgIC8vIG90aGVyd2lzZSBpbml0aWFsaXphdGlvbiB3aWxsIGJlIGluY29ycmVjdCB3aGVuIHlvdVxuICAgICAgICAvLyBnbyBmaXJzdCB0byBwYWdlcyBhbmQgdGhlbiB0byBub3JtYWwgcGFnZVxuICAgICAgICBDTVMuY29uZmlnID0ge1xuICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICB0b29sYmFyOiAnZXhwYW5kZWQnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXJsczoge1xuICAgICAgICAgICAgICAgIHNldHRpbmdzOiAkKCcuanMtY21zLXBhZ2V0cmVlJykuZGF0YSgnc2V0dGluZ3MtdXJsJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ01TLnNldHRpbmdzID0gQ01TLkFQSS5IZWxwZXJzLmdldFNldHRpbmdzKCk7XG4gICAgICAgIC8vIGF1dG9sb2FkIHRoZSBwYWdldHJlZVxuICAgICAgICBuZXcgQ01TLlBhZ2VUcmVlKCk7XG4gICAgfSk7XG5cbn0pKENNUy4kKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==